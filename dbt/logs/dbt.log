[0m17:33:18.556874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117537d0>]}


============================== 17:33:18.577130 | 7d0f1854-e19e-481a-9434-b697d15b21fa ==============================
[0m17:33:18.577130 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:18.577473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:33:18.610097 [info ] [MainThread]: dbt version: 1.9.4
[0m17:33:18.610374 [info ] [MainThread]: python version: 3.11.8
[0m17:33:18.610542 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:33:18.610697 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:33:18.657316 [info ] [MainThread]: Using profiles dir at .
[0m17:33:18.657616 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:33:18.657761 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:33:18.707001 [info ] [MainThread]: Configuration:
[0m17:33:18.707308 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:33:18.707454 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:33:18.707584 [info ] [MainThread]: Required dependencies:
[0m17:33:18.707766 [debug] [MainThread]: Executing "git --help"
[0m17:33:18.725345 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:33:18.726087 [debug] [MainThread]: STDERR: "b''"
[0m17:33:18.726281 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:33:18.726445 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:33:18.726592 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:33:18.726724 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "weather_warehouse", target "dev" invalid: Runtime Error
        schema: default 
        database: weather_data 
        cluster: None 
    On Clickhouse, database must be omitted or have the same value as schema.


[0m17:33:18.727301 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21715721, "process_in_blocks": "0", "process_kernel_time": 0.333027, "process_mem_max_rss": "131661824", "process_out_blocks": "0", "process_user_time": 1.264329}
[0m17:33:18.727553 [debug] [MainThread]: Command `dbt debug` failed at 17:33:18.727500 after 0.22 seconds
[0m17:33:18.727831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116d6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111753990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102deda50>]}
[0m17:33:18.728102 [debug] [MainThread]: Flushing usage events
[0m17:33:19.218711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:38.259047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106499110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106527510>]}


============================== 17:33:38.262117 | 74e22ae3-5d8e-457d-b980-e1f53fef8359 ==============================
[0m17:33:38.262117 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:38.262491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:38.270740 [info ] [MainThread]: dbt version: 1.9.4
[0m17:33:38.271051 [info ] [MainThread]: python version: 3.11.8
[0m17:33:38.271323 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:33:38.271541 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:33:38.307324 [info ] [MainThread]: Using profiles dir at .
[0m17:33:38.307632 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:33:38.307779 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:33:38.357544 [info ] [MainThread]: Configuration:
[0m17:33:38.357861 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:33:38.358087 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:33:38.358242 [info ] [MainThread]: Required dependencies:
[0m17:33:38.358422 [debug] [MainThread]: Executing "git --help"
[0m17:33:38.372909 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:33:38.373543 [debug] [MainThread]: STDERR: "b''"
[0m17:33:38.373734 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:33:38.373914 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:33:38.374067 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:33:38.374208 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "weather_warehouse", target "dev" invalid: Runtime Error
        schema: default 
        database: weather_data 
        cluster: None 
    On Clickhouse, database must be omitted or have the same value as schema.


[0m17:33:38.374800 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16219404, "process_in_blocks": "0", "process_kernel_time": 0.165105, "process_mem_max_rss": "111427584", "process_out_blocks": "0", "process_user_time": 0.785325}
[0m17:33:38.375068 [debug] [MainThread]: Command `dbt debug` failed at 17:33:38.375015 after 0.16 seconds
[0m17:33:38.375406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106527790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065270d0>]}
[0m17:33:38.375684 [debug] [MainThread]: Flushing usage events
[0m17:33:38.815748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:46.941758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc04310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb99410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc2b3d0>]}


============================== 17:38:46.944542 | d96fe599-f9e6-4e4b-9f23-678e188c15b8 ==============================
[0m17:38:46.944542 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:38:46.944920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:38:46.952011 [info ] [MainThread]: dbt version: 1.9.4
[0m17:38:46.952220 [info ] [MainThread]: python version: 3.11.8
[0m17:38:46.952387 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:38:46.952525 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:38:46.992106 [info ] [MainThread]: Using profiles dir at .
[0m17:38:46.992426 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:38:46.992579 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:38:46.993352 [info ] [MainThread]: adapter type: clickhouse
[0m17:38:46.993525 [info ] [MainThread]: adapter version: 1.9.1
[0m17:38:47.042318 [info ] [MainThread]: Configuration:
[0m17:38:47.042661 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:38:47.042813 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:38:47.042945 [info ] [MainThread]: Required dependencies:
[0m17:38:47.043126 [debug] [MainThread]: Executing "git --help"
[0m17:38:47.060145 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:38:47.060965 [debug] [MainThread]: STDERR: "b''"
[0m17:38:47.061157 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:38:47.061352 [info ] [MainThread]: Connection:
[0m17:38:47.061601 [info ] [MainThread]:   driver: None
[0m17:38:47.061731 [info ] [MainThread]:   host: localhost
[0m17:38:47.061854 [info ] [MainThread]:   port: 8123
[0m17:38:47.061971 [info ] [MainThread]:   user: default
[0m17:38:47.062099 [info ] [MainThread]:   schema: weather_data
[0m17:38:47.062215 [info ] [MainThread]:   retries: 1
[0m17:38:47.062326 [info ] [MainThread]:   cluster: None
[0m17:38:47.062441 [info ] [MainThread]:   database_engine: None
[0m17:38:47.062558 [info ] [MainThread]:   cluster_mode: False
[0m17:38:47.062670 [info ] [MainThread]:   secure: False
[0m17:38:47.062786 [info ] [MainThread]:   verify: True
[0m17:38:47.062896 [info ] [MainThread]:   client_cert: None
[0m17:38:47.063008 [info ] [MainThread]:   client_cert_key: None
[0m17:38:47.063124 [info ] [MainThread]:   connect_timeout: 10
[0m17:38:47.063235 [info ] [MainThread]:   send_receive_timeout: 300
[0m17:38:47.063347 [info ] [MainThread]:   sync_request_timeout: 5
[0m17:38:47.063457 [info ] [MainThread]:   compress_block_size: 1048576
[0m17:38:47.063568 [info ] [MainThread]:   compression: 
[0m17:38:47.063680 [info ] [MainThread]:   check_exchange: True
[0m17:38:47.063788 [info ] [MainThread]:   custom_settings: None
[0m17:38:47.063899 [info ] [MainThread]:   use_lw_deletes: False
[0m17:38:47.064008 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m17:38:47.064121 [info ] [MainThread]:   tcp_keepalive: False
[0m17:38:47.064438 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:38:47.117905 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m17:38:47.118288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:47.572853 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:38:47.573173 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:38:47.573351 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 194
   Code: 194. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . (REQUIRED_PASSWORD) (version 25.4.2.31 (official build))
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:38:47.573825 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.67404276, "process_in_blocks": "0", "process_kernel_time": 0.268318, "process_mem_max_rss": "158810112", "process_out_blocks": "0", "process_user_time": 0.957599}
[0m17:38:47.574079 [debug] [MainThread]: Command `dbt debug` failed at 17:38:47.574030 after 0.67 seconds
[0m17:38:47.574263 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:38:47.574413 [debug] [MainThread]: On debug: No close available on handle
[0m17:38:47.574590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d27ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb9c9d0>]}
[0m17:38:47.574792 [debug] [MainThread]: Flushing usage events
[0m17:38:48.116907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:25.751106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c9acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d26bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d27490>]}


============================== 17:39:25.754021 | d1711455-2f75-4c11-b373-aaf4cc9b1e6e ==============================
[0m17:39:25.754021 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:25.754358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:25.762938 [info ] [MainThread]: dbt version: 1.9.4
[0m17:39:25.763203 [info ] [MainThread]: python version: 3.11.8
[0m17:39:25.763370 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:39:25.763512 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:39:25.798734 [info ] [MainThread]: Using profiles dir at .
[0m17:39:25.799039 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:39:25.799191 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:39:25.799647 [info ] [MainThread]: adapter type: clickhouse
[0m17:39:25.799845 [info ] [MainThread]: adapter version: 1.9.1
[0m17:39:25.849107 [info ] [MainThread]: Configuration:
[0m17:39:25.849408 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:39:25.849550 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:39:25.849680 [info ] [MainThread]: Required dependencies:
[0m17:39:25.849870 [debug] [MainThread]: Executing "git --help"
[0m17:39:25.866675 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:39:25.867339 [debug] [MainThread]: STDERR: "b''"
[0m17:39:25.867549 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:39:25.867766 [info ] [MainThread]: Connection:
[0m17:39:25.868002 [info ] [MainThread]:   driver: None
[0m17:39:25.868129 [info ] [MainThread]:   host: localhost
[0m17:39:25.868251 [info ] [MainThread]:   port: 8123
[0m17:39:25.868369 [info ] [MainThread]:   user: default
[0m17:39:25.868482 [info ] [MainThread]:   schema: default
[0m17:39:25.868595 [info ] [MainThread]:   retries: 1
[0m17:39:25.868712 [info ] [MainThread]:   cluster: None
[0m17:39:25.868830 [info ] [MainThread]:   database_engine: None
[0m17:39:25.868947 [info ] [MainThread]:   cluster_mode: False
[0m17:39:25.869057 [info ] [MainThread]:   secure: False
[0m17:39:25.869172 [info ] [MainThread]:   verify: True
[0m17:39:25.869285 [info ] [MainThread]:   client_cert: None
[0m17:39:25.869396 [info ] [MainThread]:   client_cert_key: None
[0m17:39:25.869514 [info ] [MainThread]:   connect_timeout: 10
[0m17:39:25.869623 [info ] [MainThread]:   send_receive_timeout: 300
[0m17:39:25.869745 [info ] [MainThread]:   sync_request_timeout: 5
[0m17:39:25.869852 [info ] [MainThread]:   compress_block_size: 1048576
[0m17:39:25.869964 [info ] [MainThread]:   compression: 
[0m17:39:25.870072 [info ] [MainThread]:   check_exchange: True
[0m17:39:25.870180 [info ] [MainThread]:   custom_settings: None
[0m17:39:25.870286 [info ] [MainThread]:   use_lw_deletes: False
[0m17:39:25.870395 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m17:39:25.870504 [info ] [MainThread]:   tcp_keepalive: False
[0m17:39:25.870825 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:39:25.925103 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m17:39:25.925488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:26.361504 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:39:26.361844 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:39:26.362026 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 194
   Code: 194. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . (REQUIRED_PASSWORD) (version 25.4.2.31 (official build))
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:39:26.362523 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6562786, "process_in_blocks": "0", "process_kernel_time": 0.273471, "process_mem_max_rss": "153829376", "process_out_blocks": "0", "process_user_time": 0.962064}
[0m17:39:26.362858 [debug] [MainThread]: Command `dbt debug` failed at 17:39:26.362807 after 0.66 seconds
[0m17:39:26.363039 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:39:26.363184 [debug] [MainThread]: On debug: No close available on handle
[0m17:39:26.363342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c8e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bc89d0>]}
[0m17:39:26.363539 [debug] [MainThread]: Flushing usage events
[0m17:39:26.775414 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:42.353824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d9bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e26f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e27e10>]}


============================== 17:43:42.359377 | 75a77a30-6d32-4b81-9df5-e71f04b820dc ==============================
[0m17:43:42.359377 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:43:42.360104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:42.374897 [info ] [MainThread]: dbt version: 1.9.4
[0m17:43:42.375222 [info ] [MainThread]: python version: 3.11.8
[0m17:43:42.375402 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:43:42.375556 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:43:42.415030 [info ] [MainThread]: Using profiles dir at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt
[0m17:43:42.415398 [info ] [MainThread]: Using profiles.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/profiles.yml
[0m17:43:42.415556 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:43:42.416295 [info ] [MainThread]: adapter type: clickhouse
[0m17:43:42.416436 [info ] [MainThread]: adapter version: 1.9.1
[0m17:43:42.466836 [info ] [MainThread]: Configuration:
[0m17:43:42.467170 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:43:42.467326 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:43:42.467454 [info ] [MainThread]: Required dependencies:
[0m17:43:42.467645 [debug] [MainThread]: Executing "git --help"
[0m17:43:42.483608 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:43:42.484407 [debug] [MainThread]: STDERR: "b''"
[0m17:43:42.484624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:43:42.484813 [info ] [MainThread]: Connection:
[0m17:43:42.485020 [info ] [MainThread]:   driver: None
[0m17:43:42.485143 [info ] [MainThread]:   host: localhost
[0m17:43:42.485273 [info ] [MainThread]:   port: 8123
[0m17:43:42.485392 [info ] [MainThread]:   user: default
[0m17:43:42.485507 [info ] [MainThread]:   schema: default
[0m17:43:42.485622 [info ] [MainThread]:   retries: 1
[0m17:43:42.485735 [info ] [MainThread]:   cluster: None
[0m17:43:42.485857 [info ] [MainThread]:   database_engine: None
[0m17:43:42.485970 [info ] [MainThread]:   cluster_mode: False
[0m17:43:42.486081 [info ] [MainThread]:   secure: False
[0m17:43:42.486194 [info ] [MainThread]:   verify: True
[0m17:43:42.486303 [info ] [MainThread]:   client_cert: None
[0m17:43:42.486418 [info ] [MainThread]:   client_cert_key: None
[0m17:43:42.486529 [info ] [MainThread]:   connect_timeout: 10
[0m17:43:42.486642 [info ] [MainThread]:   send_receive_timeout: 300
[0m17:43:42.486751 [info ] [MainThread]:   sync_request_timeout: 5
[0m17:43:42.487000 [info ] [MainThread]:   compress_block_size: 1048576
[0m17:43:42.487156 [info ] [MainThread]:   compression: 
[0m17:43:42.487298 [info ] [MainThread]:   check_exchange: True
[0m17:43:42.487421 [info ] [MainThread]:   custom_settings: None
[0m17:43:42.487543 [info ] [MainThread]:   use_lw_deletes: False
[0m17:43:42.487660 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m17:43:42.487785 [info ] [MainThread]:   tcp_keepalive: False
[0m17:43:42.488170 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:43:42.540919 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m17:43:42.541368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:42.949155 [debug] [MainThread]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x116fcac90>: Failed to establish a new connection: [Errno 61] Connection refused')) executing HTTP request attempt 1 (http://localhost:8123)
[0m17:43:43.955940 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:43:43.956665 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:43:43.957006 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /? (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1171109d0>: Failed to establish a new connection: [Errno 61] Connection refused')) executing HTTP request attempt 1 (http://localhost:8123)

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:43:43.957784 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.6586802, "process_in_blocks": "0", "process_kernel_time": 0.29918, "process_mem_max_rss": "154910720", "process_out_blocks": "0", "process_user_time": 0.99214}
[0m17:43:43.958237 [debug] [MainThread]: Command `dbt debug` failed at 17:43:43.958138 after 1.66 seconds
[0m17:43:43.958616 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:43:43.958927 [debug] [MainThread]: On debug: No close available on handle
[0m17:43:43.959291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e3be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fd8d0>]}
[0m17:43:43.959732 [debug] [MainThread]: Flushing usage events
[0m17:43:44.434388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:35.821594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d9a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e2ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e2b4d0>]}


============================== 17:46:35.824478 | 6e5d8048-cdf0-45af-abf9-e5e44dccfa86 ==============================
[0m17:46:35.824478 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:46:35.824824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:35.833246 [info ] [MainThread]: dbt version: 1.9.4
[0m17:46:35.833493 [info ] [MainThread]: python version: 3.11.8
[0m17:46:35.833668 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:46:35.833810 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:46:35.871198 [info ] [MainThread]: Using profiles dir at .
[0m17:46:35.871520 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:46:35.871664 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:46:35.872378 [info ] [MainThread]: adapter type: clickhouse
[0m17:46:35.872646 [info ] [MainThread]: adapter version: 1.9.1
[0m17:46:35.923510 [info ] [MainThread]: Configuration:
[0m17:46:35.923821 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:46:35.923963 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:46:35.924091 [info ] [MainThread]: Required dependencies:
[0m17:46:35.924285 [debug] [MainThread]: Executing "git --help"
[0m17:46:35.938718 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:46:35.939291 [debug] [MainThread]: STDERR: "b''"
[0m17:46:35.939470 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:46:35.939652 [info ] [MainThread]: Connection:
[0m17:46:35.939857 [info ] [MainThread]:   driver: None
[0m17:46:35.939982 [info ] [MainThread]:   host: localhost
[0m17:46:35.940100 [info ] [MainThread]:   port: 8123
[0m17:46:35.940215 [info ] [MainThread]:   user: default
[0m17:46:35.940332 [info ] [MainThread]:   schema: default
[0m17:46:35.940457 [info ] [MainThread]:   retries: 1
[0m17:46:35.940571 [info ] [MainThread]:   cluster: None
[0m17:46:35.940685 [info ] [MainThread]:   database_engine: None
[0m17:46:35.940805 [info ] [MainThread]:   cluster_mode: False
[0m17:46:35.940917 [info ] [MainThread]:   secure: False
[0m17:46:35.941029 [info ] [MainThread]:   verify: True
[0m17:46:35.941141 [info ] [MainThread]:   client_cert: None
[0m17:46:35.941255 [info ] [MainThread]:   client_cert_key: None
[0m17:46:35.941367 [info ] [MainThread]:   connect_timeout: 10
[0m17:46:35.941480 [info ] [MainThread]:   send_receive_timeout: 300
[0m17:46:35.941597 [info ] [MainThread]:   sync_request_timeout: 5
[0m17:46:35.941708 [info ] [MainThread]:   compress_block_size: 1048576
[0m17:46:35.941817 [info ] [MainThread]:   compression: 
[0m17:46:35.941927 [info ] [MainThread]:   check_exchange: True
[0m17:46:35.942036 [info ] [MainThread]:   custom_settings: None
[0m17:46:35.942151 [info ] [MainThread]:   use_lw_deletes: False
[0m17:46:35.942265 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m17:46:35.942378 [info ] [MainThread]:   tcp_keepalive: False
[0m17:46:35.942734 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:46:35.997748 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m17:46:35.998141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:36.424243 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:46:36.424543 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:46:36.424737 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 194
   Code: 194. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . (REQUIRED_PASSWORD) (version 25.4.2.31 (official build))
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:46:36.425153 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6483522, "process_in_blocks": "0", "process_kernel_time": 0.305774, "process_mem_max_rss": "154157056", "process_out_blocks": "0", "process_user_time": 0.987968}
[0m17:46:36.425396 [debug] [MainThread]: Command `dbt debug` failed at 17:46:36.425347 after 0.65 seconds
[0m17:46:36.425583 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:46:36.425730 [debug] [MainThread]: On debug: No close available on handle
[0m17:46:36.425899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231fb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12703b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1502dcb50>]}
[0m17:46:36.426094 [debug] [MainThread]: Flushing usage events
[0m17:46:36.880769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:39.537254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212b810>]}


============================== 17:47:39.540300 | 98dfdbfa-15c7-40af-9cb5-045c77bcd4d5 ==============================
[0m17:47:39.540300 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:47:39.540687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:39.551068 [info ] [MainThread]: dbt version: 1.9.4
[0m17:47:39.551371 [info ] [MainThread]: python version: 3.11.8
[0m17:47:39.551580 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:47:39.551729 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:47:39.592930 [info ] [MainThread]: Using profiles dir at .
[0m17:47:39.593308 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:47:39.593513 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:47:39.594024 [info ] [MainThread]: adapter type: clickhouse
[0m17:47:39.594262 [info ] [MainThread]: adapter version: 1.9.1
[0m17:47:39.646035 [info ] [MainThread]: Configuration:
[0m17:47:39.646373 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:47:39.646524 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:47:39.646654 [info ] [MainThread]: Required dependencies:
[0m17:47:39.646832 [debug] [MainThread]: Executing "git --help"
[0m17:47:39.661854 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:47:39.662540 [debug] [MainThread]: STDERR: "b''"
[0m17:47:39.662760 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:47:39.662964 [info ] [MainThread]: Connection:
[0m17:47:39.663164 [info ] [MainThread]:   driver: None
[0m17:47:39.663293 [info ] [MainThread]:   host: localhost
[0m17:47:39.663429 [info ] [MainThread]:   port: 8123
[0m17:47:39.663549 [info ] [MainThread]:   user: default
[0m17:47:39.663662 [info ] [MainThread]:   schema: default
[0m17:47:39.663782 [info ] [MainThread]:   retries: 1
[0m17:47:39.663901 [info ] [MainThread]:   cluster: None
[0m17:47:39.664016 [info ] [MainThread]:   database_engine: None
[0m17:47:39.664135 [info ] [MainThread]:   cluster_mode: False
[0m17:47:39.664253 [info ] [MainThread]:   secure: False
[0m17:47:39.664367 [info ] [MainThread]:   verify: True
[0m17:47:39.664481 [info ] [MainThread]:   client_cert: None
[0m17:47:39.664615 [info ] [MainThread]:   client_cert_key: None
[0m17:47:39.664868 [info ] [MainThread]:   connect_timeout: 10
[0m17:47:39.665014 [info ] [MainThread]:   send_receive_timeout: 300
[0m17:47:39.665145 [info ] [MainThread]:   sync_request_timeout: 5
[0m17:47:39.665269 [info ] [MainThread]:   compress_block_size: 1048576
[0m17:47:39.665388 [info ] [MainThread]:   compression: 
[0m17:47:39.665508 [info ] [MainThread]:   check_exchange: True
[0m17:47:39.665622 [info ] [MainThread]:   custom_settings: None
[0m17:47:39.665740 [info ] [MainThread]:   use_lw_deletes: False
[0m17:47:39.665853 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m17:47:39.665970 [info ] [MainThread]:   tcp_keepalive: False
[0m17:47:39.666303 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:47:39.723886 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m17:47:39.724296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:40.137761 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:47:40.138099 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:47:40.138283 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 194
   Code: 194. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . (REQUIRED_PASSWORD) (version 25.4.2.31 (official build))
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:47:40.138681 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6489845, "process_in_blocks": "0", "process_kernel_time": 0.319265, "process_mem_max_rss": "151355392", "process_out_blocks": "0", "process_user_time": 1.023325}
[0m17:47:40.138893 [debug] [MainThread]: Command `dbt debug` failed at 17:47:40.138850 after 0.65 seconds
[0m17:47:40.139082 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:47:40.139287 [debug] [MainThread]: On debug: No close available on handle
[0m17:47:40.139513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11208e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112105250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f04a90>]}
[0m17:47:40.139787 [debug] [MainThread]: Flushing usage events
[0m17:47:40.564810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:10.156832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109205310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109227810>]}


============================== 17:55:10.159268 | 65eec7aa-3609-42a6-acf1-abf94d4fe278 ==============================
[0m17:55:10.159268 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:55:10.159583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:10.163891 [info ] [MainThread]: dbt version: 1.9.4
[0m17:55:10.164091 [info ] [MainThread]: python version: 3.11.8
[0m17:55:10.164252 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m17:55:10.164395 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m17:55:10.201864 [info ] [MainThread]: Using profiles dir at .
[0m17:55:10.202200 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:55:10.202344 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m17:55:10.202995 [info ] [MainThread]: adapter type: clickhouse
[0m17:55:10.203183 [info ] [MainThread]: adapter version: 1.9.1
[0m17:55:10.251399 [info ] [MainThread]: Configuration:
[0m17:55:10.251716 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:55:10.251859 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:55:10.252054 [info ] [MainThread]: Required dependencies:
[0m17:55:10.252287 [debug] [MainThread]: Executing "git --help"
[0m17:55:10.265981 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:55:10.266675 [debug] [MainThread]: STDERR: "b''"
[0m17:55:10.266906 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:55:10.267072 [info ] [MainThread]: Connection:
[0m17:55:10.267297 [info ] [MainThread]:   driver: None
[0m17:55:10.267431 [info ] [MainThread]:   host: localhost
[0m17:55:10.267549 [info ] [MainThread]:   port: 8123
[0m17:55:10.267667 [info ] [MainThread]:   user: dagster_dbt
[0m17:55:10.267783 [info ] [MainThread]:   schema: default
[0m17:55:10.267900 [info ] [MainThread]:   retries: 1
[0m17:55:10.268018 [info ] [MainThread]:   cluster: None
[0m17:55:10.268132 [info ] [MainThread]:   database_engine: None
[0m17:55:10.268245 [info ] [MainThread]:   cluster_mode: False
[0m17:55:10.268354 [info ] [MainThread]:   secure: False
[0m17:55:10.268467 [info ] [MainThread]:   verify: True
[0m17:55:10.268577 [info ] [MainThread]:   client_cert: None
[0m17:55:10.268690 [info ] [MainThread]:   client_cert_key: None
[0m17:55:10.268803 [info ] [MainThread]:   connect_timeout: 10
[0m17:55:10.268917 [info ] [MainThread]:   send_receive_timeout: 300
[0m17:55:10.269026 [info ] [MainThread]:   sync_request_timeout: 5
[0m17:55:10.269136 [info ] [MainThread]:   compress_block_size: 1048576
[0m17:55:10.269244 [info ] [MainThread]:   compression: 
[0m17:55:10.269354 [info ] [MainThread]:   check_exchange: True
[0m17:55:10.269464 [info ] [MainThread]:   custom_settings: None
[0m17:55:10.269572 [info ] [MainThread]:   use_lw_deletes: False
[0m17:55:10.269683 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m17:55:10.269790 [info ] [MainThread]:   tcp_keepalive: False
[0m17:55:10.270127 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:55:10.323485 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m17:55:10.323886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:10.720079 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:55:10.720457 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:55:10.720617 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Database Error
    Failed to create default database due to ClickHouse exception

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:55:10.720987 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6047875, "process_in_blocks": "0", "process_kernel_time": 0.213405, "process_mem_max_rss": "154746880", "process_out_blocks": "0", "process_user_time": 0.910691}
[0m17:55:10.721202 [debug] [MainThread]: Command `dbt debug` failed at 17:55:10.721158 after 0.61 seconds
[0m17:55:10.721376 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:55:10.721522 [debug] [MainThread]: On debug: No close available on handle
[0m17:55:10.721701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cadd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109227310>]}
[0m17:55:10.721903 [debug] [MainThread]: Flushing usage events
[0m17:55:11.117538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:55.166079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11839a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118426c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118427510>]}


============================== 18:07:55.169010 | 098f9d53-864b-4cfa-af85-56af8fdc130c ==============================
[0m18:07:55.169010 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:07:55.169326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:07:55.178795 [info ] [MainThread]: dbt version: 1.9.4
[0m18:07:55.179068 [info ] [MainThread]: python version: 3.11.8
[0m18:07:55.179244 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m18:07:55.179393 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m18:07:55.219126 [info ] [MainThread]: Using profiles dir at .
[0m18:07:55.219500 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m18:07:55.219657 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m18:07:55.220243 [info ] [MainThread]: adapter type: clickhouse
[0m18:07:55.220520 [info ] [MainThread]: adapter version: 1.9.1
[0m18:07:55.275535 [info ] [MainThread]: Configuration:
[0m18:07:55.275901 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:07:55.276047 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:07:55.276176 [info ] [MainThread]: Required dependencies:
[0m18:07:55.276374 [debug] [MainThread]: Executing "git --help"
[0m18:07:55.290289 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:07:55.290967 [debug] [MainThread]: STDERR: "b''"
[0m18:07:55.291157 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:07:55.291372 [info ] [MainThread]: Connection:
[0m18:07:55.291572 [info ] [MainThread]:   driver: None
[0m18:07:55.291697 [info ] [MainThread]:   host: localhost
[0m18:07:55.291820 [info ] [MainThread]:   port: 9002
[0m18:07:55.291933 [info ] [MainThread]:   user: default
[0m18:07:55.292047 [info ] [MainThread]:   schema: default
[0m18:07:55.292163 [info ] [MainThread]:   retries: 1
[0m18:07:55.292285 [info ] [MainThread]:   cluster: None
[0m18:07:55.292402 [info ] [MainThread]:   database_engine: None
[0m18:07:55.292516 [info ] [MainThread]:   cluster_mode: False
[0m18:07:55.292627 [info ] [MainThread]:   secure: False
[0m18:07:55.292739 [info ] [MainThread]:   verify: True
[0m18:07:55.292847 [info ] [MainThread]:   client_cert: None
[0m18:07:55.292959 [info ] [MainThread]:   client_cert_key: None
[0m18:07:55.293070 [info ] [MainThread]:   connect_timeout: 10
[0m18:07:55.293179 [info ] [MainThread]:   send_receive_timeout: 300
[0m18:07:55.293293 [info ] [MainThread]:   sync_request_timeout: 5
[0m18:07:55.293411 [info ] [MainThread]:   compress_block_size: 1048576
[0m18:07:55.293521 [info ] [MainThread]:   compression: 
[0m18:07:55.293635 [info ] [MainThread]:   check_exchange: True
[0m18:07:55.293745 [info ] [MainThread]:   custom_settings: None
[0m18:07:55.293855 [info ] [MainThread]:   use_lw_deletes: False
[0m18:07:55.293964 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m18:07:55.294070 [info ] [MainThread]:   tcp_keepalive: False
[0m18:07:55.294491 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:07:55.350557 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m18:07:55.350954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:56.244287 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:07:56.245349 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:07:56.245722 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  HTTPDriver for http://localhost:9002 returned response code 400

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:07:56.246711 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.1248292, "process_in_blocks": "0", "process_kernel_time": 0.277666, "process_mem_max_rss": "153780224", "process_out_blocks": "0", "process_user_time": 0.948426}
[0m18:07:56.247240 [debug] [MainThread]: Command `dbt debug` failed at 18:07:56.247124 after 1.13 seconds
[0m18:07:56.247742 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:07:56.248102 [debug] [MainThread]: On debug: No close available on handle
[0m18:07:56.248518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11838e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11873b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11843fbd0>]}
[0m18:07:56.249019 [debug] [MainThread]: Flushing usage events
[0m18:07:56.726469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:14.276976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a399410>]}


============================== 18:08:14.280543 | a17cf26c-cbdb-4081-9729-e8af7917523f ==============================
[0m18:08:14.280543 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:08:14.280915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m18:08:14.289083 [info ] [MainThread]: dbt version: 1.9.4
[0m18:08:14.289393 [info ] [MainThread]: python version: 3.11.8
[0m18:08:14.289571 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m18:08:14.289715 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m18:08:14.329202 [info ] [MainThread]: Using profiles dir at .
[0m18:08:14.329562 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m18:08:14.329719 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m18:08:14.330342 [info ] [MainThread]: adapter type: clickhouse
[0m18:08:14.330693 [info ] [MainThread]: adapter version: 1.9.1
[0m18:08:14.385240 [info ] [MainThread]: Configuration:
[0m18:08:14.385570 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:08:14.385719 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:08:14.385847 [info ] [MainThread]: Required dependencies:
[0m18:08:14.386021 [debug] [MainThread]: Executing "git --help"
[0m18:08:14.400561 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:08:14.401234 [debug] [MainThread]: STDERR: "b''"
[0m18:08:14.401434 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:08:14.401635 [info ] [MainThread]: Connection:
[0m18:08:14.401831 [info ] [MainThread]:   driver: None
[0m18:08:14.401965 [info ] [MainThread]:   host: localhost
[0m18:08:14.402096 [info ] [MainThread]:   port: 8123
[0m18:08:14.402216 [info ] [MainThread]:   user: default
[0m18:08:14.402337 [info ] [MainThread]:   schema: default
[0m18:08:14.402453 [info ] [MainThread]:   retries: 1
[0m18:08:14.402571 [info ] [MainThread]:   cluster: None
[0m18:08:14.402696 [info ] [MainThread]:   database_engine: None
[0m18:08:14.402819 [info ] [MainThread]:   cluster_mode: False
[0m18:08:14.402938 [info ] [MainThread]:   secure: False
[0m18:08:14.403058 [info ] [MainThread]:   verify: True
[0m18:08:14.403171 [info ] [MainThread]:   client_cert: None
[0m18:08:14.403294 [info ] [MainThread]:   client_cert_key: None
[0m18:08:14.403412 [info ] [MainThread]:   connect_timeout: 10
[0m18:08:14.403529 [info ] [MainThread]:   send_receive_timeout: 300
[0m18:08:14.403721 [info ] [MainThread]:   sync_request_timeout: 5
[0m18:08:14.403998 [info ] [MainThread]:   compress_block_size: 1048576
[0m18:08:14.404142 [info ] [MainThread]:   compression: 
[0m18:08:14.404270 [info ] [MainThread]:   check_exchange: True
[0m18:08:14.404399 [info ] [MainThread]:   custom_settings: None
[0m18:08:14.404524 [info ] [MainThread]:   use_lw_deletes: False
[0m18:08:14.404652 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m18:08:14.404772 [info ] [MainThread]:   tcp_keepalive: False
[0m18:08:14.405137 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:08:14.460647 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m18:08:14.461049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:14.822352 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:08:14.822685 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:08:14.822865 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 194
   Code: 194. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . (REQUIRED_PASSWORD) (version 25.4.2.31 (official build))
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:08:14.823251 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.59151953, "process_in_blocks": "0", "process_kernel_time": 0.268911, "process_mem_max_rss": "154107904", "process_out_blocks": "0", "process_user_time": 0.997954}
[0m18:08:14.823488 [debug] [MainThread]: Command `dbt debug` failed at 18:08:14.823442 after 0.59 seconds
[0m18:08:14.823664 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:08:14.823808 [debug] [MainThread]: On debug: No close available on handle
[0m18:08:14.823984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba83790>]}
[0m18:08:14.824196 [debug] [MainThread]: Flushing usage events
[0m18:08:15.289592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:01.633397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a79a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c004fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0275d0>]}


============================== 18:10:01.636212 | 6062e6fe-be03-4291-9e32-ccb69f0abdad ==============================
[0m18:10:01.636212 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:10:01.636536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:10:01.645559 [info ] [MainThread]: dbt version: 1.9.4
[0m18:10:01.645823 [info ] [MainThread]: python version: 3.11.8
[0m18:10:01.645993 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m18:10:01.646138 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m18:10:01.682806 [info ] [MainThread]: Using profiles dir at .
[0m18:10:01.683117 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m18:10:01.683267 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m18:10:01.683887 [info ] [MainThread]: adapter type: clickhouse
[0m18:10:01.684057 [info ] [MainThread]: adapter version: 1.9.1
[0m18:10:01.733267 [info ] [MainThread]: Configuration:
[0m18:10:01.733570 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:10:01.733710 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:10:01.733832 [info ] [MainThread]: Required dependencies:
[0m18:10:01.734051 [debug] [MainThread]: Executing "git --help"
[0m18:10:01.747833 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:10:01.748534 [debug] [MainThread]: STDERR: "b''"
[0m18:10:01.748726 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:10:01.748917 [info ] [MainThread]: Connection:
[0m18:10:01.749144 [info ] [MainThread]:   driver: None
[0m18:10:01.749275 [info ] [MainThread]:   host: localhost
[0m18:10:01.749398 [info ] [MainThread]:   port: 8123
[0m18:10:01.749528 [info ] [MainThread]:   user: dagster_dbt
[0m18:10:01.749642 [info ] [MainThread]:   schema: default
[0m18:10:01.749756 [info ] [MainThread]:   retries: 1
[0m18:10:01.749875 [info ] [MainThread]:   cluster: None
[0m18:10:01.749990 [info ] [MainThread]:   database_engine: None
[0m18:10:01.750106 [info ] [MainThread]:   cluster_mode: False
[0m18:10:01.750218 [info ] [MainThread]:   secure: False
[0m18:10:01.750333 [info ] [MainThread]:   verify: True
[0m18:10:01.750446 [info ] [MainThread]:   client_cert: None
[0m18:10:01.750560 [info ] [MainThread]:   client_cert_key: None
[0m18:10:01.750676 [info ] [MainThread]:   connect_timeout: 10
[0m18:10:01.750790 [info ] [MainThread]:   send_receive_timeout: 300
[0m18:10:01.750906 [info ] [MainThread]:   sync_request_timeout: 5
[0m18:10:01.751020 [info ] [MainThread]:   compress_block_size: 1048576
[0m18:10:01.751285 [info ] [MainThread]:   compression: 
[0m18:10:01.751453 [info ] [MainThread]:   check_exchange: True
[0m18:10:01.751589 [info ] [MainThread]:   custom_settings: None
[0m18:10:01.751718 [info ] [MainThread]:   use_lw_deletes: False
[0m18:10:01.751842 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m18:10:01.751960 [info ] [MainThread]:   tcp_keepalive: False
[0m18:10:01.752307 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:10:01.807392 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m18:10:01.807796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:02.188687 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:10:02.189028 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:10:02.189192 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Database Error
    Failed to create default database due to ClickHouse exception

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:10:02.189557 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5984595, "process_in_blocks": "0", "process_kernel_time": 0.260449, "process_mem_max_rss": "152272896", "process_out_blocks": "0", "process_user_time": 0.923227}
[0m18:10:02.189796 [debug] [MainThread]: Command `dbt debug` failed at 18:10:02.189740 after 0.60 seconds
[0m18:10:02.189977 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:10:02.190120 [debug] [MainThread]: On debug: No close available on handle
[0m18:10:02.190290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c006910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c027390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b5610>]}
[0m18:10:02.190490 [debug] [MainThread]: Flushing usage events
[0m18:10:03.049519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:52.098406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112999410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a275d0>]}


============================== 18:10:52.101138 | 1e7f5797-b9da-438d-8448-2437ce48f94e ==============================
[0m18:10:52.101138 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:10:52.101499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:52.109711 [info ] [MainThread]: dbt version: 1.9.4
[0m18:10:52.109921 [info ] [MainThread]: python version: 3.11.8
[0m18:10:52.110093 [info ] [MainThread]: python path: /Users/casperdamen/Code/open-source-warehousing/dagster/.venv/bin/python3
[0m18:10:52.110236 [info ] [MainThread]: os info: macOS-15.4-arm64-arm-64bit
[0m18:10:52.152138 [info ] [MainThread]: Using profiles dir at .
[0m18:10:52.152463 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m18:10:52.152605 [info ] [MainThread]: Using dbt_project.yml file at /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/dbt_project.yml
[0m18:10:52.153195 [info ] [MainThread]: adapter type: clickhouse
[0m18:10:52.153453 [info ] [MainThread]: adapter version: 1.9.1
[0m18:10:52.206644 [info ] [MainThread]: Configuration:
[0m18:10:52.206972 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:10:52.207115 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:10:52.207244 [info ] [MainThread]: Required dependencies:
[0m18:10:52.207440 [debug] [MainThread]: Executing "git --help"
[0m18:10:52.225010 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:10:52.225764 [debug] [MainThread]: STDERR: "b''"
[0m18:10:52.225972 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:10:52.226150 [info ] [MainThread]: Connection:
[0m18:10:52.226359 [info ] [MainThread]:   driver: None
[0m18:10:52.226480 [info ] [MainThread]:   host: localhost
[0m18:10:52.226596 [info ] [MainThread]:   port: 8123
[0m18:10:52.226709 [info ] [MainThread]:   user: dagster_dbt
[0m18:10:52.226822 [info ] [MainThread]:   schema: default
[0m18:10:52.226930 [info ] [MainThread]:   retries: 1
[0m18:10:52.227047 [info ] [MainThread]:   cluster: None
[0m18:10:52.227172 [info ] [MainThread]:   database_engine: None
[0m18:10:52.227289 [info ] [MainThread]:   cluster_mode: False
[0m18:10:52.227402 [info ] [MainThread]:   secure: False
[0m18:10:52.227516 [info ] [MainThread]:   verify: True
[0m18:10:52.227629 [info ] [MainThread]:   client_cert: None
[0m18:10:52.227743 [info ] [MainThread]:   client_cert_key: None
[0m18:10:52.227850 [info ] [MainThread]:   connect_timeout: 10
[0m18:10:52.227959 [info ] [MainThread]:   send_receive_timeout: 300
[0m18:10:52.228065 [info ] [MainThread]:   sync_request_timeout: 5
[0m18:10:52.228172 [info ] [MainThread]:   compress_block_size: 1048576
[0m18:10:52.228278 [info ] [MainThread]:   compression: 
[0m18:10:52.228383 [info ] [MainThread]:   check_exchange: True
[0m18:10:52.228488 [info ] [MainThread]:   custom_settings: None
[0m18:10:52.228595 [info ] [MainThread]:   use_lw_deletes: False
[0m18:10:52.228699 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m18:10:52.228807 [info ] [MainThread]:   tcp_keepalive: False
[0m18:10:52.229110 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:10:52.284245 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m18:10:52.284684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:52.711648 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m18:10:52.714712 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:10:52.733487 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:10:52.733788 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:10:52.734127 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6799509, "process_in_blocks": "0", "process_kernel_time": 0.275398, "process_mem_max_rss": "160186368", "process_out_blocks": "0", "process_user_time": 0.951804}
[0m18:10:52.734350 [debug] [MainThread]: Command `dbt debug` succeeded at 18:10:52.734306 after 0.68 seconds
[0m18:10:52.734524 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:10:52.734668 [debug] [MainThread]: On debug: Close
[0m18:10:52.734877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fa2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115922c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137cfb10>]}
[0m18:10:52.735098 [debug] [MainThread]: Flushing usage events
[0m18:10:53.137997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:32.795145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096da4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971bf90>]}


============================== 18:11:32.798584 | 54956f57-37a6-41c5-9e01-a2c2b553e9a0 ==============================
[0m18:11:32.798584 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:11:32.799026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'send_anonymous_usage_stats': 'True'}
[0m18:11:32.920920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a48dd0>]}
[0m18:11:32.956507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa29410>]}
[0m18:11:32.957450 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:11:33.022078 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:11:33.022740 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:11:33.023010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7dc10>]}
[0m18:11:33.607022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf9510>]}
[0m18:11:33.634808 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:11:33.636979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:11:33.655660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b016190>]}
[0m18:11:33.655955 [info ] [MainThread]: Found 3 models, 476 macros
[0m18:11:33.656124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa4efd0>]}
[0m18:11:33.656795 [info ] [MainThread]: 
[0m18:11:33.656963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:33.657093 [info ] [MainThread]: 
[0m18:11:33.657321 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:11:33.657771 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:11:33.662596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:34.099292 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:11:34.101958 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:11:34.115632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m18:11:34.118851 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m18:11:34.138281 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:11:34.139368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8e8690>]}
[0m18:11:34.141490 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m18:11:34.141847 [info ] [Thread-1 (]: 1 of 1 START sql view model `default`.`stg_weather_forecasts` .................. [RUN]
[0m18:11:34.142127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m18:11:34.142308 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m18:11:34.146761 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:11:34.147439 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m18:11:34.154257 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m18:11:34.161127 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:11:34.162006 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/*/20*.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m18:11:34.171128 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/*/20*.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m18:11:34.175718 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:11:34.176591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54956f57-37a6-41c5-9e01-a2c2b553e9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc52d10>]}
[0m18:11:34.176937 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default`.`stg_weather_forecasts` ......... [[31mERROR[0m in 0.03s]
[0m18:11:34.177221 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m18:11:34.177512 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather_forecasts' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql.
[0m18:11:34.178425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:34.178579 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m18:11:34.178716 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m18:11:34.178903 [info ] [MainThread]: 
[0m18:11:34.179048 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m18:11:34.179345 [debug] [MainThread]: Command end result
[0m18:11:34.190609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:11:34.191431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:11:34.194228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m18:11:34.194393 [info ] [MainThread]: 
[0m18:11:34.194571 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:11:34.194720 [info ] [MainThread]: 
[0m18:11:34.194908 [error] [MainThread]:   Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:11:34.195058 [info ] [MainThread]: 
[0m18:11:34.195201 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:11:34.195607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4478232, "process_in_blocks": "0", "process_kernel_time": 0.325779, "process_mem_max_rss": "168902656", "process_out_blocks": "0", "process_user_time": 1.690554}
[0m18:11:34.195868 [debug] [MainThread]: Command `dbt run` failed at 18:11:34.195823 after 1.45 seconds
[0m18:11:34.196066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10968e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097301d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109730050>]}
[0m18:11:34.196258 [debug] [MainThread]: Flushing usage events
[0m18:11:34.720335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:10.770648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1bf90>]}


============================== 18:12:10.773675 | 11e6d308-766b-4d7d-b5b1-650d1162ad53 ==============================
[0m18:12:10.773675 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:12:10.774032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:10.883824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f44ed0>]}
[0m18:12:10.916160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e50490>]}
[0m18:12:10.917126 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:12:10.975712 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:12:11.029271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:11.029589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:11.043708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109208d0>]}
[0m18:12:11.071825 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:12:11.075223 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:12:11.086195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e74190>]}
[0m18:12:11.086501 [info ] [MainThread]: Found 3 models, 476 macros
[0m18:12:11.086681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a46fd0>]}
[0m18:12:11.087500 [info ] [MainThread]: 
[0m18:12:11.087697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:11.087836 [info ] [MainThread]: 
[0m18:12:11.088086 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:12:11.088520 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:12:11.093781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:11.517154 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:12:11.519838 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:12:11.533288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m18:12:11.536921 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m18:12:11.541052 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:12:11.541841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147922d0>]}
[0m18:12:11.543579 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m18:12:11.543905 [info ] [Thread-1 (]: 1 of 1 START sql view model `default`.`stg_weather_forecasts` .................. [RUN]
[0m18:12:11.544177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m18:12:11.544352 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m18:12:11.548604 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:12:11.549089 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m18:12:11.555934 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m18:12:11.562958 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:12:11.563477 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/*/20*.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m18:12:11.589508 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/*/20*.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m18:12:11.594824 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Could not list objects in bucket 'weather-data' with prefix 'weather_forecasts/', S3 exception: ``, message: '': The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:12:11.595697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e6d308-766b-4d7d-b5b1-650d1162ad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11238d210>]}
[0m18:12:11.596089 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default`.`stg_weather_forecasts` ......... [[31mERROR[0m in 0.05s]
[0m18:12:11.596400 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m18:12:11.596696 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather_forecasts' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Could not list objects in bucket 'weather-data' with prefix 'weather_forecasts/', S3 exception: ``, message: '': The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql.
[0m18:12:11.597807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:11.598003 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m18:12:11.598272 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m18:12:11.598504 [info ] [MainThread]: 
[0m18:12:11.598669 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m18:12:11.598979 [debug] [MainThread]: Command end result
[0m18:12:11.610886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:12:11.611874 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:12:11.614880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m18:12:11.615057 [info ] [MainThread]: 
[0m18:12:11.615231 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:12:11.615366 [info ] [MainThread]: 
[0m18:12:11.615534 [error] [MainThread]:   Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Could not list objects in bucket 'weather-data' with prefix 'weather_forecasts/', S3 exception: ``, message: '': The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:12:11.615677 [info ] [MainThread]: 
[0m18:12:11.615817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:12:11.616134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8886918, "process_in_blocks": "0", "process_kernel_time": 0.29, "process_mem_max_rss": "164708352", "process_out_blocks": "0", "process_user_time": 1.128284}
[0m18:12:11.616333 [debug] [MainThread]: Command `dbt run` failed at 18:12:11.616296 after 0.89 seconds
[0m18:12:11.616520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f30110>]}
[0m18:12:11.616689 [debug] [MainThread]: Flushing usage events
[0m18:12:12.052797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:02.126178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a29bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31fb50>]}


============================== 18:19:02.129027 | af72e057-4af2-44c6-a47f-7d2a3ace14da ==============================
[0m18:19:02.129027 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:19:02.129365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:19:02.234805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a348310>]}
[0m18:19:02.265935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884c310>]}
[0m18:19:02.266755 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:19:02.324430 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:19:02.377776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:19:02.378204 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/staging/stg_weather_forecasts.sql
[0m18:19:02.538884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b187e90>]}
[0m18:19:02.566113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:19:02.568310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:19:02.579655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d77d0>]}
[0m18:19:02.579928 [info ] [MainThread]: Found 3 models, 476 macros
[0m18:19:02.580092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0dbb10>]}
[0m18:19:02.580750 [info ] [MainThread]: 
[0m18:19:02.580917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:19:02.581043 [info ] [MainThread]: 
[0m18:19:02.581297 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:19:02.581706 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:19:02.586108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:03.053209 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:19:03.055987 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:19:03.070613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m18:19:03.073810 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m18:19:03.079068 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:19:03.079848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b450410>]}
[0m18:19:03.081380 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m18:19:03.081667 [info ] [Thread-1 (]: 1 of 1 START sql view model `default`.`stg_weather_forecasts` .................. [RUN]
[0m18:19:03.081900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m18:19:03.082070 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m18:19:03.086616 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:19:03.087257 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m18:19:03.093851 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m18:19:03.100041 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:19:03.100612 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/*/*.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m18:19:03.113476 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/*/*.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m18:19:03.118653 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Could not list objects in bucket 'weather-data' with prefix 'weather_forecasts/', S3 exception: ``, message: '': The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:19:03.119472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af72e057-4af2-44c6-a47f-7d2a3ace14da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e78ff10>]}
[0m18:19:03.119825 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default`.`stg_weather_forecasts` ......... [[31mERROR[0m in 0.04s]
[0m18:19:03.120110 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m18:19:03.120387 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather_forecasts' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Could not list objects in bucket 'weather-data' with prefix 'weather_forecasts/', S3 exception: ``, message: '': The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql.
[0m18:19:03.121392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:03.121651 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m18:19:03.121802 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m18:19:03.121991 [info ] [MainThread]: 
[0m18:19:03.122153 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m18:19:03.122468 [debug] [MainThread]: Command end result
[0m18:19:03.132814 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:19:03.133616 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:19:03.136459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m18:19:03.136641 [info ] [MainThread]: 
[0m18:19:03.136824 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:19:03.136959 [info ] [MainThread]: 
[0m18:19:03.137141 [error] [MainThread]:   Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Could not list objects in bucket 'weather-data' with prefix 'weather_forecasts/', S3 exception: ``, message: '': The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:19:03.137288 [info ] [MainThread]: 
[0m18:19:03.137423 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:19:03.137703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.057816, "process_in_blocks": "0", "process_kernel_time": 0.277763, "process_mem_max_rss": "166821888", "process_out_blocks": "0", "process_user_time": 1.285955}
[0m18:19:03.137883 [debug] [MainThread]: Command `dbt run` failed at 18:19:03.137849 after 1.06 seconds
[0m18:19:03.138076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a28e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a331890>]}
[0m18:19:03.138245 [debug] [MainThread]: Flushing usage events
[0m18:19:03.552731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:00.125540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4fd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d51fc10>]}


============================== 18:22:00.128582 | 70b17750-56d4-4978-a9b7-9e338023c28a ==============================
[0m18:22:00.128582 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:22:00.128944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:22:00.244682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2928d0>]}
[0m18:22:00.279574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c450350>]}
[0m18:22:00.280596 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m18:22:00.344329 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:22:00.404912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:22:00.405367 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/staging/stg_weather_forecasts.sql
[0m18:22:00.578068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d973950>]}
[0m18:22:00.604474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m18:22:00.606733 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m18:22:00.618916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc1d450>]}
[0m18:22:00.619218 [info ] [MainThread]: Found 3 models, 476 macros
[0m18:22:00.619395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc24850>]}
[0m18:22:00.620339 [info ] [MainThread]: 
[0m18:22:00.620602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:00.620755 [info ] [MainThread]: 
[0m18:22:00.621016 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:22:00.621490 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:22:00.626199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:01.082299 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:22:01.085332 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:22:01.099959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m18:22:01.103118 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m18:22:01.109164 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:22:01.110054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc346d0>]}
[0m18:22:01.111563 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m18:22:01.111897 [info ] [Thread-1 (]: 1 of 1 START sql view model `default`.`stg_weather_forecasts` .................. [RUN]
[0m18:22:01.112183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m18:22:01.112372 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m18:22:01.117105 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:22:01.117685 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m18:22:01.124070 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m18:22:01.130615 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m18:22:01.131328 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/all.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m18:23:52.595685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m18:23:52.601017 [debug] [MainThread]: dbt_clickhouse adapter: Cancelling query 'model.weather_warehouse.stg_weather_forecasts'
[0m18:23:52.601500 [debug] [MainThread]: dbt_clickhouse adapter: Cancel query 'model.weather_warehouse.stg_weather_forecasts'
[0m18:23:52.602102 [error] [MainThread]: CANCEL query model.weather_warehouse.stg_weather_forecasts ..................... [[31mCANCEL[0m]
[0m18:27:01.139631 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from the raw JSON data in MinIO.
    This uses ClickHouse's file() function to read directly from S3.
*/






WITH raw_files AS (
    SELECT 
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude, 
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
        'http://localhost:9000/weather-data/weather_forecasts/all.json',
        'YloX0VqDctbLisJf5iQv',
        'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
    )
),

exploded_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        arrayJoin(arrayZip(
            JSONExtractArrayString(times, '_'),
            JSONExtractArrayFloat(temperatures, '_'),
            JSONExtractArrayFloat(precipitations, '_'),
            JSONExtractArrayFloat(windspeeds, '_')
        )) AS data
    FROM raw_files
    WHERE city_name != 'all' -- Exclude the aggregated data
)

SELECT
    city_name,
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m
FROM exploded_data
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m18:27:01.167368 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  Error HTTPConnectionPool(host='localhost', port=8123): Read timed out. (read timeout=300) executing HTTP request attempt 1 (http://localhost:8123)
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m18:27:01.169446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b17750-56d4-4978-a9b7-9e338023c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a77d7d0>]}
[0m18:27:01.171192 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default`.`stg_weather_forecasts` ......... [[31mERROR[0m in 300.06s]
[0m18:27:01.171804 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m18:27:01.172514 [info ] [MainThread]: 
[0m18:27:01.172872 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m18:27:01.173136 [info ] [MainThread]: 
[0m18:27:01.173597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m18:27:01.173937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:01.174410 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m18:27:01.174702 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m18:27:01.174996 [info ] [MainThread]: 
[0m18:27:01.175393 [info ] [MainThread]: Finished running  in 0 hours 5 minutes and 0.55 seconds (300.55s).
[0m18:27:01.176175 [error] [MainThread]: Encountered an error:

[0m18:27:01.179331 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/Users/casperdamen/Code/open-source-warehousing/dagster/.venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/Users/casperdamen/.local/share/uv/python/cpython-3.11.8-macos-aarch64-none/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/Users/casperdamen/.local/share/uv/python/cpython-3.11.8-macos-aarch64-none/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m18:27:01.181488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 301.10364, "process_in_blocks": "0", "process_kernel_time": 0.382194, "process_mem_max_rss": "168263680", "process_out_blocks": "0", "process_user_time": 1.364753}
[0m18:27:01.181896 [debug] [MainThread]: Command `dbt run` failed at 18:27:01.181832 after 301.10 seconds
[0m18:27:01.182326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d492690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d51eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbc7850>]}
[0m18:27:01.182585 [debug] [MainThread]: Flushing usage events
[0m18:27:01.679287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:53.204674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb99a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd1f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd1fb10>]}


============================== 19:28:53.208320 | 8574fcf0-34f3-4ecf-b397-70fd31f8bf95 ==============================
[0m19:28:53.208320 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:28:53.208722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:28:53.315960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd1f450>]}
[0m19:28:53.348561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c4c410>]}
[0m19:28:53.349589 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m19:28:53.409345 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:28:53.462563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:53.462940 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/staging/stg_weather_forecasts.sql
[0m19:28:53.641313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a3b550>]}
[0m19:28:53.668120 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m19:28:53.670286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m19:28:53.681762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de59d10>]}
[0m19:28:53.682071 [info ] [MainThread]: Found 3 models, 476 macros
[0m19:28:53.682236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc6ec10>]}
[0m19:28:53.682918 [info ] [MainThread]: 
[0m19:28:53.683096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:53.683224 [info ] [MainThread]: 
[0m19:28:53.683481 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m19:28:53.684075 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m19:28:53.688477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:54.340813 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m19:28:54.344867 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:28:54.359596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m19:28:54.362669 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m19:28:54.368183 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m19:28:54.369033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb51a90>]}
[0m19:28:54.370669 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m19:28:54.370963 [info ] [Thread-1 (]: 1 of 1 START sql view model `default`.`stg_weather_forecasts` .................. [RUN]
[0m19:28:54.371201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m19:28:54.371373 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m19:28:54.375756 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m19:28:54.376399 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m19:28:54.382996 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m19:28:54.389380 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m19:28:54.389952 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from MinIO S3 storage.
    Parses a specific Nijmegen weather data file.
*/






WITH raw_files AS (
    SELECT
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude,
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
            'http://localhost:9000/weather-data/nijmegen/20250507_192342.json',
            'YloX0VqDctbLisJf5iQv',
            'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
         )
),

exploded_data AS (
         SELECT
             city_name,
             latitude,
             longitude,
             arrayJoin(arrayZip(
                     JSONExtractArrayString(times, '_'),
                     JSONExtractArrayFloat(temperatures, '_'),
                     JSONExtractArrayFloat(precipitations, '_'),
                     JSONExtractArrayFloat(windspeeds, '_')
                       )) AS data
         FROM raw_files
     )

SELECT
    COALESCE(city_name, 'Nijmegen') AS city_name,  -- Default to Nijmegen if city_name is null
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(parseDateTimeBestEffort(data.1)) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(parseDateTimeBestEffort(data.1)) AS hour_of_day
FROM exploded_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m19:32:30.963636 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts from MinIO S3 storage.
    Parses a specific Nijmegen weather data file.
*/






WITH raw_files AS (
    SELECT
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude,
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
            'http://localhost:9000/weather-data/nijmegen/20250507_192342.json',
            'YloX0VqDctbLisJf5iQv',
            'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
         )
),

exploded_data AS (
         SELECT
             city_name,
             latitude,
             longitude,
             arrayJoin(arrayZip(
                     JSONExtractArrayString(times, '_'),
                     JSONExtractArrayFloat(temperatures, '_'),
                     JSONExtractArrayFloat(precipitations, '_'),
                     JSONExtractArrayFloat(windspeeds, '_')
                       )) AS data
         FROM raw_files
     )

SELECT
    COALESCE(city_name, 'Nijmegen') AS city_name,  -- Default to Nijmegen if city_name is null
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(parseDateTimeBestEffort(data.1)) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(parseDateTimeBestEffort(data.1)) AS hour_of_day
FROM exploded_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m19:32:30.990993 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Failed to get object info: Poco::Exception. Code: 1000, e.code() = 0, Malformed message: Invalid HTTP status code (version 25.4.2.31 (official build)). HTTP response code: 18446744073709551615: while reading nijmegen/20250507_192342.json: The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m19:32:30.993350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8574fcf0-34f3-4ecf-b397-70fd31f8bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbb9650>]}
[0m19:32:30.994304 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default`.`stg_weather_forecasts` ......... [[31mERROR[0m in 216.62s]
[0m19:32:30.994706 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m19:32:30.995136 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather_forecasts' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Failed to get object info: Poco::Exception. Code: 1000, e.code() = 0, Malformed message: Invalid HTTP status code (version 25.4.2.31 (official build)). HTTP response code: 18446744073709551615: while reading nijmegen/20250507_192342.json: The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql.
[0m19:32:30.997256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:30.997600 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m19:32:30.998002 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m19:32:30.998500 [info ] [MainThread]: 
[0m19:32:30.998754 [info ] [MainThread]: Finished running 1 view model in 0 hours 3 minutes and 37.32 seconds (217.32s).
[0m19:32:30.999470 [debug] [MainThread]: Command end result
[0m19:32:31.015478 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m19:32:31.017757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m19:32:31.021342 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m19:32:31.021524 [info ] [MainThread]: 
[0m19:32:31.021732 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:32:31.021878 [info ] [MainThread]: 
[0m19:32:31.022075 [error] [MainThread]:   Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 499
   Code: 499. DB::Exception: Failed to get object info: Poco::Exception. Code: 1000, e.code() = 0, Malformed message: Invalid HTTP status code (version 25.4.2.31 (official build)). HTTP response code: 18446744073709551615: while reading nijmegen/20250507_192342.json: The table structure cannot be extracted from a JSON format file. You can specify the structure manually. (S3_ERROR) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m19:32:31.022227 [info ] [MainThread]: 
[0m19:32:31.022388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:32:31.022929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 217.86304, "process_in_blocks": "0", "process_kernel_time": 0.33214, "process_mem_max_rss": "166150144", "process_out_blocks": "0", "process_user_time": 1.275533}
[0m19:32:31.023187 [debug] [MainThread]: Command `dbt run` failed at 19:32:31.023149 after 217.86 seconds
[0m19:32:31.023481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb8e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbfc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbff1d0>]}
[0m19:32:31.023665 [debug] [MainThread]: Flushing usage events
[0m19:32:31.493210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:11.735586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11459bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11461b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11461bf90>]}


============================== 08:30:11.738679 | 814e36f8-0048-40b3-9142-b6b945f6de8b ==============================
[0m08:30:11.738679 [info ] [MainThread]: Running with dbt=1.9.4
[0m08:30:11.739311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile -m stg_weather_forecasts', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:30:11.846179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '814e36f8-0048-40b3-9142-b6b945f6de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146f6c50>]}
[0m08:30:11.879214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '814e36f8-0048-40b3-9142-b6b945f6de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11364c450>]}
[0m08:30:11.880138 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m08:30:11.941093 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m08:30:11.999318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:11.999819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:12.013374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814e36f8-0048-40b3-9142-b6b945f6de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ab4810>]}
[0m08:30:12.043279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m08:30:12.045634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m08:30:12.056636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814e36f8-0048-40b3-9142-b6b945f6de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b69a10>]}
[0m08:30:12.056918 [info ] [MainThread]: Found 3 models, 476 macros
[0m08:30:12.057077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814e36f8-0048-40b3-9142-b6b945f6de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474a2d0>]}
[0m08:30:12.057766 [info ] [MainThread]: 
[0m08:30:12.057947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:30:12.058072 [info ] [MainThread]: 
[0m08:30:12.058319 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:30:12.061121 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default'
[0m08:30:12.067014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:12.760892 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m08:30:12.765671 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:30:12.778272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814e36f8-0048-40b3-9142-b6b945f6de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11499a050>]}
[0m08:30:12.779890 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m08:30:12.780152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m08:30:12.780336 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m08:30:12.784767 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m08:30:12.785680 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m08:30:12.786075 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m08:30:12.786637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:12.786785 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m08:30:12.786923 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m08:30:12.787234 [debug] [MainThread]: Command end result
[0m08:30:12.798219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m08:30:12.799155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m08:30:12.802311 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m08:30:12.802587 [info ] [MainThread]: Compiled node 'stg_weather_forecasts' is:
/*
    Staging model for weather forecasts from MinIO S3 storage.
    Parses a specific Nijmegen weather data file.
*/






WITH raw_files AS (
    SELECT
        fileName,
        JSONExtractString(content, 'city_name') AS city_name,
        JSONExtractFloat(content, 'latitude') AS latitude,
        JSONExtractFloat(content, 'longitude') AS longitude,
        JSONExtractArrayRaw(content, 'hourly.time') AS times,
        JSONExtractArrayRaw(content, 'hourly.temperature_2m') AS temperatures,
        JSONExtractArrayRaw(content, 'hourly.precipitation') AS precipitations,
        JSONExtractArrayRaw(content, 'hourly.windspeed_10m') AS windspeeds
    FROM s3(
            'http://localhost:9000/weather-data/nijmegen/20250507_192342.json',
            'YloX0VqDctbLisJf5iQv',
            'dUk2qwAbGRTaCxZxzw6GJrS11pxFR28ucO2xwHwg'
         )
),

exploded_data AS (
         SELECT
             city_name,
             latitude,
             longitude,
             arrayJoin(arrayZip(
                     JSONExtractArrayString(times, '_'),
                     JSONExtractArrayFloat(temperatures, '_'),
                     JSONExtractArrayFloat(precipitations, '_'),
                     JSONExtractArrayFloat(windspeeds, '_')
                       )) AS data
         FROM raw_files
     )

SELECT
    COALESCE(city_name, 'Nijmegen') AS city_name,  -- Default to Nijmegen if city_name is null
    latitude,
    longitude,
    parseDateTimeBestEffort(data.1) AS forecast_timestamp,
    data.2 AS temperature_2m,
    data.3 AS precipitation,
    data.4 AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(parseDateTimeBestEffort(data.1)) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(parseDateTimeBestEffort(data.1)) AS hour_of_day
FROM exploded_data
ORDER BY forecast_timestamp
[0m08:30:12.803222 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.1126434, "process_in_blocks": "0", "process_kernel_time": 0.321538, "process_mem_max_rss": "162234368", "process_out_blocks": "0", "process_user_time": 1.150501}
[0m08:30:12.803491 [debug] [MainThread]: Command `dbt compile` succeeded at 08:30:12.803444 after 1.11 seconds
[0m08:30:12.803701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114634190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146346d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eac490>]}
[0m08:30:12.803918 [debug] [MainThread]: Flushing usage events
[0m08:30:12.810586 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:58.982758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a9ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b1b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b1bc10>]}


============================== 10:55:58.985882 | 3901e68a-6db8-4352-ab97-b511970b0f26 ==============================
[0m10:55:58.985882 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:55:58.986248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:55:59.095582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11539f850>]}
[0m10:55:59.129186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d47750>]}
[0m10:55:59.130168 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m10:55:59.190943 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:55:59.244759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:55:59.245255 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/staging/schema.yml
[0m10:55:59.245440 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/staging/stg_weather_forecasts.sql
[0m10:55:59.245633 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/marts/daily_weather_summary.sql
[0m10:55:59.467206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1162ea090>]}
[0m10:55:59.499403 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:55:59.501728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:55:59.546958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1162cac10>]}
[0m10:55:59.547295 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m10:55:59.547482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fb2950>]}
[0m10:55:59.548257 [info ] [MainThread]: 
[0m10:55:59.548434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:59.548571 [info ] [MainThread]: 
[0m10:55:59.548800 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:55:59.549214 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:55:59.553644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:00.147329 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:56:00.150020 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:00.163332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m10:56:00.166491 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m10:56:00.184723 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:00.186007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116338c50>]}
[0m10:56:00.187646 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m10:56:00.187941 [info ] [Thread-1 (]: 1 of 1 START sql view model `default`.`stg_weather_forecasts` .................. [RUN]
[0m10:56:00.188188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.stg_weather_forecasts)
[0m10:56:00.188369 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m10:56:00.192715 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m10:56:00.193376 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m10:56:00.237685 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m10:56:00.243976 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m10:56:00.244730 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts data.
    Sources data from the default.weather_forecasts table in ClickHouse.
*/

WITH source_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        timestamp,
        temperature,
        precipitation,
        windspeed
    FROM `default`.`weather_forecasts`
)

SELECT
    city_name,
    latitude,
    longitude,
    timestamp AS forecast_timestamp,
    temperature AS temperature_2m,
    precipitation,
    windspeed AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(timestamp) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(timestamp) AS hour_of_day
FROM source_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m10:56:00.252431 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:00.262069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3901e68a-6db8-4352-ab97-b511970b0f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116097250>]}
[0m10:56:00.262471 [info ] [Thread-1 (]: 1 of 1 OK created sql view model `default`.`stg_weather_forecasts` ............. [[32mOK[0m in 0.07s]
[0m10:56:00.262742 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m10:56:00.263335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:00.263514 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m10:56:00.263663 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m10:56:00.263855 [info ] [MainThread]: 
[0m10:56:00.264014 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:56:00.264298 [debug] [MainThread]: Command end result
[0m10:56:00.277440 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:56:00.283637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:56:00.290618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m10:56:00.294343 [info ] [MainThread]: 
[0m10:56:00.294585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:56:00.294730 [info ] [MainThread]: 
[0m10:56:00.294879 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:56:00.295192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.356872, "process_in_blocks": "0", "process_kernel_time": 0.305543, "process_mem_max_rss": "169410560", "process_out_blocks": "0", "process_user_time": 1.423406}
[0m10:56:00.295385 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:00.295347 after 1.36 seconds
[0m10:56:00.295571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b1be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c49a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e00490>]}
[0m10:56:00.295756 [debug] [MainThread]: Flushing usage events
[0m10:56:00.689319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:39.380826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12029ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12029a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12031fb90>]}


============================== 10:56:39.383923 | 0c09545e-688b-444d-a7dd-25652511de86 ==============================
[0m10:56:39.383923 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:56:39.384274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m daily_weather_summary', 'send_anonymous_usage_stats': 'True'}
[0m10:56:39.495297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12033f2d0>]}
[0m10:56:39.529554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734c350>]}
[0m10:56:39.530538 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m10:56:39.588028 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:56:39.644910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:39.645169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:39.660970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210fc450>]}
[0m10:56:39.693894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:56:39.695933 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:56:39.707228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206e17d0>]}
[0m10:56:39.707520 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m10:56:39.707696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211b51d0>]}
[0m10:56:39.708397 [info ] [MainThread]: 
[0m10:56:39.708568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:56:39.708699 [info ] [MainThread]: 
[0m10:56:39.708948 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:56:39.709364 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:56:39.714467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:40.086910 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:56:40.089670 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:40.103720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m10:56:40.106854 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m10:56:40.112622 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:40.113757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f83150>]}
[0m10:56:40.115355 [debug] [Thread-1 (]: Began running node model.weather_warehouse.daily_weather_summary
[0m10:56:40.115619 [info ] [Thread-1 (]: 1 of 1 START sql table model `default`.`daily_weather_summary` ................. [RUN]
[0m10:56:40.115855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.daily_weather_summary)
[0m10:56:40.116019 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.daily_weather_summary
[0m10:56:40.119892 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.daily_weather_summary"
[0m10:56:40.120394 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.daily_weather_summary
[0m10:56:40.129341 [debug] [Thread-1 (]: Creating new relation daily_weather_summary
[0m10:56:40.144986 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.daily_weather_summary"} */

            

    
        create table `default`.`daily_weather_summary`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            /*
    Daily aggregated weather metrics by city
*/

WITH source_data AS (
    SELECT 
        city_name,
        forecast_date, -- Already calculated in staging model
        temperature_2m,
        precipitation,
        windspeed_10m
    FROM `default`.`stg_weather_forecasts`
)

SELECT
    city_name,
    forecast_date,
    round(avg(temperature_2m), 1) AS avg_temperature,
    max(temperature_2m) AS max_temperature,
    min(temperature_2m) AS min_temperature,
    round(sum(precipitation), 1) AS total_precipitation,
    round(avg(windspeed_10m), 1) AS avg_windspeed
FROM source_data
GROUP BY city_name, forecast_date
ORDER BY city_name, forecast_date
          )
        
        ...
[0m10:56:40.162476 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:40.170318 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.daily_weather_summary"} */

    select name, type from system.columns where table = 'daily_weather_summary'
    
      and database = 'default'
    
    order by position
  ...
[0m10:56:40.177450 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:40.179451 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.daily_weather_summary"
[0m10:56:40.180026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.daily_weather_summary"} */

  
    
    
    
        
         


        insert into `default`.`daily_weather_summary`
        ("city_name", "forecast_date", "avg_temperature", "max_temperature", "min_temperature", "total_precipitation", "avg_windspeed")/*
    Daily aggregated weather metrics by city
*/

WITH source_data AS (
    SELECT 
        city_name,
        forecast_date, -- Already calculated in staging model
        temperature_2m,
        precipitation,
        windspeed_10m
    FROM `default`.`stg_weather_forecasts`
)

SELECT
    city_name,
    forecast_date,
    round(avg(temperature_2m), 1) AS avg_temperature,
    max(temperature_2m) AS max_temperature,
    min(temperature_2m) AS min_temperature,
    round(sum(precipitation), 1) AS total_precipitation,
    round(avg(windspeed_10m), 1) AS avg_windspeed
FROM source_data
GROUP BY city_name, forecast_date
ORDER BY city_name, forecast_date
  ...
[0m10:56:40.210813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m10:56:40.220853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c09545e-688b-444d-a7dd-25652511de86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebbb50>]}
[0m10:56:40.221302 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `default`.`daily_weather_summary` ............ [[32mOK[0m in 0.10s]
[0m10:56:40.221586 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.daily_weather_summary
[0m10:56:40.222290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:40.222484 [debug] [MainThread]: Connection 'model.weather_warehouse.daily_weather_summary' was left open.
[0m10:56:40.222641 [debug] [MainThread]: On model.weather_warehouse.daily_weather_summary: Close
[0m10:56:40.222819 [info ] [MainThread]: 
[0m10:56:40.222967 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m10:56:40.223249 [debug] [MainThread]: Command end result
[0m10:56:40.236184 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:56:40.237184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:56:40.240192 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m10:56:40.240432 [info ] [MainThread]: 
[0m10:56:40.240646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:56:40.240800 [info ] [MainThread]: 
[0m10:56:40.240947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:56:40.241256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.90507257, "process_in_blocks": "0", "process_kernel_time": 0.280659, "process_mem_max_rss": "163971072", "process_out_blocks": "0", "process_user_time": 1.17631}
[0m10:56:40.241458 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:40.241420 after 0.91 seconds
[0m10:56:40.241665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120337e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203357d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f9ee10>]}
[0m10:56:40.241856 [debug] [MainThread]: Flushing usage events
[0m10:56:40.633191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:51.022114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afd350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1f950>]}


============================== 10:56:51.024923 | bdb3bd7b-fc4f-4eb5-ae29-d4a8c7f0f505 ==============================
[0m10:56:51.024923 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:56:51.025278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m city_weather_summary', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:51.123036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb3bd7b-fc4f-4eb5-ae29-d4a8c7f0f505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107993310>]}
[0m10:56:51.157225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb3bd7b-fc4f-4eb5-ae29-d4a8c7f0f505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694c310>]}
[0m10:56:51.158100 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m10:56:51.215606 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:56:51.273888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:51.274183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:51.291196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb3bd7b-fc4f-4eb5-ae29-d4a8c7f0f505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f72610>]}
[0m10:56:51.325704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:56:51.327690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:56:51.337927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb3bd7b-fc4f-4eb5-ae29-d4a8c7f0f505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107edb650>]}
[0m10:56:51.338231 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m10:56:51.338405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb3bd7b-fc4f-4eb5-ae29-d4a8c7f0f505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c81890>]}
[0m10:56:51.338704 [warn ] [MainThread]: The selection criterion 'city_weather_summary' does not match any enabled nodes
[0m10:56:51.339268 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:56:51.340131 [debug] [MainThread]: Command end result
[0m10:56:51.351276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:56:51.352345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:56:51.354130 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m10:56:51.354528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3737075, "process_in_blocks": "0", "process_kernel_time": 0.190849, "process_mem_max_rss": "118587392", "process_out_blocks": "0", "process_user_time": 0.947161}
[0m10:56:51.354744 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:51.354703 after 0.37 seconds
[0m10:56:51.354957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10020cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1001f8490>]}
[0m10:56:51.355166 [debug] [MainThread]: Flushing usage events
[0m10:56:51.738777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:07.333043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fe050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb0610>]}


============================== 10:57:07.335723 | e6069f79-e470-4fac-ba26-d9f23120c8e0 ==============================
[0m10:57:07.335723 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:57:07.336035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m city_weather_stats', 'send_anonymous_usage_stats': 'True'}
[0m10:57:07.427633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106237b90>]}
[0m10:57:07.459600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524c2d0>]}
[0m10:57:07.460593 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m10:57:07.517165 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:57:07.572030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:07.572289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:07.588714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fa090>]}
[0m10:57:07.621216 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:57:07.624226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:57:07.634275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639e210>]}
[0m10:57:07.634575 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m10:57:07.634749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667ff90>]}
[0m10:57:07.635445 [info ] [MainThread]: 
[0m10:57:07.635628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:07.635758 [info ] [MainThread]: 
[0m10:57:07.636020 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:57:07.636445 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:57:07.641601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:07.974016 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:57:07.976774 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:07.990446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default)
[0m10:57:07.994033 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default'
      

  ...
[0m10:57:07.999143 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:08.000420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dd990>]}
[0m10:57:08.002014 [debug] [Thread-1 (]: Began running node model.weather_warehouse.city_weather_stats
[0m10:57:08.002341 [info ] [Thread-1 (]: 1 of 1 START sql table model `default`.`city_weather_stats` .................... [RUN]
[0m10:57:08.002589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default, now model.weather_warehouse.city_weather_stats)
[0m10:57:08.002759 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.city_weather_stats
[0m10:57:08.006824 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.city_weather_stats"
[0m10:57:08.007340 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.city_weather_stats
[0m10:57:08.016617 [debug] [Thread-1 (]: Creating new relation city_weather_stats
[0m10:57:08.031356 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.city_weather_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.city_weather_stats"} */

            

    
        create table `default`.`city_weather_stats`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            /*
    City-level weather statistics over the entire forecast period
*/

SELECT
    city_name,
    round(avg(avg_temperature), 1) AS avg_period_temperature,
    max(max_temperature) AS max_period_temperature,
    min(min_temperature) AS min_period_temperature,
    round(sum(total_precipitation), 1) AS total_period_precipitation,
    round(avg(avg_windspeed), 1) AS avg_period_windspeed,
    count() AS days_in_forecast
FROM `default`.`daily_weather_summary`
GROUP BY city_name
ORDER BY city_name
          )
        
        ...
[0m10:57:08.043780 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:08.051430 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.city_weather_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.city_weather_stats"} */

    select name, type from system.columns where table = 'city_weather_stats'
    
      and database = 'default'
    
    order by position
  ...
[0m10:57:08.055287 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:08.057185 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.city_weather_stats"
[0m10:57:08.057735 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.city_weather_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.city_weather_stats"} */

  
    
    
    
        
         


        insert into `default`.`city_weather_stats`
        ("city_name", "avg_period_temperature", "max_period_temperature", "min_period_temperature", "total_period_precipitation", "avg_period_windspeed", "days_in_forecast")/*
    City-level weather statistics over the entire forecast period
*/

SELECT
    city_name,
    round(avg(avg_temperature), 1) AS avg_period_temperature,
    max(max_temperature) AS max_period_temperature,
    min(min_temperature) AS min_period_temperature,
    round(sum(total_precipitation), 1) AS total_period_precipitation,
    round(avg(avg_windspeed), 1) AS avg_period_windspeed,
    count() AS days_in_forecast
FROM `default`.`daily_weather_summary`
GROUP BY city_name
ORDER BY city_name
  ...
[0m10:57:08.070775 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:08.080416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6069f79-e470-4fac-ba26-d9f23120c8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d89d90>]}
[0m10:57:08.080821 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `default`.`city_weather_stats` ............... [[32mOK[0m in 0.08s]
[0m10:57:08.081102 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.city_weather_stats
[0m10:57:08.081790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:08.081947 [debug] [MainThread]: Connection 'model.weather_warehouse.city_weather_stats' was left open.
[0m10:57:08.082085 [debug] [MainThread]: On model.weather_warehouse.city_weather_stats: Close
[0m10:57:08.082274 [info ] [MainThread]: 
[0m10:57:08.082424 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m10:57:08.082695 [debug] [MainThread]: Command end result
[0m10:57:08.094679 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:57:08.095586 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:57:08.098375 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m10:57:08.098582 [info ] [MainThread]: 
[0m10:57:08.098776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:08.098914 [info ] [MainThread]: 
[0m10:57:08.099055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:57:08.099356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8076407, "process_in_blocks": "0", "process_kernel_time": 0.24119, "process_mem_max_rss": "164823040", "process_out_blocks": "0", "process_user_time": 1.154709}
[0m10:57:08.099536 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:08.099502 after 0.81 seconds
[0m10:57:08.099722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d5650>]}
[0m10:57:08.099896 [debug] [MainThread]: Flushing usage events
[0m10:57:08.477096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:59:44.243996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfe390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17950>]}


============================== 10:59:44.246625 | d22923d2-1d42-4273-b64e-e70d7db3cd4a ==============================
[0m10:59:44.246625 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:59:44.246950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:59:44.351630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd22923d2-1d42-4273-b64e-e70d7db3cd4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c99410>]}
[0m10:59:44.382951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd22923d2-1d42-4273-b64e-e70d7db3cd4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f4f750>]}
[0m10:59:44.383793 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m10:59:44.442728 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:59:44.480531 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:59:44.480863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd22923d2-1d42-4273-b64e-e70d7db3cd4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104097f10>]}
[0m10:59:45.078919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd22923d2-1d42-4273-b64e-e70d7db3cd4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f9150>]}
[0m10:59:45.109962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m10:59:45.112116 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m10:59:45.123120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd22923d2-1d42-4273-b64e-e70d7db3cd4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105551f10>]}
[0m10:59:45.123388 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m10:59:45.123553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd22923d2-1d42-4273-b64e-e70d7db3cd4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542e550>]}
[0m10:59:45.124212 [info ] [MainThread]: 
[0m10:59:45.124377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:45.124506 [info ] [MainThread]: 
[0m10:59:45.124722 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:59:45.125131 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:59:45.129294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:45.501834 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:59:45.504689 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:59:45.515848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__default_staging)
[0m10:59:45.516173 [debug] [ThreadPool]: Creating schema "schema: "default_staging"
"
[0m10:59:45.519776 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__default_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "create__default_staging"} */
create database if not exists `default_staging`
        
  
        
  ...
[0m10:59:45.533878 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "create__default_staging"} */
create database if not exists `default_staging`
        
  
        
  
[0m10:59:45.534219 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m10:59:45.534626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:45.534815 [debug] [MainThread]: Connection 'create__default_staging' was left open.
[0m10:59:45.534970 [debug] [MainThread]: On create__default_staging: Close
[0m10:59:45.535117 [info ] [MainThread]: 
[0m10:59:45.535287 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m10:59:45.535723 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON default_staging.*. (ACCESS_DENIED) (version 25.4.2.31 (official build))
[0m10:59:45.536098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3344675, "process_in_blocks": "0", "process_kernel_time": 0.261383, "process_mem_max_rss": "166100992", "process_out_blocks": "0", "process_user_time": 1.620739}
[0m10:59:45.536309 [debug] [MainThread]: Command `dbt run` failed at 10:59:45.536265 after 1.33 seconds
[0m10:59:45.536495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd6810>]}
[0m10:59:45.536689 [debug] [MainThread]: Flushing usage events
[0m10:59:45.919336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:21.196138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b08f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fe1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b10be10>]}


============================== 13:46:21.198876 | 624e1ed1-6229-4591-928d-e10fc1c622cc ==============================
[0m13:46:21.198876 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:46:21.199265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:21.307605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1dc550>]}
[0m13:46:21.341948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994c350>]}
[0m13:46:21.342955 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m13:46:21.402699 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:46:21.460523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:21.460780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:21.476640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d3550>]}
[0m13:46:21.509386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:46:21.512707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:46:21.524549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fc890>]}
[0m13:46:21.524882 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m13:46:21.525068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b5690>]}
[0m13:46:21.525823 [info ] [MainThread]: 
[0m13:46:21.526166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:21.526338 [info ] [MainThread]: 
[0m13:46:21.526613 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:46:21.527041 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:46:21.532870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:21.908241 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:46:21.910772 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:46:21.922151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__default_staging)
[0m13:46:21.922496 [debug] [ThreadPool]: Creating schema "schema: "default_staging"
"
[0m13:46:21.926352 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__default_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "create__default_staging"} */
create database if not exists `default_staging`
        
  
        
  ...
[0m13:46:21.931655 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:46:21.935200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__default_staging, now list__default_marts)
[0m13:46:21.938274 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_marts'
      

  ...
[0m13:46:21.959059 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:46:21.959942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_marts, now list__default_staging)
[0m13:46:21.961373 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_staging'
      

  ...
[0m13:46:21.973122 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:46:21.974204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5427d0>]}
[0m13:46:21.976321 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m13:46:21.976717 [info ] [Thread-1 (]: 1 of 1 START sql view model `default_staging`.`stg_weather_forecasts` .......... [RUN]
[0m13:46:21.976994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default_staging, now model.weather_warehouse.stg_weather_forecasts)
[0m13:46:21.977183 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m13:46:21.981300 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m13:46:21.982132 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m13:46:21.989499 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m13:46:21.995576 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m13:46:21.996198 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default_staging`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts data.
    Sources data from the default.weather_forecasts table in ClickHouse.
*/

WITH source_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        timestamp,
        temperature,
        precipitation,
        windspeed
    FROM `default`.`weather_forecasts`
)

SELECT
    city_name,
    latitude,
    longitude,
    timestamp AS forecast_timestamp,
    temperature AS temperature_2m,
    precipitation,
    windspeed AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(timestamp) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(timestamp) AS hour_of_day
FROM source_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m13:46:22.001334 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default_staging`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts data.
    Sources data from the default.weather_forecasts table in ClickHouse.
*/

WITH source_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        timestamp,
        temperature,
        precipitation,
        windspeed
    FROM `default`.`weather_forecasts`
)

SELECT
    city_name,
    latitude,
    longitude,
    timestamp AS forecast_timestamp,
    temperature AS temperature_2m,
    precipitation,
    windspeed AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(timestamp) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(timestamp) AS hour_of_day
FROM source_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m13:46:22.006194 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW, DROP VIEW ON default_staging.stg_weather_forecasts. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m13:46:22.007028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624e1ed1-6229-4591-928d-e10fc1c622cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea72f90>]}
[0m13:46:22.007389 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default_staging`.`stg_weather_forecasts` . [[31mERROR[0m in 0.03s]
[0m13:46:22.007675 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m13:46:22.008080 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather_forecasts' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW, DROP VIEW ON default_staging.stg_weather_forecasts. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql.
[0m13:46:22.008996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:22.009144 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m13:46:22.009278 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m13:46:22.009461 [info ] [MainThread]: 
[0m13:46:22.009615 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m13:46:22.009911 [debug] [MainThread]: Command end result
[0m13:46:22.021774 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:46:22.022643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:46:22.025354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m13:46:22.025537 [info ] [MainThread]: 
[0m13:46:22.025779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:46:22.025988 [info ] [MainThread]: 
[0m13:46:22.026167 [error] [MainThread]:   Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW, DROP VIEW ON default_staging.stg_weather_forecasts. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m13:46:22.026306 [info ] [MainThread]: 
[0m13:46:22.026438 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:46:22.026726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.87223023, "process_in_blocks": "0", "process_kernel_time": 0.277518, "process_mem_max_rss": "163774464", "process_out_blocks": "0", "process_user_time": 1.16123}
[0m13:46:22.026909 [debug] [MainThread]: Command `dbt run` failed at 13:46:22.026874 after 0.87 seconds
[0m13:46:22.027207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a7d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a7cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a7d510>]}
[0m13:46:22.027426 [debug] [MainThread]: Flushing usage events
[0m13:46:22.438390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:08.798924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a7dd0>]}


============================== 13:49:08.801760 | 209ad906-a902-4fe4-8e41-f54f50ef545a ==============================
[0m13:49:08.801760 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:08.802090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'send_anonymous_usage_stats': 'True'}
[0m13:49:08.909819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103173ed0>]}
[0m13:49:08.944129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e0390>]}
[0m13:49:08.945265 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m13:49:09.012614 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:49:09.073529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:09.073809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:09.090473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059aa290>]}
[0m13:49:09.125080 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:49:09.127196 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:49:09.138137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558d2d0>]}
[0m13:49:09.138408 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m13:49:09.138576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10319b0d0>]}
[0m13:49:09.139279 [info ] [MainThread]: 
[0m13:49:09.139449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:09.139579 [info ] [MainThread]: 
[0m13:49:09.139822 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:49:09.140248 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:49:09.145328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:09.506543 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:49:09.509679 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:49:09.524145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default_marts)
[0m13:49:09.527561 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_marts'
      

  ...
[0m13:49:09.557879 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:49:09.558871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_marts, now list__default_staging)
[0m13:49:09.560246 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_staging'
      

  ...
[0m13:49:09.564489 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:49:09.565371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34210>]}
[0m13:49:09.567184 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m13:49:09.567537 [info ] [Thread-1 (]: 1 of 1 START sql view model `default_staging`.`stg_weather_forecasts` .......... [RUN]
[0m13:49:09.567805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default_staging, now model.weather_warehouse.stg_weather_forecasts)
[0m13:49:09.568005 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m13:49:09.572538 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m13:49:09.573217 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m13:49:09.579922 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m13:49:09.586283 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m13:49:09.586771 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default_staging`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts data.
    Sources data from the default.weather_forecasts table in ClickHouse.
*/

WITH source_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        timestamp,
        temperature,
        precipitation,
        windspeed
    FROM `default`.`weather_forecasts`
)

SELECT
    city_name,
    latitude,
    longitude,
    timestamp AS forecast_timestamp,
    temperature AS temperature_2m,
    precipitation,
    windspeed AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(timestamp) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(timestamp) AS hour_of_day
FROM source_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m13:49:09.591935 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default_staging`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts data.
    Sources data from the default.weather_forecasts table in ClickHouse.
*/

WITH source_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        timestamp,
        temperature,
        precipitation,
        windspeed
    FROM `default`.`weather_forecasts`
)

SELECT
    city_name,
    latitude,
    longitude,
    timestamp AS forecast_timestamp,
    temperature AS temperature_2m,
    precipitation,
    windspeed AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(timestamp) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(timestamp) AS hour_of_day
FROM source_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m13:49:09.596737 [debug] [Thread-1 (]: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW, DROP VIEW ON default_staging.stg_weather_forecasts. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m13:49:09.597582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '209ad906-a902-4fe4-8e41-f54f50ef545a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d12050>]}
[0m13:49:09.597964 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model `default_staging`.`stg_weather_forecasts` . [[31mERROR[0m in 0.03s]
[0m13:49:09.598250 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m13:49:09.598529 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather_forecasts' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW, DROP VIEW ON default_staging.stg_weather_forecasts. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql.
[0m13:49:09.599463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:09.599623 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m13:49:09.599763 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m13:49:09.599948 [info ] [MainThread]: 
[0m13:49:09.600091 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m13:49:09.600376 [debug] [MainThread]: Command end result
[0m13:49:09.612138 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:49:09.613104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:49:09.615931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m13:49:09.616127 [info ] [MainThread]: 
[0m13:49:09.616323 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:49:09.616471 [info ] [MainThread]: 
[0m13:49:09.616669 [error] [MainThread]:   Database Error in model stg_weather_forecasts (models/staging/stg_weather_forecasts.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW, DROP VIEW ON default_staging.stg_weather_forecasts. (ACCESS_DENIED) (version 25.4.2.31 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather_forecasts.sql
[0m13:49:09.616836 [info ] [MainThread]: 
[0m13:49:09.616998 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:49:09.617310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8630201, "process_in_blocks": "0", "process_kernel_time": 0.259779, "process_mem_max_rss": "164118528", "process_out_blocks": "0", "process_user_time": 1.127016}
[0m13:49:09.617524 [debug] [MainThread]: Command `dbt run` failed at 13:49:09.617485 after 0.86 seconds
[0m13:49:09.617882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bf0c10>]}
[0m13:49:09.618135 [debug] [MainThread]: Flushing usage events
[0m13:49:10.071202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:32.483649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c8eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130bcd0>]}


============================== 13:49:32.486466 | aa2c08c2-66de-408e-9add-90174077d8ea ==============================
[0m13:49:32.486466 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:32.486795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_weather_forecasts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:32.584273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca3d90>]}
[0m13:49:32.637838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4c450>]}
[0m13:49:32.639498 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m13:49:32.699001 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:49:32.755851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:32.756142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:32.772508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4c450>]}
[0m13:49:32.804686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:49:32.806564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:49:32.816254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147ccd0>]}
[0m13:49:32.816564 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m13:49:32.816739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11167fd10>]}
[0m13:49:32.817454 [info ] [MainThread]: 
[0m13:49:32.817630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:32.817764 [info ] [MainThread]: 
[0m13:49:32.818019 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:49:32.818433 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:49:32.823602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:33.151159 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:49:33.154280 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:49:33.167612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__default_staging)
[0m13:49:33.171134 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_staging'
      

  ...
[0m13:49:33.176168 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:49:33.176993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_staging, now list__default_marts)
[0m13:49:33.178246 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_marts'
      

  ...
[0m13:49:33.192584 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:49:33.193560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111346550>]}
[0m13:49:33.195134 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather_forecasts
[0m13:49:33.195470 [info ] [Thread-1 (]: 1 of 1 START sql view model `default_staging`.`stg_weather_forecasts` .......... [RUN]
[0m13:49:33.195719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default_marts, now model.weather_warehouse.stg_weather_forecasts)
[0m13:49:33.195890 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather_forecasts
[0m13:49:33.199688 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather_forecasts"
[0m13:49:33.200098 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather_forecasts
[0m13:49:33.206574 [debug] [Thread-1 (]: Creating new relation stg_weather_forecasts
[0m13:49:33.213441 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather_forecasts"
[0m13:49:33.214037 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather_forecasts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.stg_weather_forecasts"} */


  create or replace view `default_staging`.`stg_weather_forecasts` 
  
    
  
  
    
    
  as (
    /*
    Staging model for weather forecasts data.
    Sources data from the default.weather_forecasts table in ClickHouse.
*/

WITH source_data AS (
    SELECT
        city_name,
        latitude,
        longitude,
        timestamp,
        temperature,
        precipitation,
        windspeed
    FROM `default`.`weather_forecasts`
)

SELECT
    city_name,
    latitude,
    longitude,
    timestamp AS forecast_timestamp,
    temperature AS temperature_2m,
    precipitation,
    windspeed AS windspeed_10m,
    -- Generate forecast date (just the date part)
    toDate(timestamp) AS forecast_date,
    -- Extract hour of day for time-based analysis
    toHour(timestamp) AS hour_of_day
FROM source_data
ORDER BY forecast_timestamp
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m13:49:33.220175 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:49:33.230400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2c08c2-66de-408e-9add-90174077d8ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d0d350>]}
[0m13:49:33.230967 [info ] [Thread-1 (]: 1 of 1 OK created sql view model `default_staging`.`stg_weather_forecasts` ..... [[32mOK[0m in 0.03s]
[0m13:49:33.231260 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather_forecasts
[0m13:49:33.231935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:33.232125 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather_forecasts' was left open.
[0m13:49:33.232274 [debug] [MainThread]: On model.weather_warehouse.stg_weather_forecasts: Close
[0m13:49:33.232471 [info ] [MainThread]: 
[0m13:49:33.232644 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m13:49:33.232928 [debug] [MainThread]: Command end result
[0m13:49:33.244901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:49:33.245816 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:49:33.248424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m13:49:33.248599 [info ] [MainThread]: 
[0m13:49:33.248803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:33.248951 [info ] [MainThread]: 
[0m13:49:33.249107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:49:33.249438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8097356, "process_in_blocks": "0", "process_kernel_time": 0.246449, "process_mem_max_rss": "163921920", "process_out_blocks": "0", "process_user_time": 1.180859}
[0m13:49:33.249634 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:33.249597 after 0.81 seconds
[0m13:49:33.249822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103040c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10302c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030d0bd0>]}
[0m13:49:33.249993 [debug] [MainThread]: Flushing usage events
[0m13:49:33.644078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:51.653282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a16f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a17810>]}


============================== 13:49:51.656693 | d3d47d58-3b66-47e8-a9bf-cb43d0e1f532 ==============================
[0m13:49:51.656693 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:51.657146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m daily_weather_summary', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:51.768392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3d47d58-3b66-47e8-a9bf-cb43d0e1f532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8d2d0>]}
[0m13:49:51.803613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3d47d58-3b66-47e8-a9bf-cb43d0e1f532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab6cd0>]}
[0m13:49:51.804571 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m13:49:51.869696 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:49:51.931323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:51.931643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:51.948830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3d47d58-3b66-47e8-a9bf-cb43d0e1f532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed3e90>]}
[0m13:49:51.985414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:49:51.987642 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:49:52.003673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3d47d58-3b66-47e8-a9bf-cb43d0e1f532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc8190>]}
[0m13:49:52.004002 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m13:49:52.004176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d47d58-3b66-47e8-a9bf-cb43d0e1f532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7fc50>]}
[0m13:49:52.004914 [info ] [MainThread]: 
[0m13:49:52.005093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:52.005227 [info ] [MainThread]: 
[0m13:49:52.005624 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:49:52.006276 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:49:52.011911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:52.349704 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:49:52.352685 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:49:52.363683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__default_marts)
[0m13:49:52.364076 [debug] [ThreadPool]: Creating schema "schema: "default_marts"
"
[0m13:49:52.367738 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__default_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "create__default_marts"} */
create database if not exists `default_marts`
        
  
        
  ...
[0m13:49:52.370971 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "create__default_marts"} */
create database if not exists `default_marts`
        
  
        
  
[0m13:49:52.371227 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m13:49:52.371589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:52.371737 [debug] [MainThread]: Connection 'create__default_marts' was left open.
[0m13:49:52.371874 [debug] [MainThread]: On create__default_marts: Close
[0m13:49:52.372019 [info ] [MainThread]: 
[0m13:49:52.372185 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:49:52.372418 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: dagster_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON default_marts.*. (ACCESS_DENIED) (version 25.4.2.31 (official build))
[0m13:49:52.372773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7644877, "process_in_blocks": "0", "process_kernel_time": 0.267795, "process_mem_max_rss": "163643392", "process_out_blocks": "0", "process_user_time": 1.134552}
[0m13:49:52.372971 [debug] [MainThread]: Command `dbt run` failed at 13:49:52.372931 after 0.76 seconds
[0m13:49:52.373151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a17350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efc810>]}
[0m13:49:52.373349 [debug] [MainThread]: Flushing usage events
[0m13:49:52.756681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:12.632556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11408f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114116f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114117810>]}


============================== 13:50:12.635478 | 7a96c7fa-be0d-4649-8ddc-5bc4fe377141 ==============================
[0m13:50:12.635478 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:12.635817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m daily_weather_summary', 'send_anonymous_usage_stats': 'True'}
[0m13:50:12.731140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f5d90>]}
[0m13:50:12.763479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113044410>]}
[0m13:50:12.764338 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m13:50:12.826152 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:12.880790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:12.881047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:12.896737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113db4510>]}
[0m13:50:12.927935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:50:12.929869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:50:12.938729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114285f50>]}
[0m13:50:12.938993 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m13:50:12.939159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147b5050>]}
[0m13:50:12.939853 [info ] [MainThread]: 
[0m13:50:12.940019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:12.940147 [info ] [MainThread]: 
[0m13:50:12.940386 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:50:12.940817 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:50:12.945679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:13.261628 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:50:13.264250 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:50:13.274946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__default_marts)
[0m13:50:13.275293 [debug] [ThreadPool]: Creating schema "schema: "default_marts"
"
[0m13:50:13.279165 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__default_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "create__default_marts"} */
create database if not exists `default_marts`
        
  
        
  ...
[0m13:50:13.283094 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:50:13.286732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__default_marts, now list__default_staging)
[0m13:50:13.289917 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_staging'
      

  ...
[0m13:50:13.295401 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:50:13.296238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_staging, now list__default_marts)
[0m13:50:13.297600 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__default_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "connection_name": "list__default_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'default_marts'
      

  ...
[0m13:50:13.326626 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:50:13.327640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ed5c50>]}
[0m13:50:13.329601 [debug] [Thread-1 (]: Began running node model.weather_warehouse.daily_weather_summary
[0m13:50:13.329978 [info ] [Thread-1 (]: 1 of 1 START sql table model `default_marts`.`daily_weather_summary` ........... [RUN]
[0m13:50:13.330244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__default_marts, now model.weather_warehouse.daily_weather_summary)
[0m13:50:13.330427 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.daily_weather_summary
[0m13:50:13.334079 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.daily_weather_summary"
[0m13:50:13.334785 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.daily_weather_summary
[0m13:50:13.344533 [debug] [Thread-1 (]: Creating new relation daily_weather_summary
[0m13:50:13.358549 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.daily_weather_summary"} */

            

    
        create table `default_marts`.`daily_weather_summary`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            /*
    Daily aggregated weather metrics by city
*/

WITH source_data AS (
    SELECT 
        city_name,
        forecast_date, -- Already calculated in staging model
        temperature_2m,
        precipitation,
        windspeed_10m
    FROM `default_staging`.`stg_weather_forecasts`
)

SELECT
    city_name,
    forecast_date,
    round(avg(temperature_2m), 1) AS avg_temperature,
    max(temperature_2m) AS max_temperature,
    min(temperature_2m) AS min_temperature,
    round(sum(precipitation), 1) AS total_precipitation,
    round(avg(windspeed_10m), 1) AS avg_windspeed
FROM source_data
GROUP BY city_name, forecast_date
ORDER BY city_name, forecast_date
          )
        
        ...
[0m13:50:13.366524 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:50:13.375226 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.daily_weather_summary"} */

    select name, type from system.columns where table = 'daily_weather_summary'
    
      and database = 'default_marts'
    
    order by position
  ...
[0m13:50:13.379284 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:50:13.381169 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.daily_weather_summary"
[0m13:50:13.381667 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "dev", "node_id": "model.weather_warehouse.daily_weather_summary"} */

  
    
    
    
        
         


        insert into `default_marts`.`daily_weather_summary`
        ("city_name", "forecast_date", "avg_temperature", "max_temperature", "min_temperature", "total_precipitation", "avg_windspeed")/*
    Daily aggregated weather metrics by city
*/

WITH source_data AS (
    SELECT 
        city_name,
        forecast_date, -- Already calculated in staging model
        temperature_2m,
        precipitation,
        windspeed_10m
    FROM `default_staging`.`stg_weather_forecasts`
)

SELECT
    city_name,
    forecast_date,
    round(avg(temperature_2m), 1) AS avg_temperature,
    max(temperature_2m) AS max_temperature,
    min(temperature_2m) AS min_temperature,
    round(sum(precipitation), 1) AS total_precipitation,
    round(avg(windspeed_10m), 1) AS avg_windspeed
FROM source_data
GROUP BY city_name, forecast_date
ORDER BY city_name, forecast_date
  ...
[0m13:50:13.391638 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:50:13.401026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a96c7fa-be0d-4649-8ddc-5bc4fe377141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142d9490>]}
[0m13:50:13.401410 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `default_marts`.`daily_weather_summary` ...... [[32mOK[0m in 0.07s]
[0m13:50:13.401746 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.daily_weather_summary
[0m13:50:13.402344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:13.402494 [debug] [MainThread]: Connection 'model.weather_warehouse.daily_weather_summary' was left open.
[0m13:50:13.402626 [debug] [MainThread]: On model.weather_warehouse.daily_weather_summary: Close
[0m13:50:13.402795 [info ] [MainThread]: 
[0m13:50:13.402958 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m13:50:13.403238 [debug] [MainThread]: Command end result
[0m13:50:13.413928 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:50:13.414774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:50:13.417304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m13:50:13.417463 [info ] [MainThread]: 
[0m13:50:13.417654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:13.417794 [info ] [MainThread]: 
[0m13:50:13.417938 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:50:13.418229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8246085, "process_in_blocks": "0", "process_kernel_time": 0.250736, "process_mem_max_rss": "164347904", "process_out_blocks": "0", "process_user_time": 1.17396}
[0m13:50:13.418419 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:13.418382 after 0.82 seconds
[0m13:50:13.418599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142b8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f50490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11514f850>]}
[0m13:50:13.418776 [debug] [MainThread]: Flushing usage events
[0m13:50:13.831590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:20.103763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107817290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107817b10>]}


============================== 13:50:20.106574 | bb7d8f00-8928-4274-9e1e-8b59efb5a3be ==============================
[0m13:50:20.106574 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:20.106910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m city_weather_summary', 'send_anonymous_usage_stats': 'True'}
[0m13:50:20.204557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb7d8f00-8928-4274-9e1e-8b59efb5a3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107887d90>]}
[0m13:50:20.239205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb7d8f00-8928-4274-9e1e-8b59efb5a3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674c4d0>]}
[0m13:50:20.240198 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m13:50:20.303155 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:20.362808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:20.363119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:20.380048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb7d8f00-8928-4274-9e1e-8b59efb5a3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc510>]}
[0m13:50:20.414751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:50:20.416573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:50:20.426980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb7d8f00-8928-4274-9e1e-8b59efb5a3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be1f10>]}
[0m13:50:20.427342 [info ] [MainThread]: Found 3 models, 1 source, 476 macros
[0m13:50:20.427534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb7d8f00-8928-4274-9e1e-8b59efb5a3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bf890>]}
[0m13:50:20.427846 [warn ] [MainThread]: The selection criterion 'city_weather_summary' does not match any enabled nodes
[0m13:50:20.428410 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:50:20.429277 [debug] [MainThread]: Command end result
[0m13:50:20.442645 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/manifest.json
[0m13:50:20.443647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/semantic_manifest.json
[0m13:50:20.445193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/open-source-warehousing/dagster/src/data_pipeline/transformation/dbt/target/run_results.json
[0m13:50:20.445555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3832879, "process_in_blocks": "0", "process_kernel_time": 0.196215, "process_mem_max_rss": "118931456", "process_out_blocks": "0", "process_user_time": 0.96148}
[0m13:50:20.445770 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:20.445731 after 0.38 seconds
[0m13:50:20.445984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008c8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10096d750>]}
[0m13:50:20.446171 [debug] [MainThread]: Flushing usage events
[0m13:50:20.834944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:13.756155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be3a90>]}


============================== 15:41:13.773736 | 4b1e5bc1-4ad8-48d0-92d0-ef97fde14e2f ==============================
[0m15:41:13.773736 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:41:13.774050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:13.871276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b1e5bc1-4ad8-48d0-92d0-ef97fde14e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d93550>]}
[0m15:41:13.894305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b1e5bc1-4ad8-48d0-92d0-ef97fde14e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d571d0>]}
[0m15:41:13.895183 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m15:41:13.949814 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:41:13.990382 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:41:13.990770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b1e5bc1-4ad8-48d0-92d0-ef97fde14e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dfad0>]}
[0m15:41:14.576058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b1e5bc1-4ad8-48d0-92d0-ef97fde14e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e28850>]}
[0m15:41:14.608236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m15:41:14.610821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m15:41:14.715792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b1e5bc1-4ad8-48d0-92d0-ef97fde14e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cbf50>]}
[0m15:41:14.716130 [info ] [MainThread]: Found 8 models, 1 source, 476 macros
[0m15:41:14.717221 [info ] [MainThread]: 
[0m15:41:14.717404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:14.717541 [info ] [MainThread]: 
[0m15:41:14.717802 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:41:14.720798 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:41:14.725428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:32.512416 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='clickhouse-chi-simple.clickhouse-dev.svc.cluster.local', port=8123): Max retries exceeded with url: /? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x128ce3950>: Failed to resolve 'clickhouse-chi-simple.clickhouse-dev.svc.cluster.local' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://clickhouse-chi-simple.clickhouse-dev.svc.cluster.local:8123)
[0m15:41:43.534647 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m15:41:43.537365 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m15:41:53.554024 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='clickhouse-chi-simple.clickhouse-dev.svc.cluster.local', port=8123): Max retries exceeded with url: /? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x128d45010>: Failed to resolve 'clickhouse-chi-simple.clickhouse-dev.svc.cluster.local' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://clickhouse-chi-simple.clickhouse-dev.svc.cluster.local:8123)
[0m15:42:04.563452 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m15:42:04.564516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:04.564834 [debug] [MainThread]: Connection 'list_' was left open.
[0m15:42:04.565078 [debug] [MainThread]: On list_: No close available on handle
[0m15:42:04.565351 [info ] [MainThread]: 
[0m15:42:04.565639 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 49.85 seconds (49.85s).
[0m15:42:04.566055 [error] [MainThread]: Encountered an error:

[0m15:42:04.571184 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 204, in build
    results = task.run()
              ^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 528, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/task/run.py", line 1045, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/Users/casperdamen/Code/weather-etl/.venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 696, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/Users/casperdamen/.local/share/uv/python/cpython-3.11.8-macos-aarch64-none/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/Users/casperdamen/.local/share/uv/python/cpython-3.11.8-macos-aarch64-none/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/casperdamen/.local/share/uv/python/cpython-3.11.8-macos-aarch64-none/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:42:04.573510 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 50.853302, "process_in_blocks": "0", "process_kernel_time": 0.617522, "process_mem_max_rss": "224296960", "process_out_blocks": "0", "process_user_time": 2.915574}
[0m15:42:04.573845 [debug] [MainThread]: Command `dbt build` failed at 15:42:04.573775 after 50.85 seconds
[0m15:42:04.574169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eda5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103040f10>]}
[0m15:42:04.574501 [debug] [MainThread]: Flushing usage events
[0m15:42:04.985466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:14.653579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b68410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b68d50>]}


============================== 17:01:14.656367 | 9d7921a3-9497-429b-a176-aa392e81bff2 ==============================
[0m17:01:14.656367 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:01:14.657277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile -m raw_weather', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:01:14.752584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d7921a3-9497-429b-a176-aa392e81bff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af1c10>]}
[0m17:01:14.777736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d7921a3-9497-429b-a176-aa392e81bff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d470d0>]}
[0m17:01:14.778548 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:01:14.852289 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:01:14.891195 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:01:14.891530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d7921a3-9497-429b-a176-aa392e81bff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105301790>]}
[0m17:01:15.351925 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'ENVIRONMENT'
[0m17:01:15.352343 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.7339841, "process_in_blocks": "0", "process_kernel_time": 0.223376, "process_mem_max_rss": "115212288", "process_out_blocks": "0", "process_user_time": 1.168239}
[0m17:01:15.352569 [debug] [MainThread]: Command `dbt compile` failed at 17:01:15.352525 after 0.73 seconds
[0m17:01:15.352779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10053a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b48610>]}
[0m17:01:15.352965 [debug] [MainThread]: Flushing usage events
[0m17:01:15.808278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:37.281203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e246d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e25050>]}


============================== 17:01:37.283878 | 50de9995-38c9-489f-8ef1-3e2a2bd1c13b ==============================
[0m17:01:37.283878 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:01:37.284210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:01:37.360510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50de9995-38c9-489f-8ef1-3e2a2bd1c13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e08ad0>]}
[0m17:01:37.383689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50de9995-38c9-489f-8ef1-3e2a2bd1c13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041776d0>]}
[0m17:01:37.384634 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:01:37.455146 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:01:37.493309 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:01:37.493658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50de9995-38c9-489f-8ef1-3e2a2bd1c13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bd990>]}
[0m17:01:37.936798 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'ENVIRONMENT'
[0m17:01:37.937257 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.68951094, "process_in_blocks": "0", "process_kernel_time": 0.191472, "process_mem_max_rss": "113623040", "process_out_blocks": "0", "process_user_time": 1.162948}
[0m17:01:37.937488 [debug] [MainThread]: Command `dbt compile` failed at 17:01:37.937441 after 0.69 seconds
[0m17:01:37.937700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e08450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e76b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100356690>]}
[0m17:01:37.937894 [debug] [MainThread]: Flushing usage events
[0m17:01:38.368105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:02:35.912686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106948ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106968fd0>]}


============================== 17:02:35.915611 | 6b010e38-dbc0-4868-aea0-35dacc28bff5 ==============================
[0m17:02:35.915611 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:02:35.915965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile -m raw_weather', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:02:35.996824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b010e38-dbc0-4868-aea0-35dacc28bff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692c610>]}
[0m17:02:36.021042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b010e38-dbc0-4868-aea0-35dacc28bff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4b050>]}
[0m17:02:36.022578 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:02:36.103187 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:02:36.144657 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:02:36.145049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b010e38-dbc0-4868-aea0-35dacc28bff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105301990>]}
[0m17:02:36.605660 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'ENVIRONMENT'
[0m17:02:36.606129 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.7282223, "process_in_blocks": "0", "process_kernel_time": 0.223004, "process_mem_max_rss": "116948992", "process_out_blocks": "0", "process_user_time": 1.213392}
[0m17:02:36.606356 [debug] [MainThread]: Command `dbt compile` failed at 17:02:36.606309 after 0.73 seconds
[0m17:02:36.606571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fb6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e80890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106969410>]}
[0m17:02:36.606778 [debug] [MainThread]: Flushing usage events
[0m17:02:37.106583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:06.932016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193f1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194645d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119464f50>]}


============================== 17:07:06.934943 | b0197687-0f11-4cc8-8bae-dee6b676e389 ==============================
[0m17:07:06.934943 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:06.935277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile -m raw_weather', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:07.031254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0197687-0f11-4cc8-8bae-dee6b676e389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195dded0>]}
[0m17:07:07.055401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0197687-0f11-4cc8-8bae-dee6b676e389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e4b010>]}
[0m17:07:07.056080 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:07:07.131098 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:07.172150 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:07:07.172498 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:07:07.172691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0197687-0f11-4cc8-8bae-dee6b676e389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c01950>]}
[0m17:07:07.636795 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'ENVIRONMENT'
[0m17:07:07.637293 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.73904705, "process_in_blocks": "0", "process_kernel_time": 0.220085, "process_mem_max_rss": "116703232", "process_out_blocks": "0", "process_user_time": 1.211396}
[0m17:07:07.637536 [debug] [MainThread]: Command `dbt compile` failed at 17:07:07.637490 after 0.74 seconds
[0m17:07:07.637753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d36690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11943e910>]}
[0m17:07:07.637961 [debug] [MainThread]: Flushing usage events
[0m17:07:08.101019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:54.878706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105816a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586cad0>]}


============================== 17:07:54.882006 | 98912404-51f4-4033-b3ae-789c9e5b78db ==============================
[0m17:07:54.882006 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:54.882420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m raw_weather', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:54.970103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98912404-51f4-4033-b3ae-789c9e5b78db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105963f10>]}
[0m17:07:54.994098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98912404-51f4-4033-b3ae-789c9e5b78db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4c390>]}
[0m17:07:54.994829 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:07:55.072734 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:55.111571 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:07:55.111890 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:07:55.112081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98912404-51f4-4033-b3ae-789c9e5b78db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c25890>]}
[0m17:07:55.580824 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ENVIRONMENT'
[0m17:07:55.581256 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.7406992, "process_in_blocks": "0", "process_kernel_time": 0.213687, "process_mem_max_rss": "116031488", "process_out_blocks": "0", "process_user_time": 1.219716}
[0m17:07:55.581477 [debug] [MainThread]: Command `dbt compile` failed at 17:07:55.581432 after 0.74 seconds
[0m17:07:55.581684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d56690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c22450>]}
[0m17:07:55.581890 [debug] [MainThread]: Flushing usage events
[0m17:07:56.025595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:42.660256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244b1d0>]}


============================== 17:08:42.662810 | 2a523ff3-6a21-47e2-8391-fca574cf321c ==============================
[0m17:08:42.662810 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:08:42.663144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -m raw_weather', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:42.738367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a523ff3-6a21-47e2-8391-fca574cf321c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11243ebd0>]}
[0m17:08:42.761289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a523ff3-6a21-47e2-8391-fca574cf321c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b3550>]}
[0m17:08:42.761819 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:08:42.832627 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:08:42.870892 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:08:42.871208 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:08:42.871401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a523ff3-6a21-47e2-8391-fca574cf321c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f9810>]}
[0m17:08:43.309061 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'ENVIRONMENT'
[0m17:08:43.309464 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.6849341, "process_in_blocks": "0", "process_kernel_time": 0.174925, "process_mem_max_rss": "118980608", "process_out_blocks": "0", "process_user_time": 1.195192}
[0m17:08:43.309670 [debug] [MainThread]: Command `dbt compile` failed at 17:08:43.309629 after 0.69 seconds
[0m17:08:43.309864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a66690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124652d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127b0ad0>]}
[0m17:08:43.310055 [debug] [MainThread]: Flushing usage events
[0m17:08:43.808215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:52.437101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b68310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b68c90>]}


============================== 17:08:52.439349 | 0d8291c7-de15-4878-b522-b126fc3abece ==============================
[0m17:08:52.439349 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:08:52.439672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:08:52.517916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d8291c7-de15-4878-b522-b126fc3abece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c36ed0>]}
[0m17:08:52.541191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d8291c7-de15-4878-b522-b126fc3abece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104470d0>]}
[0m17:08:52.541735 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:08:52.611439 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:08:52.653384 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:08:52.653743 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:08:52.653950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d8291c7-de15-4878-b522-b126fc3abece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107301790>]}
[0m17:08:53.099584 [error] [MainThread]: Encountered an error:
Parsing Error
  Secret env vars are allowed only in profiles.yml or packages.yml. Found 'DBT_ENV_SECRET_S3_ACCESS_KEY' referenced elsewhere.
[0m17:08:53.099996 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.6961971, "process_in_blocks": "0", "process_kernel_time": 0.171298, "process_mem_max_rss": "117817344", "process_out_blocks": "0", "process_user_time": 1.208994}
[0m17:08:53.100209 [debug] [MainThread]: Command `dbt compile` failed at 17:08:53.100163 after 0.70 seconds
[0m17:08:53.100413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b69050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b2ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b48510>]}
[0m17:08:53.100613 [debug] [MainThread]: Flushing usage events
[0m17:08:53.557936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:06.310895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094107d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109484750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109485150>]}


============================== 17:11:06.314575 | a71e1cce-f27e-4f31-8450-8685d8acf828 ==============================
[0m17:11:06.314575 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:11:06.315098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:11:06.398032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71e1cce-f27e-4f31-8450-8685d8acf828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109468850>]}
[0m17:11:06.422022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71e1cce-f27e-4f31-8450-8685d8acf828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6b050>]}
[0m17:11:06.423026 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:11:06.498004 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:11:06.538568 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:11:06.538958 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:11:06.539160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a71e1cce-f27e-4f31-8450-8685d8acf828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f28f90>]}
[0m17:11:07.139389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71e1cce-f27e-4f31-8450-8685d8acf828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109952690>]}
[0m17:11:07.170920 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:11:07.173448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:11:07.185124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71e1cce-f27e-4f31-8450-8685d8acf828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c90f10>]}
[0m17:11:07.185457 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:11:07.185646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71e1cce-f27e-4f31-8450-8685d8acf828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2f4d0>]}
[0m17:11:07.186447 [info ] [MainThread]: 
[0m17:11:07.186645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:07.186790 [info ] [MainThread]: 
[0m17:11:07.187058 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:11:07.187579 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default_staging'
[0m17:11:07.193301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:17.894119 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='clickhouse.clickhouse.svc.cluster.local', port=8123): Max retries exceeded with url: /? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x10ca49090>: Failed to resolve 'clickhouse.clickhouse.svc.cluster.local' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://clickhouse.clickhouse.svc.cluster.local:8123)
[0m17:12:48.938775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b905d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b90fd0>]}


============================== 17:12:48.941684 | cd901e77-c09e-47e8-9d6b-735631f12bd0 ==============================
[0m17:12:48.941684 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:48.942034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -m raw_weather', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:12:49.020191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd901e77-c09e-47e8-9d6b-735631f12bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b74910>]}
[0m17:12:49.045150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd901e77-c09e-47e8-9d6b-735631f12bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105677010>]}
[0m17:12:49.046399 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:12:49.125762 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:49.164290 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:12:49.164617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd901e77-c09e-47e8-9d6b-735631f12bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2d7d0>]}
[0m17:12:49.783981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd901e77-c09e-47e8-9d6b-735631f12bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5cc90>]}
[0m17:12:49.818228 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:12:49.820582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:12:49.831405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd901e77-c09e-47e8-9d6b-735631f12bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106665250>]}
[0m17:12:49.831710 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:12:49.831881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd901e77-c09e-47e8-9d6b-735631f12bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f7050>]}
[0m17:12:49.832605 [info ] [MainThread]: 
[0m17:12:49.832776 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:12:49.832912 [info ] [MainThread]: 
[0m17:12:49.833130 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:12:49.833633 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default_staging'
[0m17:12:49.838811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:50.563098 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Code: 210. nodename nor servname provided, or not known (http://localhost:9000)
[0m17:12:51.599162 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:12:51.600245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_staging, now list__default_marts)
[0m17:12:51.602543 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:12:51.606946 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Code: 210. nodename nor servname provided, or not known (http://localhost:9000)
[0m17:12:52.623759 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:12:52.624287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_marts, now list__default_raw)
[0m17:12:52.625712 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:12:52.629480 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Code: 210. nodename nor servname provided, or not known (http://localhost:9000)
[0m17:12:53.645717 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:12:53.646801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:53.647273 [debug] [MainThread]: Connection 'list__default_raw' was left open.
[0m17:12:53.647722 [debug] [MainThread]: On list__default_raw: No close available on handle
[0m17:12:53.648334 [error] [MainThread]: Encountered an error:
Database Error
  Code: 210. nodename nor servname provided, or not known (http://localhost:9000)
[0m17:12:53.649147 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 4.7443047, "process_in_blocks": "0", "process_kernel_time": 0.268665, "process_mem_max_rss": "162840576", "process_out_blocks": "0", "process_user_time": 1.541435}
[0m17:12:53.649659 [debug] [MainThread]: Command `dbt compile` failed at 17:12:53.649570 after 4.74 seconds
[0m17:12:53.650069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b90ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010ca550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101165d50>]}
[0m17:12:53.650527 [debug] [MainThread]: Flushing usage events
[0m17:12:54.119099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:41.639477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126ce10>]}


============================== 17:13:41.642540 | 1a14901e-5cc6-44e3-b962-e3f758991d7d ==============================
[0m17:13:41.642540 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:13:41.642900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m raw_weather', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:41.723071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a14901e-5cc6-44e3-b962-e3f758991d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111378290>]}
[0m17:13:41.748643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a14901e-5cc6-44e3-b962-e3f758991d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d47150>]}
[0m17:13:41.749751 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:13:41.824824 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:13:41.865589 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:13:41.866006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a14901e-5cc6-44e3-b962-e3f758991d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110301890>]}
[0m17:13:42.475799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a14901e-5cc6-44e3-b962-e3f758991d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118426d0>]}
[0m17:13:42.510016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:13:42.512688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:13:42.522027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a14901e-5cc6-44e3-b962-e3f758991d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7ff50>]}
[0m17:13:42.522312 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:13:42.522486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a14901e-5cc6-44e3-b962-e3f758991d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5fc50>]}
[0m17:13:42.523256 [info ] [MainThread]: 
[0m17:13:42.523427 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:13:42.523567 [info ] [MainThread]: 
[0m17:13:42.523792 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:13:42.524226 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default_marts'
[0m17:13:42.529045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:42.872694 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='http', port=80): Max retries exceeded with url: //localhost:8123? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x11536a850>: Failed to resolve 'http' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://http://localhost:8123)
[0m17:13:43.888393 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:13:43.890663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_marts, now list__default_staging)
[0m17:13:43.894728 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:13:43.901529 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='http', port=80): Max retries exceeded with url: //localhost:8123? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x115390550>: Failed to resolve 'http' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://http://localhost:8123)
[0m17:13:44.914278 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:13:44.914786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_staging, now list__default_raw)
[0m17:13:44.917233 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:13:44.923205 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='http', port=80): Max retries exceeded with url: //localhost:8123? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x1153aee90>: Failed to resolve 'http' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://http://localhost:8123)
[0m17:13:45.934459 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:13:45.935074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:45.935332 [debug] [MainThread]: Connection 'list__default_raw' was left open.
[0m17:13:45.935544 [debug] [MainThread]: On list__default_raw: No close available on handle
[0m17:13:45.935957 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='http', port=80): Max retries exceeded with url: //localhost:8123? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x115370710>: Failed to resolve 'http' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://http://localhost:8123)
[0m17:13:45.936416 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 4.3315973, "process_in_blocks": "0", "process_kernel_time": 0.279452, "process_mem_max_rss": "162938880", "process_out_blocks": "0", "process_user_time": 1.611554}
[0m17:13:45.936704 [debug] [MainThread]: Command `dbt compile` failed at 17:13:45.936648 after 4.33 seconds
[0m17:13:45.936961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11503a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11133e490>]}
[0m17:13:45.937327 [debug] [MainThread]: Flushing usage events
[0m17:13:46.431687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:01.066846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108968390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108968d90>]}


============================== 17:14:01.069703 | 4911c4c0-8742-4f46-bc34-ea2906efc1a5 ==============================
[0m17:14:01.069703 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:14:01.070085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile -m raw_weather', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:01.147707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4911c4c0-8742-4f46-bc34-ea2906efc1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8e750>]}
[0m17:14:01.172105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4911c4c0-8742-4f46-bc34-ea2906efc1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084470d0>]}
[0m17:14:01.172680 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:14:01.243907 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:14:01.285081 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:14:01.285508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4911c4c0-8742-4f46-bc34-ea2906efc1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b05790>]}
[0m17:14:01.873466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4911c4c0-8742-4f46-bc34-ea2906efc1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092156d0>]}
[0m17:14:01.907500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:14:01.909567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:14:01.915554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4911c4c0-8742-4f46-bc34-ea2906efc1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6710>]}
[0m17:14:01.915825 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:14:01.916004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4911c4c0-8742-4f46-bc34-ea2906efc1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912c790>]}
[0m17:14:01.916747 [info ] [MainThread]: 
[0m17:14:01.916916 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:14:01.917055 [info ] [MainThread]: 
[0m17:14:01.917285 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:14:01.917721 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default_staging'
[0m17:14:01.922348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:02.262327 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:14:02.262949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_staging, now list__default_raw)
[0m17:14:02.264775 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:14:02.299983 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:14:02.300641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_raw, now list__default_marts)
[0m17:14:02.302563 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:14:02.337028 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:14:02.337752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:02.338211 [debug] [MainThread]: Connection 'list__default_marts' was left open.
[0m17:14:02.338571 [debug] [MainThread]: On list__default_marts: No close available on handle
[0m17:14:02.338951 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 516
   Code: 516. DB::Exception: airflow_dbt: Authentication failed: password is incorrect, or there is no user with such name. (AUTHENTICATION_FAILED) (version 25.5.3.75 (official build))
  
[0m17:14:02.339447 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.3094461, "process_in_blocks": "0", "process_kernel_time": 0.226856, "process_mem_max_rss": "162496512", "process_out_blocks": "0", "process_user_time": 1.572785}
[0m17:14:02.339764 [debug] [MainThread]: Command `dbt compile` failed at 17:14:02.339703 after 1.31 seconds
[0m17:14:02.340046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102686550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108968750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102721fd0>]}
[0m17:14:02.340344 [debug] [MainThread]: Flushing usage events
[0m17:14:02.780098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:24.496062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af64510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af64f10>]}


============================== 17:15:24.499510 | 4a587a8b-d8a9-4fc4-b183-23c5856e8269 ==============================
[0m17:15:24.499510 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:15:24.499919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:15:24.578018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a587a8b-d8a9-4fc4-b183-23c5856e8269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f4450>]}
[0m17:15:24.601805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a587a8b-d8a9-4fc4-b183-23c5856e8269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9939d0>]}
[0m17:15:24.602839 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:15:24.675428 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:15:24.731104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:24.731369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:24.748511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a587a8b-d8a9-4fc4-b183-23c5856e8269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9dcc90>]}
[0m17:15:24.780414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:15:24.783155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:15:24.792349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a587a8b-d8a9-4fc4-b183-23c5856e8269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb5450>]}
[0m17:15:24.792642 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:15:24.792820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a587a8b-d8a9-4fc4-b183-23c5856e8269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb67ad0>]}
[0m17:15:24.793586 [info ] [MainThread]: 
[0m17:15:24.793765 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:15:24.793905 [info ] [MainThread]: 
[0m17:15:24.794155 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:15:24.794628 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default_marts'
[0m17:15:24.799990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:25.399344 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:25.399894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_marts, now list__default_raw)
[0m17:15:25.402020 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:15:25.562238 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:25.563316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_raw, now list__default_staging)
[0m17:15:25.565930 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:15:25.721959 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:25.723569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:25.724171 [debug] [MainThread]: Connection 'list__default_staging' was left open.
[0m17:15:25.724678 [debug] [MainThread]: On list__default_staging: No close available on handle
[0m17:15:25.725300 [error] [MainThread]: Encountered an error:
Database Error
  Database Error
    Failed to create default database due to ClickHouse exception
[0m17:15:25.725763 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.2702426, "process_in_blocks": "0", "process_kernel_time": 0.283125, "process_mem_max_rss": "157204480", "process_out_blocks": "0", "process_user_time": 1.032418}
[0m17:15:25.726041 [debug] [MainThread]: Command `dbt compile` failed at 17:15:25.725986 after 1.27 seconds
[0m17:15:25.726287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af64950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c158510>]}
[0m17:15:25.726537 [debug] [MainThread]: Flushing usage events
[0m17:15:26.169554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:53.866300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c653d0>]}


============================== 17:15:53.868578 | a8667a84-b199-4981-924f-c60098b07223 ==============================
[0m17:15:53.868578 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:15:53.868901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -m raw_weather', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:53.947854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8667a84-b199-4981-924f-c60098b07223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c3e790>]}
[0m17:15:53.972163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8667a84-b199-4981-924f-c60098b07223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f4af90>]}
[0m17:15:53.972772 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:15:54.043117 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:15:54.093001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:54.093269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:54.110121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8667a84-b199-4981-924f-c60098b07223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e30890>]}
[0m17:15:54.142386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:15:54.144361 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:15:54.150806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8667a84-b199-4981-924f-c60098b07223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bb4090>]}
[0m17:15:54.151102 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:15:54.151282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8667a84-b199-4981-924f-c60098b07223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a49a50>]}
[0m17:15:54.152111 [info ] [MainThread]: 
[0m17:15:54.152318 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:15:54.152462 [info ] [MainThread]: 
[0m17:15:54.152718 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:15:54.153186 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__default_marts'
[0m17:15:54.158502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:54.649972 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:54.651496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_marts, now list__default_raw)
[0m17:15:54.655321 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:15:54.814451 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:54.815388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__default_raw, now list__default_staging)
[0m17:15:54.818171 [debug] [ThreadPool]: Opening a new connection, currently in state fail
[0m17:15:54.982324 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:54.983626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:54.984354 [debug] [MainThread]: Connection 'list__default_staging' was left open.
[0m17:15:54.984787 [debug] [MainThread]: On list__default_staging: No close available on handle
[0m17:15:54.985414 [error] [MainThread]: Encountered an error:
Database Error
  Database Error
    Failed to create default database due to ClickHouse exception
[0m17:15:54.986410 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.1551948, "process_in_blocks": "0", "process_kernel_time": 0.233651, "process_mem_max_rss": "156860416", "process_out_blocks": "0", "process_user_time": 1.039676}
[0m17:15:54.987320 [debug] [MainThread]: Command `dbt compile` failed at 17:15:54.987170 after 1.16 seconds
[0m17:15:54.987923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c365d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c65710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157147d0>]}
[0m17:15:54.988525 [debug] [MainThread]: Flushing usage events
[0m17:15:55.428404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:21.584070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615d490>]}


============================== 17:16:21.587503 | c7402c31-b5e4-41b6-82f6-ae610eadaa98 ==============================
[0m17:16:21.587503 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:21.587935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:16:21.615351 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "weather_warehouse", target "raw" invalid: Runtime Error
        schema: default 
        database: weather 
        cluster: None 
    On Clickhouse, database must be omitted or have the same value as schema.
[0m17:16:21.615848 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.066767044, "process_in_blocks": "0", "process_kernel_time": 0.119452, "process_mem_max_rss": "107741184", "process_out_blocks": "0", "process_user_time": 0.638667}
[0m17:16:21.616094 [debug] [MainThread]: Command `dbt compile` failed at 17:16:21.616047 after 0.07 seconds
[0m17:16:21.616319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10032a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f02750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615d0d0>]}
[0m17:16:21.616536 [debug] [MainThread]: Flushing usage events
[0m17:16:22.039298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:02.197992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ff0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114064850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114065250>]}


============================== 17:17:02.200310 | aeebab17-af4d-454b-8729-582362123b67 ==============================
[0m17:17:02.200310 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:17:02.200629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile -m raw_weather', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:02.277369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114076ed0>]}
[0m17:17:02.301113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114200490>]}
[0m17:17:02.301663 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:17:02.368779 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:17:02.406676 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:17:02.407255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131019d0>]}
[0m17:17:02.998305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a088d0>]}
[0m17:17:03.031441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:17:03.033282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:17:03.039492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11526d790>]}
[0m17:17:03.039776 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:17:03.039949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114204890>]}
[0m17:17:03.040714 [info ] [MainThread]: 
[0m17:17:03.040887 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:17:03.041027 [info ] [MainThread]: 
[0m17:17:03.041254 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:17:03.041699 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__weather_raw'
[0m17:17:03.046378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:03.825446 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_raw"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_raw'
      

  ...
[0m17:17:03.875626 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:17:03.901129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_raw, now list__weather_staging)
[0m17:17:03.903103 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_staging'
      

  ...
[0m17:17:03.945535 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:17:03.946550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_staging, now list__weather_marts)
[0m17:17:03.948679 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_marts'
      

  ...
[0m17:17:03.990848 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:17:03.991962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeebab17-af4d-454b-8729-582362123b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114712490>]}
[0m17:17:03.994801 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:17:03.995207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather_marts, now model.weather_warehouse.raw_weather)
[0m17:17:03.995488 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:17:04.002333 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:17:04.003175 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:17:04.003718 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:17:04.004306 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:04.004695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_warehouse.raw_weather, now test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb)
[0m17:17:04.004999 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:04.013952 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb"
[0m17:17:04.014935 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:04.015482 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:04.015789 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:04.016128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb, now test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b)
[0m17:17:04.016432 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:04.019663 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b"
[0m17:17:04.020392 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:04.020859 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:04.021598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:04.021870 [debug] [MainThread]: Connection 'test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b' was left open.
[0m17:17:04.022085 [debug] [MainThread]: On test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b: Close
[0m17:17:04.022771 [debug] [MainThread]: Command end result
[0m17:17:04.039440 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:17:04.040589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:17:04.044250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:17:04.044456 [debug] [MainThread]: Excluded node 'not_null_raw_weather_json_content' from results
[0m17:17:04.044611 [debug] [MainThread]: Excluded node 'not_null_raw_weather_loaded_at' from results
[0m17:17:04.044795 [info ] [MainThread]: Compiled node 'raw_weather' is:


SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-"dev".s3.fr-par.scw.cloud/weather-data-"dev"/weather/*/*.json',
        '"SCWVN5JCMQBYC4B5K147"',
        '"96e3316e-f4e8-4153-bbf2-09ea0ce7a199"',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
[0m17:17:04.045182 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8809391, "process_in_blocks": "0", "process_kernel_time": 0.236341, "process_mem_max_rss": "169394176", "process_out_blocks": "0", "process_user_time": 1.644825}
[0m17:17:04.045412 [debug] [MainThread]: Command `dbt compile` succeeded at 17:17:04.045363 after 1.88 seconds
[0m17:17:04.045631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050925d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114067050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fe3fd0>]}
[0m17:17:04.045835 [debug] [MainThread]: Flushing usage events
[0m17:17:04.507527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:44.762099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113068590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113068f90>]}


============================== 17:17:44.765196 | 8d42913f-a773-4735-b514-80b6dcfc9e66 ==============================
[0m17:17:44.765196 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:17:44.765645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile -m raw_weather', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:44.845063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d42913f-a773-4735-b514-80b6dcfc9e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3f510>]}
[0m17:17:44.868370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d42913f-a773-4735-b514-80b6dcfc9e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b3690>]}
[0m17:17:44.868917 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:17:44.939494 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:17:44.991878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:44.992315 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/raw/raw_weather.sql
[0m17:17:45.159208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d42913f-a773-4735-b514-80b6dcfc9e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11490bfd0>]}
[0m17:17:45.192886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:17:45.195026 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:17:45.201120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d42913f-a773-4735-b514-80b6dcfc9e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ad5710>]}
[0m17:17:45.201397 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:17:45.201568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d42913f-a773-4735-b514-80b6dcfc9e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113743f10>]}
[0m17:17:45.202340 [info ] [MainThread]: 
[0m17:17:45.202514 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:17:45.202650 [info ] [MainThread]: 
[0m17:17:45.202896 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:17:45.203335 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__weather_raw'
[0m17:17:45.208251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:46.011033 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_raw"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_raw'
      

  ...
[0m17:17:46.061866 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:17:46.083869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_raw, now list__weather_staging)
[0m17:17:46.086315 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_staging'
      

  ...
[0m17:17:46.128454 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:17:46.129803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_staging, now list__weather_marts)
[0m17:17:46.131772 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_marts'
      

  ...
[0m17:17:46.170361 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:17:46.171832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d42913f-a773-4735-b514-80b6dcfc9e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117580390>]}
[0m17:17:46.175747 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:17:46.176212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather_marts, now model.weather_warehouse.raw_weather)
[0m17:17:46.176571 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:17:46.184441 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:17:46.185315 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:17:46.185854 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:17:46.186464 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:46.186749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_warehouse.raw_weather, now test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb)
[0m17:17:46.187003 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:46.195143 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb"
[0m17:17:46.195660 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:46.196058 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:17:46.196310 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:46.196633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb, now test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b)
[0m17:17:46.196906 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:46.199481 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b"
[0m17:17:46.199936 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:46.200323 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:17:46.200872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:46.201081 [debug] [MainThread]: Connection 'test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b' was left open.
[0m17:17:46.201278 [debug] [MainThread]: On test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b: Close
[0m17:17:46.201810 [debug] [MainThread]: Command end result
[0m17:17:46.252487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:17:46.253331 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:17:46.256286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:17:46.256464 [debug] [MainThread]: Excluded node 'not_null_raw_weather_json_content' from results
[0m17:17:46.256602 [debug] [MainThread]: Excluded node 'not_null_raw_weather_loaded_at' from results
[0m17:17:46.256759 [info ] [MainThread]: Compiled node 'raw_weather' is:


SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
[0m17:17:46.257105 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5303518, "process_in_blocks": "0", "process_kernel_time": 0.247193, "process_mem_max_rss": "167493632", "process_out_blocks": "0", "process_user_time": 1.27374}
[0m17:17:46.257312 [debug] [MainThread]: Command `dbt compile` succeeded at 17:17:46.257274 after 1.53 seconds
[0m17:17:46.257511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac9e90>]}
[0m17:17:46.257704 [debug] [MainThread]: Flushing usage events
[0m17:17:46.710416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:22.963701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ea290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4bfd0>]}


============================== 17:18:22.966626 | d0547adb-fb75-4a1b-9495-fa93312f3cf4 ==============================
[0m17:18:22.966626 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:22.966967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:18:23.044836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0547adb-fb75-4a1b-9495-fa93312f3cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a19e90>]}
[0m17:18:23.069272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0547adb-fb75-4a1b-9495-fa93312f3cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3ff90>]}
[0m17:18:23.070371 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:18:23.145113 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:23.201345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:23.201712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:23.220434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0547adb-fb75-4a1b-9495-fa93312f3cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b537d0>]}
[0m17:18:23.254491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:18:23.257274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:18:23.267790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0547adb-fb75-4a1b-9495-fa93312f3cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d2390>]}
[0m17:18:23.268129 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:18:23.268311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0547adb-fb75-4a1b-9495-fa93312f3cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108010d10>]}
[0m17:18:23.269107 [info ] [MainThread]: 
[0m17:18:23.269303 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:18:23.269441 [info ] [MainThread]: 
[0m17:18:23.269709 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:18:23.270180 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:18:23.275377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:24.241270 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:18:24.280374 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:18:24.295377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__weather_raw)
[0m17:18:24.296005 [debug] [ThreadPool]: Creating schema "schema: "weather_raw"
"
[0m17:18:24.302104 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "create__weather_raw"} */
create database if not exists `weather_raw`
        
  
        
  ...
[0m17:18:24.336985 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "create__weather_raw"} */
create database if not exists `weather_raw`
        
  
        
  
[0m17:18:24.337481 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m17:18:24.338275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:24.338745 [debug] [MainThread]: Connection 'create__weather_raw' was left open.
[0m17:18:24.339061 [debug] [MainThread]: On create__weather_raw: Close
[0m17:18:24.339365 [info ] [MainThread]: 
[0m17:18:24.339707 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m17:18:24.340171 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON weather_raw.*. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:18:24.340755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4148458, "process_in_blocks": "0", "process_kernel_time": 0.249427, "process_mem_max_rss": "162807808", "process_out_blocks": "0", "process_user_time": 1.065251}
[0m17:18:24.341131 [debug] [MainThread]: Command `dbt run` failed at 17:18:24.341054 after 1.42 seconds
[0m17:18:24.341476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026025d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a70450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a708d0>]}
[0m17:18:24.341864 [debug] [MainThread]: Flushing usage events
[0m17:18:24.797886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:49.807314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12003e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120068cd0>]}


============================== 17:22:49.810143 | c500919b-1d6c-43d8-940c-75242347910d ==============================
[0m17:22:49.810143 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:22:49.810498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m raw_weather', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:22:49.890930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c500919b-1d6c-43d8-940c-75242347910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10360d8d0>]}
[0m17:22:49.915714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c500919b-1d6c-43d8-940c-75242347910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4af10>]}
[0m17:22:49.916816 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:22:49.989823 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:22:50.028310 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:22:50.028708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c500919b-1d6c-43d8-940c-75242347910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202e4150>]}
[0m17:22:50.631423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c500919b-1d6c-43d8-940c-75242347910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120276250>]}
[0m17:22:50.664296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:22:50.666772 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:22:50.676681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c500919b-1d6c-43d8-940c-75242347910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12124bdd0>]}
[0m17:22:50.676984 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:22:50.677166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c500919b-1d6c-43d8-940c-75242347910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121276990>]}
[0m17:22:50.677912 [info ] [MainThread]: 
[0m17:22:50.678089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:50.678229 [info ] [MainThread]: 
[0m17:22:50.678489 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:22:50.678907 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:22:50.683462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:01.014890 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='clickhouse.clickhouse.svc.cluster.local', port=8123): Max retries exceeded with url: /? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x121005b10>: Failed to resolve 'clickhouse.clickhouse.svc.cluster.local' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://clickhouse.clickhouse.svc.cluster.local:8123)
[0m17:23:12.029817 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m17:23:12.032704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:12.033582 [debug] [MainThread]: Connection 'list_' was left open.
[0m17:23:12.034233 [debug] [MainThread]: On list_: No close available on handle
[0m17:23:12.034740 [info ] [MainThread]: 
[0m17:23:12.035264 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 21.36 seconds (21.36s).
[0m17:23:12.036088 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='clickhouse.clickhouse.svc.cluster.local', port=8123): Max retries exceeded with url: /? (Caused by NameResolutionError("<urllib3.connection.HTTPConnection object at 0x12527de50>: Failed to resolve 'clickhouse.clickhouse.svc.cluster.local' ([Errno 8] nodename nor servname provided, or not known)")) executing HTTP request attempt 1 (http://clickhouse.clickhouse.svc.cluster.local:8123)
[0m17:23:12.037112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 22.26383, "process_in_blocks": "0", "process_kernel_time": 0.285923, "process_mem_max_rss": "162545664", "process_out_blocks": "0", "process_user_time": 1.588876}
[0m17:23:12.037630 [debug] [MainThread]: Command `dbt run` failed at 17:23:12.037527 after 22.26 seconds
[0m17:23:12.038117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102212550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12006a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121548490>]}
[0m17:23:12.038649 [debug] [MainThread]: Flushing usage events
[0m17:23:12.602123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:34.663877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3f0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c53f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c560e50>]}


============================== 17:23:34.666531 | 538e2211-7f12-44c9-a526-ba56d189b0f5 ==============================
[0m17:23:34.666531 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:23:34.666859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_weather', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:34.749519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '538e2211-7f12-44c9-a526-ba56d189b0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5488d0>]}
[0m17:23:34.774215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '538e2211-7f12-44c9-a526-ba56d189b0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5e6b90>]}
[0m17:23:34.775339 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:23:34.849250 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:23:34.889519 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:23:34.889940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '538e2211-7f12-44c9-a526-ba56d189b0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6017d0>]}
[0m17:23:35.521864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '538e2211-7f12-44c9-a526-ba56d189b0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3fea10>]}
[0m17:23:35.555900 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:23:35.558160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:23:35.567945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '538e2211-7f12-44c9-a526-ba56d189b0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f947f90>]}
[0m17:23:35.568238 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:23:35.568417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '538e2211-7f12-44c9-a526-ba56d189b0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c52fbd0>]}
[0m17:23:35.569208 [info ] [MainThread]: 
[0m17:23:35.569413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:35.569558 [info ] [MainThread]: 
[0m17:23:35.569802 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:23:35.570234 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:23:35.574744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:36.181210 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m17:23:36.182153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:36.182529 [debug] [MainThread]: Connection 'list_' was left open.
[0m17:23:36.182838 [debug] [MainThread]: On list_: No close available on handle
[0m17:23:36.183131 [info ] [MainThread]: 
[0m17:23:36.183455 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m17:23:36.183924 [error] [MainThread]: Encountered an error:
Database Error
  Database Error
    Failed to create default database due to ClickHouse exception
[0m17:23:36.184486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.554746, "process_in_blocks": "0", "process_kernel_time": 0.28627, "process_mem_max_rss": "163332096", "process_out_blocks": "0", "process_user_time": 1.608955}
[0m17:23:36.184871 [debug] [MainThread]: Command `dbt run` failed at 17:23:36.184797 after 1.56 seconds
[0m17:23:36.185222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049925d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c561110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c560d10>]}
[0m17:23:36.185624 [debug] [MainThread]: Flushing usage events
[0m17:23:36.598095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:23.672995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e35fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea9150>]}


============================== 17:24:23.675977 | b41ce9b1-f33b-4519-ba39-0e908bd813cf ==============================
[0m17:24:23.675977 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:24:23.676332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m raw_weather', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:23.705687 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "weather_warehouse", target "raw" invalid: Runtime Error
        schema: raw 
        database: weather 
        cluster: None 
    On Clickhouse, database must be omitted or have the same value as schema.
[0m17:24:23.706281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.072684295, "process_in_blocks": "0", "process_kernel_time": 0.144847, "process_mem_max_rss": "105119744", "process_out_blocks": "0", "process_user_time": 0.657749}
[0m17:24:23.706551 [debug] [MainThread]: Command `dbt run` failed at 17:24:23.706493 after 0.07 seconds
[0m17:24:23.706795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004965d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100531c50>]}
[0m17:24:23.707026 [debug] [MainThread]: Flushing usage events
[0m17:24:24.153234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:27.722331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d48110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7cd90>]}


============================== 17:26:27.725162 | 6210aa9e-573e-4391-9f7c-17027a2f6e9c ==============================
[0m17:26:27.725162 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:26:27.725503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:26:27.803458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6210aa9e-573e-4391-9f7c-17027a2f6e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d95110>]}
[0m17:26:27.827461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6210aa9e-573e-4391-9f7c-17027a2f6e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109902b90>]}
[0m17:26:27.828287 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:26:27.903918 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:26:27.944444 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:26:27.944844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6210aa9e-573e-4391-9f7c-17027a2f6e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811d810>]}
[0m17:26:28.558972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6210aa9e-573e-4391-9f7c-17027a2f6e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815b710>]}
[0m17:26:28.592190 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:26:28.594575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:26:28.605051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6210aa9e-573e-4391-9f7c-17027a2f6e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14a690>]}
[0m17:26:28.605375 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:26:28.605559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6210aa9e-573e-4391-9f7c-17027a2f6e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b172e90>]}
[0m17:26:28.606306 [info ] [MainThread]: 
[0m17:26:28.606485 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:26:28.606628 [info ] [MainThread]: 
[0m17:26:28.606864 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:26:28.607289 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:26:28.611618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:29.487540 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:26:29.526420 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:26:29.538863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__weather_raw)
[0m17:26:29.539294 [debug] [ThreadPool]: Creating schema "schema: "weather_raw"
"
[0m17:26:29.544422 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "create__weather_raw"} */
create database if not exists `weather_raw`
        
  
        
  ...
[0m17:26:29.582544 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "create__weather_raw"} */
create database if not exists `weather_raw`
        
  
        
  
[0m17:26:29.582896 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m17:26:29.583512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:29.583905 [debug] [MainThread]: Connection 'create__weather_raw' was left open.
[0m17:26:29.584242 [debug] [MainThread]: On create__weather_raw: Close
[0m17:26:29.584583 [info ] [MainThread]: 
[0m17:26:29.584953 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m17:26:29.585459 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON weather_raw.*. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:26:29.586094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8979961, "process_in_blocks": "0", "process_kernel_time": 0.284234, "process_mem_max_rss": "166445056", "process_out_blocks": "0", "process_user_time": 1.617683}
[0m17:26:29.586532 [debug] [MainThread]: Command `dbt run` failed at 17:26:29.586445 after 1.90 seconds
[0m17:26:29.586927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43d750>]}
[0m17:26:29.587366 [debug] [MainThread]: Flushing usage events
[0m17:26:30.114772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:29.919507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c60790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c61190>]}


============================== 17:27:29.922587 | 139771e5-17de-46c0-be43-813b8d11c517 ==============================
[0m17:27:29.922587 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:29.922948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:27:30.005610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3e190>]}
[0m17:27:30.029370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4ae90>]}
[0m17:27:30.030467 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:27:30.102777 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:30.160434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:30.160730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:30.178187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1f210>]}
[0m17:27:30.227727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:27:30.230888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:27:30.242258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b4110>]}
[0m17:27:30.242598 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:27:30.242789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a115d0>]}
[0m17:27:30.243574 [info ] [MainThread]: 
[0m17:27:30.243757 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:27:30.243897 [info ] [MainThread]: 
[0m17:27:30.244168 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:27:30.244600 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:27:30.249950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:31.230030 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:27:31.267758 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:27:31.282715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__weather_raw)
[0m17:27:31.283177 [debug] [ThreadPool]: Creating schema "schema: "weather_raw"
"
[0m17:27:31.287384 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "create__weather_raw"} */
create database if not exists `weather_raw`
        
  
        
  ...
[0m17:27:31.326182 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:27:31.327985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__weather_raw, now list__weather_staging)
[0m17:27:31.332851 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list__weather_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_staging'
      

  ...
[0m17:27:31.375624 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:27:31.377601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_staging, now list__weather_raw)
[0m17:27:31.380506 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list__weather_raw"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_raw'
      

  ...
[0m17:27:31.427744 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:27:31.429845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_raw, now list__weather_marts)
[0m17:27:31.432013 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list__weather_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_marts'
      

  ...
[0m17:27:31.473939 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:27:31.477327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ba5d0>]}
[0m17:27:31.480622 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:27:31.481176 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather_raw`.`raw_weather` ....................... [RUN]
[0m17:27:31.481600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather_marts, now model.weather_warehouse.raw_weather)
[0m17:27:31.481813 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:27:31.486097 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:27:31.486670 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:27:31.498850 [debug] [Thread-1 (]: Creating new relation raw_weather
[0m17:27:31.513636 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        ...
[0m17:27:31.550290 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        
[0m17:27:31.558063 [debug] [Thread-1 (]: Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TABLE ON weather_raw.raw_weather. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:27:31.559232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139771e5-17de-46c0-be43-813b8d11c517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169ebc50>]}
[0m17:27:31.559745 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model `weather_raw`.`raw_weather` .............. [[31mERROR[0m in 0.08s]
[0m17:27:31.560145 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:27:31.560523 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.raw_weather' to be skipped because of status 'error'.  Reason: Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TABLE ON weather_raw.raw_weather. (ACCESS_DENIED) (version 25.5.3.75 (official build)).
[0m17:27:31.561703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:31.561916 [debug] [MainThread]: Connection 'model.weather_warehouse.raw_weather' was left open.
[0m17:27:31.562110 [debug] [MainThread]: On model.weather_warehouse.raw_weather: Close
[0m17:27:31.562357 [info ] [MainThread]: 
[0m17:27:31.562564 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m17:27:31.562957 [debug] [MainThread]: Command end result
[0m17:27:31.580717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:27:31.582038 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:27:31.585638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:27:31.585908 [info ] [MainThread]: 
[0m17:27:31.586144 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:27:31.586328 [info ] [MainThread]: 
[0m17:27:31.586542 [error] [MainThread]:   Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TABLE ON weather_raw.raw_weather. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:27:31.586720 [info ] [MainThread]: 
[0m17:27:31.586895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:27:31.587246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7064524, "process_in_blocks": "0", "process_kernel_time": 0.28269, "process_mem_max_rss": "164888576", "process_out_blocks": "0", "process_user_time": 1.137909}
[0m17:27:31.587469 [debug] [MainThread]: Command `dbt run` failed at 17:27:31.587429 after 1.71 seconds
[0m17:27:31.587694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c5e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cf9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ea850>]}
[0m17:27:31.587901 [debug] [MainThread]: Flushing usage events
[0m17:27:32.034970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:40.848533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107338550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ac990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ad390>]}


============================== 17:31:40.851831 | 16c05a4f-5cda-482f-9a3e-035025c1d026 ==============================
[0m17:31:40.851831 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:31:40.852179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m raw_weather', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:40.949500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a4fd0>]}
[0m17:31:40.973066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f0d0>]}
[0m17:31:40.973689 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:31:41.048890 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:31:41.109657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:41.109974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:41.127973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705c190>]}
[0m17:31:41.162203 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:31:41.164842 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:31:41.177021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107902a90>]}
[0m17:31:41.177342 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:31:41.177531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460b10>]}
[0m17:31:41.178335 [info ] [MainThread]: 
[0m17:31:41.178520 [info ] [MainThread]: Concurrency: 1 threads (target='raw')
[0m17:31:41.178663 [info ] [MainThread]: 
[0m17:31:41.178922 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:31:41.179354 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:31:41.184427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:42.184805 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:31:42.222693 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:31:42.247479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather_raw)
[0m17:31:42.252953 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list__weather_raw"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_raw'
      

  ...
[0m17:31:42.291217 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:31:42.292450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_raw, now list__weather_staging)
[0m17:31:42.294067 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list__weather_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_staging'
      

  ...
[0m17:31:42.336060 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:31:42.337104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_staging, now list__weather_marts)
[0m17:31:42.338731 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "connection_name": "list__weather_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_marts'
      

  ...
[0m17:31:42.380995 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:31:42.382137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107902810>]}
[0m17:31:42.385680 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:31:42.386229 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather_raw`.`raw_weather` ....................... [RUN]
[0m17:31:42.386623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather_marts, now model.weather_warehouse.raw_weather)
[0m17:31:42.386913 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:31:42.392671 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:31:42.393247 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:31:42.407899 [debug] [Thread-1 (]: Creating new relation raw_weather
[0m17:31:42.425426 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        ...
[0m17:31:42.465829 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "raw", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        
[0m17:31:42.472668 [debug] [Thread-1 (]: Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:31:42.473672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16c05a4f-5cda-482f-9a3e-035025c1d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107963050>]}
[0m17:31:42.474119 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model `weather_raw`.`raw_weather` .............. [[31mERROR[0m in 0.09s]
[0m17:31:42.474475 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:31:42.474794 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.raw_weather' to be skipped because of status 'error'.  Reason: Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.5.3.75 (official build)).
[0m17:31:42.475864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:42.476083 [debug] [MainThread]: Connection 'model.weather_warehouse.raw_weather' was left open.
[0m17:31:42.476261 [debug] [MainThread]: On model.weather_warehouse.raw_weather: Close
[0m17:31:42.476484 [info ] [MainThread]: 
[0m17:31:42.476673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m17:31:42.477014 [debug] [MainThread]: Command end result
[0m17:31:42.490981 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:31:42.491981 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:31:42.494921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:31:42.495100 [info ] [MainThread]: 
[0m17:31:42.495303 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:31:42.495467 [info ] [MainThread]: 
[0m17:31:42.495657 [error] [MainThread]:   Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:31:42.495804 [info ] [MainThread]: 
[0m17:31:42.495959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:42.496271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6844635, "process_in_blocks": "0", "process_kernel_time": 0.308181, "process_mem_max_rss": "164380672", "process_out_blocks": "0", "process_user_time": 1.11137}
[0m17:31:42.496468 [debug] [MainThread]: Command `dbt run` failed at 17:31:42.496430 after 1.68 seconds
[0m17:31:42.496667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107386490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10299a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107390510>]}
[0m17:31:42.496855 [debug] [MainThread]: Flushing usage events
[0m17:31:42.963912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:35.353730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104604d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110460ed0>]}


============================== 17:32:35.356996 | c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29 ==============================
[0m17:32:35.356996 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:32:35.357343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:32:35.449907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110570190>]}
[0m17:32:35.472647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107747190>]}
[0m17:32:35.473234 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:32:35.547726 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:32:35.608401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:35.608689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:35.626396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110702c50>]}
[0m17:32:35.660552 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:32:35.662947 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:32:35.674781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122b4090>]}
[0m17:32:35.675081 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:32:35.675260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ade10>]}
[0m17:32:35.676023 [info ] [MainThread]: 
[0m17:32:35.676203 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:32:35.676339 [info ] [MainThread]: 
[0m17:32:35.676595 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:32:35.677031 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:32:35.682009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:36.610535 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:32:36.660803 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:32:36.684579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather_raw)
[0m17:32:36.687741 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_raw"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_raw'
      

  ...
[0m17:32:36.736042 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:32:36.737406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_raw, now list__weather_staging)
[0m17:32:36.739527 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_staging'
      

  ...
[0m17:32:36.783272 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:32:36.784930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_staging, now list__weather_marts)
[0m17:32:36.787250 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_marts'
      

  ...
[0m17:32:36.835931 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:32:36.841555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a46d0>]}
[0m17:32:36.846813 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:32:36.847573 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather_raw`.`raw_weather` ....................... [RUN]
[0m17:32:36.848143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather_marts, now model.weather_warehouse.raw_weather)
[0m17:32:36.848568 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:32:36.857744 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:32:36.858667 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:32:36.877462 [debug] [Thread-1 (]: Creating new relation raw_weather
[0m17:32:36.897502 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        ...
[0m17:32:36.934591 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        
[0m17:32:36.941222 [debug] [Thread-1 (]: Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:32:36.942208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c0e5b9-666b-487e-8e1f-b4e4c0caeb29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058b750>]}
[0m17:32:36.942662 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model `weather_raw`.`raw_weather` .............. [[31mERROR[0m in 0.09s]
[0m17:32:36.943026 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:32:36.943350 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.raw_weather' to be skipped because of status 'error'.  Reason: Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.5.3.75 (official build)).
[0m17:32:36.944405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:36.944598 [debug] [MainThread]: Connection 'model.weather_warehouse.raw_weather' was left open.
[0m17:32:36.944772 [debug] [MainThread]: On model.weather_warehouse.raw_weather: Close
[0m17:32:36.944989 [info ] [MainThread]: 
[0m17:32:36.945169 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m17:32:36.945494 [debug] [MainThread]: Command end result
[0m17:32:36.959971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:32:36.960960 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:32:36.963952 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:32:36.964142 [info ] [MainThread]: 
[0m17:32:36.964347 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:32:36.964509 [info ] [MainThread]: 
[0m17:32:36.964705 [error] [MainThread]:   Database Error in model raw_weather (models/raw/raw_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: airflow_dbt: Not enough privileges. To execute this query, it's necessary to have the grant CREATE TEMPORARY TABLE, S3 ON *.*. (ACCESS_DENIED) (version 25.5.3.75 (official build))
[0m17:32:36.964858 [info ] [MainThread]: 
[0m17:32:36.965011 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:32:36.965330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6468688, "process_in_blocks": "0", "process_kernel_time": 0.297457, "process_mem_max_rss": "163430400", "process_out_blocks": "0", "process_user_time": 1.10694}
[0m17:32:36.965538 [debug] [MainThread]: Command `dbt run` failed at 17:32:36.965498 after 1.65 seconds
[0m17:32:36.965740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103072110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103071e90>]}
[0m17:32:36.965936 [debug] [MainThread]: Flushing usage events
[0m17:32:37.424490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:17.017292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113df1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113df1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e6cfd0>]}


============================== 17:43:17.020072 | db5378c2-cd9f-4a87-8a40-121c4df3a25b ==============================
[0m17:43:17.020072 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:43:17.020438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m raw_weather', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:17.097463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e81110>]}
[0m17:43:17.120336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b36d0>]}
[0m17:43:17.120958 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:43:17.192841 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:43:17.250455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:17.250708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:17.267496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a44d0>]}
[0m17:43:17.300043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:43:17.302205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:43:17.312872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143c86d0>]}
[0m17:43:17.313171 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:43:17.313353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111605510>]}
[0m17:43:17.314139 [info ] [MainThread]: 
[0m17:43:17.314334 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:43:17.314477 [info ] [MainThread]: 
[0m17:43:17.314750 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:43:17.315182 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:43:17.320209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:18.478788 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:43:18.521323 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:18.550201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather_marts)
[0m17:43:18.556016 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_marts'
      

  ...
[0m17:43:18.598984 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:18.600791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_marts, now list__weather_staging)
[0m17:43:18.603183 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_staging'
      

  ...
[0m17:43:18.646322 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:18.648516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__weather_staging, now list__weather_raw)
[0m17:43:18.651349 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather_raw: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather_raw"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather_raw'
      

  ...
[0m17:43:18.691668 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:18.693750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ba610>]}
[0m17:43:18.697266 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:43:18.697897 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather_raw`.`raw_weather` ....................... [RUN]
[0m17:43:18.698351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather_raw, now model.weather_warehouse.raw_weather)
[0m17:43:18.698679 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:43:18.706115 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:43:18.706820 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:43:18.722708 [debug] [Thread-1 (]: Creating new relation raw_weather
[0m17:43:18.738827 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather_raw`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        ...
[0m17:43:19.130198 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m17:43:19.148615 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

    select name, type from system.columns where table = 'raw_weather'
    
      and database = 'weather_raw'
    
    order by position
  ...
[0m17:43:19.186904 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:19.190398 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.raw_weather"
[0m17:43:19.191737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

  
    
    
    
        
         


        insert into `weather_raw`.`raw_weather`
        ("json_content", "loaded_at")

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
  ...
[0m17:43:22.094718 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 2.90 seconds
[0m17:43:22.106019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db5378c2-cd9f-4a87-8a40-121c4df3a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116017950>]}
[0m17:43:22.106549 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `weather_raw`.`raw_weather` .................. [[32mOK[0m in 3.41s]
[0m17:43:22.106843 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:43:22.107919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:22.108134 [debug] [MainThread]: Connection 'model.weather_warehouse.raw_weather' was left open.
[0m17:43:22.108285 [debug] [MainThread]: On model.weather_warehouse.raw_weather: Close
[0m17:43:22.108491 [info ] [MainThread]: 
[0m17:43:22.108651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m17:43:22.108957 [debug] [MainThread]: Command end result
[0m17:43:22.123655 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:43:22.124896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:43:22.127988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:43:22.128255 [info ] [MainThread]: 
[0m17:43:22.128483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:22.128646 [info ] [MainThread]: 
[0m17:43:22.128807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:43:22.129155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.145249, "process_in_blocks": "0", "process_kernel_time": 0.301693, "process_mem_max_rss": "162578432", "process_out_blocks": "0", "process_user_time": 1.131576}
[0m17:43:22.129363 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:22.129325 after 5.15 seconds
[0m17:43:22.129558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ece5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e6eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e6d390>]}
[0m17:43:22.129777 [debug] [MainThread]: Flushing usage events
[0m17:43:22.591901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:14.958371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109658610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109659010>]}


============================== 17:44:14.960782 | 2ec0945a-5964-418e-82a6-cb45c72e9d77 ==============================
[0m17:44:14.960782 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:44:14.961114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_weather', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:15.035677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e0f10>]}
[0m17:44:15.058456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4b090>]}
[0m17:44:15.059412 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:44:15.128466 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:44:15.167009 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:44:15.167363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c8150>]}
[0m17:44:15.744587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b325d0>]}
[0m17:44:15.776258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:44:15.778094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:44:15.787392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e0650>]}
[0m17:44:15.787681 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:44:15.787865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b7ce90>]}
[0m17:44:15.788587 [info ] [MainThread]: 
[0m17:44:15.788761 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:44:15.788899 [info ] [MainThread]: 
[0m17:44:15.789132 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:44:15.789540 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:44:15.793759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:16.594788 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:44:16.634708 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:44:16.659664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:44:16.664990 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:44:16.706048 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:44:16.707676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c30dc10>]}
[0m17:44:16.710475 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:44:16.710957 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather`.`raw_weather` ........................... [RUN]
[0m17:44:16.711379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.raw_weather)
[0m17:44:16.711687 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:44:16.717890 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:44:16.718476 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:44:16.730575 [debug] [Thread-1 (]: Creating new relation raw_weather
[0m17:44:16.747474 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather`.`raw_weather`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        ...
[0m17:44:17.192382 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m17:44:17.211222 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

    select name, type from system.columns where table = 'raw_weather'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:44:17.247859 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:44:17.251718 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.raw_weather"
[0m17:44:17.252732 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

  
    
    
    
        
         


        insert into `weather`.`raw_weather`
        ("json_content", "loaded_at")

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
  ...
[0m17:44:19.750647 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 2.50 seconds
[0m17:44:19.775268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec0945a-5964-418e-82a6-cb45c72e9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d74550>]}
[0m17:44:19.776033 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `weather`.`raw_weather` ...................... [[32mOK[0m in 3.06s]
[0m17:44:19.776539 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:44:19.777542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:19.777837 [debug] [MainThread]: Connection 'model.weather_warehouse.raw_weather' was left open.
[0m17:44:19.778081 [debug] [MainThread]: On model.weather_warehouse.raw_weather: Close
[0m17:44:19.778392 [info ] [MainThread]: 
[0m17:44:19.778636 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m17:44:19.779081 [debug] [MainThread]: Command end result
[0m17:44:19.795455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:44:19.796527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:44:19.799939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:44:19.800156 [info ] [MainThread]: 
[0m17:44:19.800413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:19.800596 [info ] [MainThread]: 
[0m17:44:19.800791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:19.801167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8765874, "process_in_blocks": "0", "process_kernel_time": 0.241997, "process_mem_max_rss": "169279488", "process_out_blocks": "0", "process_user_time": 1.663189}
[0m17:44:19.801408 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:19.801363 after 4.88 seconds
[0m17:44:19.801645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109402210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10325de10>]}
[0m17:44:19.801866 [debug] [MainThread]: Flushing usage events
[0m17:44:20.237511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:09.139223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112064790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11203fe50>]}


============================== 17:45:09.141838 | 6329f0ac-27d6-434b-b737-27f2f53d304f ==============================
[0m17:45:09.141838 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:45:09.142173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:09.219013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6329f0ac-27d6-434b-b737-27f2f53d304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770ab10>]}
[0m17:45:09.242054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6329f0ac-27d6-434b-b737-27f2f53d304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112203290>]}
[0m17:45:09.242712 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:45:09.312501 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:45:09.367812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:09.368073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:09.384879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6329f0ac-27d6-434b-b737-27f2f53d304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112447b50>]}
[0m17:45:09.418000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:45:09.420037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:45:09.429812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6329f0ac-27d6-434b-b737-27f2f53d304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b9410>]}
[0m17:45:09.430118 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:45:09.430295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6329f0ac-27d6-434b-b737-27f2f53d304f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215e150>]}
[0m17:45:09.430636 [warn ] [MainThread]: The selection criterion 'stg_staging' does not match any enabled nodes
[0m17:45:09.431212 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:45:09.432033 [debug] [MainThread]: Command end result
[0m17:45:09.443193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:45:09.443873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:45:09.445275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:45:09.445596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3404436, "process_in_blocks": "0", "process_kernel_time": 0.170984, "process_mem_max_rss": "116998144", "process_out_blocks": "0", "process_user_time": 0.80998}
[0m17:45:09.445800 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:09.445758 after 0.34 seconds
[0m17:45:09.446002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11203e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104554750>]}
[0m17:45:09.446175 [debug] [MainThread]: Flushing usage events
[0m17:45:09.938929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:17.032685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a59210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a59c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac1010>]}


============================== 17:45:17.034885 | 149a3250-2cd8-417a-83dc-c5e96b972287 ==============================
[0m17:45:17.034885 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:45:17.035217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_weather', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:17.110521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a655d0>]}
[0m17:45:17.133942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055af090>]}
[0m17:45:17.134451 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:45:17.212328 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:45:17.261124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:17.261375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:17.278308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c712d0>]}
[0m17:45:17.311935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:45:17.313958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:45:17.320387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601c050>]}
[0m17:45:17.320697 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:45:17.320881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef2050>]}
[0m17:45:17.321659 [info ] [MainThread]: 
[0m17:45:17.321842 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:45:17.321976 [info ] [MainThread]: 
[0m17:45:17.322237 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:45:17.322649 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:45:17.327755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:18.126100 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:45:18.164773 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:45:18.189093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:45:18.194223 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:45:18.233796 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:45:18.235840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb610>]}
[0m17:45:18.238691 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather
[0m17:45:18.239150 [info ] [Thread-1 (]: 1 of 1 START sql incremental model `weather`.`stg_weather` ..................... [RUN]
[0m17:45:18.239549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.stg_weather)
[0m17:45:18.239845 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather
[0m17:45:18.249460 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather"
[0m17:45:18.250136 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather
[0m17:45:18.291100 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

            

    
        create table `weather`.`stg_weather`
        
  
        
  engine = MergeTree()
        order by (weather_date)
        
        partition by (toYYYYMM(weather_date))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
)

SELECT
    JSONExtractString(json_content, 'city') AS city_name,
    JSONExtractFloat(json_content, 'lat') AS latitude,
    JSONExtractFloat(json_content, 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp')) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp'))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp'))) AS weather_hour,
    JSONExtractFloat(json_content, 'temperature') AS temperature_celsius,
    JSONExtractFloat(json_content, 'humidity') AS humidity_percent,
    JSONExtractFloat(json_content, 'wind_speed') AS wind_speed_ms,
    JSONExtractFloat(json_content, 'wind_direction') AS wind_direction_degrees,
    JSONExtractFloat(json_content, 'pressure') AS pressure_hpa,
    JSONExtractFloat(json_content, 'precipitation') AS precipitation_mm,
    loaded_at
FROM source_data
          )
        
        ...
[0m17:45:18.335762 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:45:18.344803 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

    select name, type from system.columns where table = 'stg_weather'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:45:18.381899 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:45:18.384590 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather"
[0m17:45:18.385265 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

        
  
    
    
    
        
         


        insert into `weather`.`stg_weather`
        ("city_name", "latitude", "longitude", "weather_datetime", "weather_date", "weather_hour", "temperature_celsius", "humidity_percent", "wind_speed_ms", "wind_direction_degrees", "pressure_hpa", "precipitation_mm", "loaded_at")

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
)

SELECT
    JSONExtractString(json_content, 'city') AS city_name,
    JSONExtractFloat(json_content, 'lat') AS latitude,
    JSONExtractFloat(json_content, 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp')) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp'))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp'))) AS weather_hour,
    JSONExtractFloat(json_content, 'temperature') AS temperature_celsius,
    JSONExtractFloat(json_content, 'humidity') AS humidity_percent,
    JSONExtractFloat(json_content, 'wind_speed') AS wind_speed_ms,
    JSONExtractFloat(json_content, 'wind_direction') AS wind_direction_degrees,
    JSONExtractFloat(json_content, 'pressure') AS pressure_hpa,
    JSONExtractFloat(json_content, 'precipitation') AS precipitation_mm,
    loaded_at
FROM source_data
  
    ...
[0m17:45:18.423876 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

        
  
    
    
    
        
         


        insert into `weather`.`stg_weather`
        ("city_name", "latitude", "longitude", "weather_datetime", "weather_date", "weather_hour", "temperature_celsius", "humidity_percent", "wind_speed_ms", "wind_direction_degrees", "pressure_hpa", "precipitation_mm", "loaded_at")

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
)

SELECT
    JSONExtractString(json_content, 'city') AS city_name,
    JSONExtractFloat(json_content, 'lat') AS latitude,
    JSONExtractFloat(json_content, 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp')) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp'))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'timestamp'))) AS weather_hour,
    JSONExtractFloat(json_content, 'temperature') AS temperature_celsius,
    JSONExtractFloat(json_content, 'humidity') AS humidity_percent,
    JSONExtractFloat(json_content, 'wind_speed') AS wind_speed_ms,
    JSONExtractFloat(json_content, 'wind_direction') AS wind_direction_degrees,
    JSONExtractFloat(json_content, 'pressure') AS pressure_hpa,
    JSONExtractFloat(json_content, 'precipitation') AS precipitation_mm,
    loaded_at
FROM source_data
  
    
[0m17:45:18.430219 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 41
   Code: 41. DB::Exception: Cannot read DateTime: neither Date nor Time was parsed successfully: while executing 'FUNCTION parseDateTimeBestEffort(JSONExtractString(__table1.json_content, 'timestamp'_String) :: 4) -> parseDateTimeBestEffort(JSONExtractString(__table1.json_content, 'timestamp'_String)) DateTime : 3'. (CANNOT_PARSE_DATETIME) (version 25.5.3.75 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather.sql
[0m17:45:18.431214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '149a3250-2cd8-417a-83dc-c5e96b972287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f4d90>]}
[0m17:45:18.431685 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model `weather`.`stg_weather` ............ [[31mERROR[0m in 0.19s]
[0m17:45:18.432081 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather
[0m17:45:18.432445 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 41
   Code: 41. DB::Exception: Cannot read DateTime: neither Date nor Time was parsed successfully: while executing 'FUNCTION parseDateTimeBestEffort(JSONExtractString(__table1.json_content, 'timestamp'_String) :: 4) -> parseDateTimeBestEffort(JSONExtractString(__table1.json_content, 'timestamp'_String)) DateTime : 3'. (CANNOT_PARSE_DATETIME) (version 25.5.3.75 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather.sql.
[0m17:45:18.433607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:18.433818 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather' was left open.
[0m17:45:18.434009 [debug] [MainThread]: On model.weather_warehouse.stg_weather: Close
[0m17:45:18.434253 [info ] [MainThread]: 
[0m17:45:18.434462 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m17:45:18.434858 [debug] [MainThread]: Command end result
[0m17:45:18.449791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:45:18.450697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:45:18.453853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:45:18.454059 [info ] [MainThread]: 
[0m17:45:18.454286 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:45:18.454461 [info ] [MainThread]: 
[0m17:45:18.454669 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 41
   Code: 41. DB::Exception: Cannot read DateTime: neither Date nor Time was parsed successfully: while executing 'FUNCTION parseDateTimeBestEffort(JSONExtractString(__table1.json_content, 'timestamp'_String) :: 4) -> parseDateTimeBestEffort(JSONExtractString(__table1.json_content, 'timestamp'_String)) DateTime : 3'. (CANNOT_PARSE_DATETIME) (version 25.5.3.75 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather.sql
[0m17:45:18.454853 [info ] [MainThread]: 
[0m17:45:18.455017 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:45:18.455361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4551892, "process_in_blocks": "0", "process_kernel_time": 0.240071, "process_mem_max_rss": "166150144", "process_out_blocks": "0", "process_user_time": 1.103833}
[0m17:45:18.455582 [debug] [MainThread]: Command `dbt run` failed at 17:45:18.455542 after 1.46 seconds
[0m17:45:18.455802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fe2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10107dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593bd90>]}
[0m17:45:18.456004 [debug] [MainThread]: Flushing usage events
[0m17:45:18.946198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:32.911761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b83e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf0f90>]}


============================== 17:48:32.914873 | ba12e78b-e37d-48af-ac60-ef4525233e5c ==============================
[0m17:48:32.914873 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:48:32.915288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_weather', 'send_anonymous_usage_stats': 'True'}
[0m17:48:33.011733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0e450>]}
[0m17:48:33.035369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4f590>]}
[0m17:48:33.035999 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:48:33.109911 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:48:33.168149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:33.168560 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/staging/stg_weather.sql
[0m17:48:33.349547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b7f90>]}
[0m17:48:33.383681 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:48:33.386439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:48:33.398117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084582d0>]}
[0m17:48:33.398431 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:48:33.398622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108395b10>]}
[0m17:48:33.399394 [info ] [MainThread]: 
[0m17:48:33.399585 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:48:33.399724 [info ] [MainThread]: 
[0m17:48:33.399982 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:48:33.400418 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:48:33.404748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:34.302858 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:48:34.370172 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m17:48:34.398465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:48:34.403645 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:48:34.442416 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:34.444213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822a010>]}
[0m17:48:34.446240 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather
[0m17:48:34.446639 [info ] [Thread-1 (]: 1 of 1 START sql incremental model `weather`.`stg_weather` ..................... [RUN]
[0m17:48:34.446989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.stg_weather)
[0m17:48:34.447256 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather
[0m17:48:34.454612 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather"
[0m17:48:34.455224 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather
[0m17:48:34.484294 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

    select name, type from system.columns where table = 'stg_weather'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:48:34.522265 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:34.524199 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather"
[0m17:48:34.524705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

        insert into `weather`.`stg_weather`
        ("city_name", "latitude", "longitude", "weather_datetime", "weather_date", "weather_hour", "temperature_celsius", "humidity_percent", "wind_speed_ms", "wind_direction_degrees", "pressure_hpa", "precipitation_mm", "loaded_at")

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
    WHERE loaded_at > (SELECT MAX(loaded_at) FROM `weather`.`stg_weather`)
    
)

SELECT
    JSONExtractString(json_content, 'location', 'city') AS city_name,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lat') AS latitude,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1)) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_hour,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'temperature_2m', 1) AS temperature_celsius,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'precipitation', 1) AS precipitation_mm,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'windspeed_10m', 1) AS wind_speed_ms,
    loaded_at
FROM source_data
    ...
[0m17:48:34.565287 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

        insert into `weather`.`stg_weather`
        ("city_name", "latitude", "longitude", "weather_datetime", "weather_date", "weather_hour", "temperature_celsius", "humidity_percent", "wind_speed_ms", "wind_direction_degrees", "pressure_hpa", "precipitation_mm", "loaded_at")

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
    WHERE loaded_at > (SELECT MAX(loaded_at) FROM `weather`.`stg_weather`)
    
)

SELECT
    JSONExtractString(json_content, 'location', 'city') AS city_name,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lat') AS latitude,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1)) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_hour,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'temperature_2m', 1) AS temperature_celsius,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'precipitation', 1) AS precipitation_mm,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'windspeed_10m', 1) AS wind_speed_ms,
    loaded_at
FROM source_data
    
[0m17:48:34.570333 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 20
   Code: 20. DB::Exception: Number of columns doesn't match (source: 10 and result: 13). (NUMBER_OF_COLUMNS_DOESNT_MATCH) (version 25.5.3.75 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather.sql
[0m17:48:34.571156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba12e78b-e37d-48af-ac60-ef4525233e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf1b90>]}
[0m17:48:34.571529 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model `weather`.`stg_weather` ............ [[31mERROR[0m in 0.12s]
[0m17:48:34.571832 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather
[0m17:48:34.572128 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 20
   Code: 20. DB::Exception: Number of columns doesn't match (source: 10 and result: 13). (NUMBER_OF_COLUMNS_DOESNT_MATCH) (version 25.5.3.75 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather.sql.
[0m17:48:34.573051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:34.573214 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather' was left open.
[0m17:48:34.573364 [debug] [MainThread]: On model.weather_warehouse.stg_weather: Close
[0m17:48:34.573563 [info ] [MainThread]: 
[0m17:48:34.573729 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m17:48:34.574029 [debug] [MainThread]: Command end result
[0m17:48:34.624369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:48:34.625238 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:48:34.627943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:48:34.628118 [info ] [MainThread]: 
[0m17:48:34.628310 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:48:34.628465 [info ] [MainThread]: 
[0m17:48:34.628650 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 20
   Code: 20. DB::Exception: Number of columns doesn't match (source: 10 and result: 13). (NUMBER_OF_COLUMNS_DOESNT_MATCH) (version 25.5.3.75 (official build))
  compiled code at target/run/weather_warehouse/models/staging/stg_weather.sql
[0m17:48:34.628797 [info ] [MainThread]: 
[0m17:48:34.628955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:48:34.629256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.754126, "process_in_blocks": "0", "process_kernel_time": 0.303801, "process_mem_max_rss": "167936000", "process_out_blocks": "0", "process_user_time": 1.289368}
[0m17:48:34.629449 [debug] [MainThread]: Command `dbt run` failed at 17:48:34.629412 after 1.75 seconds
[0m17:48:34.629630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eefa10>]}
[0m17:48:34.629806 [debug] [MainThread]: Flushing usage events
[0m17:48:35.098365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:50.280312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ebed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3e690>]}


============================== 17:48:50.282783 | b90428e1-49be-4127-b2c3-bba60c86e27f ==============================
[0m17:48:50.282783 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:48:50.283115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_weather --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:50.360166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101af9c90>]}
[0m17:48:50.383108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4b910>]}
[0m17:48:50.384099 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:48:50.455357 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:48:50.511147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:50.511407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:50.528934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae8f50>]}
[0m17:48:50.562153 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:48:50.564381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:48:50.574157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d01d10>]}
[0m17:48:50.574472 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:48:50.574654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e87750>]}
[0m17:48:50.575425 [info ] [MainThread]: 
[0m17:48:50.575611 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:48:50.575746 [info ] [MainThread]: 
[0m17:48:50.576003 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:48:50.576433 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:48:50.581413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:51.501679 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:48:51.541291 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:51.569302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:48:51.574942 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:48:51.614363 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:51.616592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e50a10>]}
[0m17:48:51.619768 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather
[0m17:48:51.620115 [info ] [Thread-1 (]: 1 of 1 START sql incremental model `weather`.`stg_weather` ..................... [RUN]
[0m17:48:51.620598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.stg_weather)
[0m17:48:51.620801 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather
[0m17:48:51.628868 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather"
[0m17:48:51.629424 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather
[0m17:48:51.669907 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

            

    
        create table `weather`.`stg_weather__dbt_tmp`
        
  
        
  engine = MergeTree()
        order by (weather_date)
        
        partition by (toYYYYMM(weather_date))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
)

SELECT
    JSONExtractString(json_content, 'location', 'city') AS city_name,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lat') AS latitude,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1)) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_hour,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'temperature_2m', 1) AS temperature_celsius,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'precipitation', 1) AS precipitation_mm,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'windspeed_10m', 1) AS wind_speed_ms,
    loaded_at
FROM source_data
          )
        
        ...
[0m17:48:51.721006 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:48:51.730147 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

    select name, type from system.columns where table = 'stg_weather__dbt_tmp'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:48:51.767848 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:51.771113 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather"
[0m17:48:51.771870 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

        
  
    
    
    
        
         


        insert into `weather`.`stg_weather__dbt_tmp`
        ("city_name", "latitude", "longitude", "weather_datetime", "weather_date", "weather_hour", "temperature_celsius", "precipitation_mm", "wind_speed_ms", "loaded_at")

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
)

SELECT
    JSONExtractString(json_content, 'location', 'city') AS city_name,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lat') AS latitude,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1)) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_hour,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'temperature_2m', 1) AS temperature_celsius,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'precipitation', 1) AS precipitation_mm,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'windspeed_10m', 1) AS wind_speed_ms,
    loaded_at
FROM source_data
  
    ...
[0m17:48:51.816910 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:51.821660 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

    drop table if exists `weather`.`stg_weather__dbt_backup` 
  
  ...
[0m17:48:51.854583 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:48:51.855462 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

    rename table `weather`.`stg_weather__dbt_tmp` to `weather`.`stg_weather__dbt_backup` 
  
  ...
[0m17:48:51.890195 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:48:51.893890 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */
EXCHANGE TABLES `weather`.`stg_weather__dbt_backup` AND `weather`.`stg_weather` 
  
  ...
[0m17:48:51.929904 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:48:51.953275 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */
drop table if exists `weather`.`stg_weather__dbt_backup` 
  ...
[0m17:48:51.987872 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:48:51.990551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b90428e1-49be-4127-b2c3-bba60c86e27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba4810>]}
[0m17:48:51.991106 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model `weather`.`stg_weather` ................ [[32mOK[0m in 0.37s]
[0m17:48:51.991528 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather
[0m17:48:51.992388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:51.992628 [debug] [MainThread]: Connection 'model.weather_warehouse.stg_weather' was left open.
[0m17:48:51.992845 [debug] [MainThread]: On model.weather_warehouse.stg_weather: Close
[0m17:48:51.993149 [info ] [MainThread]: 
[0m17:48:51.993391 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m17:48:51.993829 [debug] [MainThread]: Command end result
[0m17:48:52.010161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:48:52.011152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:48:52.014814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:48:52.015067 [info ] [MainThread]: 
[0m17:48:52.015326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:52.015517 [info ] [MainThread]: 
[0m17:48:52.015711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:48:52.016083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7690624, "process_in_blocks": "0", "process_kernel_time": 0.275838, "process_mem_max_rss": "164937728", "process_out_blocks": "0", "process_user_time": 1.157265}
[0m17:48:52.016335 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:52.016284 after 1.77 seconds
[0m17:48:52.016558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006c65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e3f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560ff90>]}
[0m17:48:52.016769 [debug] [MainThread]: Flushing usage events
[0m17:48:52.439363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:37.110665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105018c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105040d90>]}


============================== 17:49:37.112877 | 736d0322-1fc4-40d6-b043-3ae5f6b9bf05 ==============================
[0m17:49:37.112877 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:49:37.113206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m marts_daily_weather_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:37.189287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '736d0322-1fc4-40d6-b043-3ae5f6b9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105092790>]}
[0m17:49:37.212914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '736d0322-1fc4-40d6-b043-3ae5f6b9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b26f90>]}
[0m17:49:37.213455 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:49:37.287341 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:49:37.336482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:37.336732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:37.353386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736d0322-1fc4-40d6-b043-3ae5f6b9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105428f90>]}
[0m17:49:37.385656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:49:37.387630 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:49:37.394050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736d0322-1fc4-40d6-b043-3ae5f6b9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105393fd0>]}
[0m17:49:37.394340 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:49:37.394527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736d0322-1fc4-40d6-b043-3ae5f6b9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105597f50>]}
[0m17:49:37.394866 [warn ] [MainThread]: The selection criterion 'marts_daily_weather_summary' does not match any enabled nodes
[0m17:49:37.395413 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:49:37.396191 [debug] [MainThread]: Command end result
[0m17:49:37.407325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:49:37.407979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:49:37.409336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:49:37.409647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3310116, "process_in_blocks": "0", "process_kernel_time": 0.177837, "process_mem_max_rss": "116801536", "process_out_blocks": "0", "process_user_time": 0.806611}
[0m17:49:37.409866 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:37.409824 after 0.33 seconds
[0m17:49:37.410088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10062e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006c9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006c9dd0>]}
[0m17:49:37.410275 [debug] [MainThread]: Flushing usage events
[0m17:49:37.867271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:42.318112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077eb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078645d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864fd0>]}


============================== 17:49:42.320258 | 8ab56543-37e2-4c7a-b876-1a69f34a0468 ==============================
[0m17:49:42.320258 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:49:42.320595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_daily_weather_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:42.395230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5e390>]}
[0m17:49:42.418036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b7550>]}
[0m17:49:42.418547 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:49:42.485935 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:49:42.534448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:42.534696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:42.551316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee08d0>]}
[0m17:49:42.583529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:49:42.585519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:49:42.591814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db5e10>]}
[0m17:49:42.592079 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:49:42.592252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0b10>]}
[0m17:49:42.593084 [info ] [MainThread]: 
[0m17:49:42.593386 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:49:42.593548 [info ] [MainThread]: 
[0m17:49:42.593826 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:49:42.594273 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:49:42.599411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:43.340218 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:49:43.377915 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:49:43.390840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:49:43.394363 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:49:43.432004 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:49:43.433547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8a090>]}
[0m17:49:43.435017 [debug] [Thread-1 (]: Began running node model.weather_warehouse.mart_daily_weather_summary
[0m17:49:43.435352 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather`.`mart_daily_weather_summary` ............ [RUN]
[0m17:49:43.435765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.mart_daily_weather_summary)
[0m17:49:43.435972 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.mart_daily_weather_summary
[0m17:49:43.439963 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.mart_daily_weather_summary"
[0m17:49:43.440492 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.mart_daily_weather_summary
[0m17:49:43.449918 [debug] [Thread-1 (]: Creating new relation mart_daily_weather_summary
[0m17:49:43.467398 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

            

    
        create table `weather`.`mart_daily_weather_summary`
        
  
        
  engine = SummingMergeTree()
        order by (city_name,weather_date)
        
        partition by (toYYYYMM(weather_date))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

WITH source_data AS (
    SELECT
        city_name,
        weather_date,
        temperature_celsius,
        humidity_percent,
        wind_speed_ms,
        precipitation_mm
    FROM `weather`.`stg_weather`
)

SELECT
    city_name,
    weather_date,

    -- Temperature statistics
    min(temperature_celsius) AS min_temperature,
    max(temperature_celsius) AS max_temperature,
    avg(temperature_celsius) AS avg_temperature,

    -- Humidity statistics
    min(humidity_percent) AS min_humidity,
    max(humidity_percent) AS max_humidity,
    avg(humidity_percent) AS avg_humidity,

    -- Wind statistics
    avg(wind_speed_ms) AS avg_wind_speed,
    max(wind_speed_ms) AS max_wind_speed,

    -- Precipitation
    sum(precipitation_mm) AS total_precipitation,

    -- Useful categorical indicators
    CASE
        WHEN max(temperature_celsius) > 30 THEN 'Hot'
        WHEN max(temperature_celsius) > 20 THEN 'Warm'
        WHEN max(temperature_celsius) > 10 THEN 'Mild'
        WHEN max(temperature_celsius) > 0 THEN 'Cool'
        ELSE 'Cold'
    END AS temperature_category,

    -- Record count for quality check
    count() AS measurement_count
FROM source_data
GROUP BY
    city_name,
    weather_date
          )
        
        ...
[0m17:49:43.504969 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

            

    
        create table `weather`.`mart_daily_weather_summary`
        
  
        
  engine = SummingMergeTree()
        order by (city_name,weather_date)
        
        partition by (toYYYYMM(weather_date))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

WITH source_data AS (
    SELECT
        city_name,
        weather_date,
        temperature_celsius,
        humidity_percent,
        wind_speed_ms,
        precipitation_mm
    FROM `weather`.`stg_weather`
)

SELECT
    city_name,
    weather_date,

    -- Temperature statistics
    min(temperature_celsius) AS min_temperature,
    max(temperature_celsius) AS max_temperature,
    avg(temperature_celsius) AS avg_temperature,

    -- Humidity statistics
    min(humidity_percent) AS min_humidity,
    max(humidity_percent) AS max_humidity,
    avg(humidity_percent) AS avg_humidity,

    -- Wind statistics
    avg(wind_speed_ms) AS avg_wind_speed,
    max(wind_speed_ms) AS max_wind_speed,

    -- Precipitation
    sum(precipitation_mm) AS total_precipitation,

    -- Useful categorical indicators
    CASE
        WHEN max(temperature_celsius) > 30 THEN 'Hot'
        WHEN max(temperature_celsius) > 20 THEN 'Warm'
        WHEN max(temperature_celsius) > 10 THEN 'Mild'
        WHEN max(temperature_celsius) > 0 THEN 'Cool'
        ELSE 'Cold'
    END AS temperature_category,

    -- Record count for quality check
    count() AS measurement_count
FROM source_data
GROUP BY
    city_name,
    weather_date
          )
        
        
[0m17:49:43.513110 [debug] [Thread-1 (]: Database Error in model mart_daily_weather_summary (models/marts/mart_daily_weather_summary.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `humidity_percent` in scope source_data AS (SELECT city_name, weather_date, temperature_celsius, humidity_percent, wind_speed_ms, precipitation_mm FROM weather.stg_weather). (UNKNOWN_IDENTIFIER) (version 25.5.3.75 (official build))
[0m17:49:43.514166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab56543-37e2-4c7a-b876-1a69f34a0468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d6790>]}
[0m17:49:43.514658 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model `weather`.`mart_daily_weather_summary` ... [[31mERROR[0m in 0.08s]
[0m17:49:43.515056 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.mart_daily_weather_summary
[0m17:49:43.515425 [debug] [Thread-4 (]: Marking all children of 'model.weather_warehouse.mart_daily_weather_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_daily_weather_summary (models/marts/mart_daily_weather_summary.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `humidity_percent` in scope source_data AS (SELECT city_name, weather_date, temperature_celsius, humidity_percent, wind_speed_ms, precipitation_mm FROM weather.stg_weather). (UNKNOWN_IDENTIFIER) (version 25.5.3.75 (official build)).
[0m17:49:43.516716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:43.517052 [debug] [MainThread]: Connection 'model.weather_warehouse.mart_daily_weather_summary' was left open.
[0m17:49:43.517274 [debug] [MainThread]: On model.weather_warehouse.mart_daily_weather_summary: Close
[0m17:49:43.517530 [info ] [MainThread]: 
[0m17:49:43.517751 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m17:49:43.518188 [debug] [MainThread]: Command end result
[0m17:49:43.534107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:49:43.535240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:49:43.538439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:49:43.538653 [info ] [MainThread]: 
[0m17:49:43.538878 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:49:43.539052 [info ] [MainThread]: 
[0m17:49:43.539269 [error] [MainThread]:   Database Error in model mart_daily_weather_summary (models/marts/mart_daily_weather_summary.sql)
  HTTPDriver for http://localhost:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `humidity_percent` in scope source_data AS (SELECT city_name, weather_date, temperature_celsius, humidity_percent, wind_speed_ms, precipitation_mm FROM weather.stg_weather). (UNKNOWN_IDENTIFIER) (version 25.5.3.75 (official build))
[0m17:49:43.539440 [info ] [MainThread]: 
[0m17:49:43.539610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:49:43.539951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2531358, "process_in_blocks": "0", "process_kernel_time": 0.221268, "process_mem_max_rss": "164921344", "process_out_blocks": "0", "process_user_time": 1.066147}
[0m17:49:43.540178 [debug] [MainThread]: Command `dbt run` failed at 17:49:43.540132 after 1.25 seconds
[0m17:49:43.540407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002125d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864cd0>]}
[0m17:49:43.540616 [debug] [MainThread]: Flushing usage events
[0m17:49:44.027376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:24.181605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b42c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b464310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b464d10>]}


============================== 17:50:24.184499 | 9a076520-041e-4478-b785-c6980653f1c2 ==============================
[0m17:50:24.184499 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:50:24.184833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_daily_weather_summary', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:24.261839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e9b50>]}
[0m17:50:24.284665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b3750>]}
[0m17:50:24.285663 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:50:24.359374 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:50:24.415824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:24.416218 [debug] [MainThread]: Partial parsing: updated file: weather_warehouse://models/marts/mart_daily_weather_summary.sql
[0m17:50:24.579246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baf61d0>]}
[0m17:50:24.610542 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:50:24.612685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:50:24.622064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea8290>]}
[0m17:50:24.622359 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:50:24.622540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0b5d0>]}
[0m17:50:24.623326 [info ] [MainThread]: 
[0m17:50:24.623517 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:50:24.623652 [info ] [MainThread]: 
[0m17:50:24.623891 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:50:24.624330 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:50:24.628463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:25.500014 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:50:25.538809 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:25.555863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:50:25.559538 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:50:25.596743 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:25.598435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c903a50>]}
[0m17:50:25.600859 [debug] [Thread-1 (]: Began running node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:25.601344 [info ] [Thread-1 (]: 1 of 1 START sql table model `weather`.`mart_daily_weather_summary` ............ [RUN]
[0m17:50:25.601733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.mart_daily_weather_summary)
[0m17:50:25.602026 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:25.608734 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.mart_daily_weather_summary"
[0m17:50:25.609422 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:25.624134 [debug] [Thread-1 (]: Creating new relation mart_daily_weather_summary
[0m17:50:25.643322 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

            

    
        create table `weather`.`mart_daily_weather_summary`
        
  
        
  engine = SummingMergeTree()
        order by (city_name,weather_date)
        
        partition by (toYYYYMM(weather_date))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

WITH source_data AS (
    SELECT
        city_name,
        weather_date,
        temperature_celsius,
        wind_speed_ms,
        precipitation_mm
    FROM `weather`.`stg_weather`
)

SELECT
    city_name,
    weather_date,

    -- Temperature statistics
    min(temperature_celsius) AS min_temperature,
    max(temperature_celsius) AS max_temperature,
    avg(temperature_celsius) AS avg_temperature,

    -- Wind speed statistics
    min(wind_speed_ms) AS min_wind_speed,
    max(wind_speed_ms) AS max_wind_speed,
    avg(wind_speed_ms) AS avg_wind_speed,

    -- Precipitation statistics
    sum(precipitation_mm) AS total_precipitation,
    avg(precipitation_mm) AS avg_precipitation

FROM source_data
GROUP BY
    city_name,
    weather_date
          )
        
        ...
[0m17:50:25.689523 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:50:25.699346 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

    select name, type from system.columns where table = 'mart_daily_weather_summary'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:50:25.736391 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:25.738967 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.mart_daily_weather_summary"
[0m17:50:25.739639 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

  
    
    
    
        
         


        insert into `weather`.`mart_daily_weather_summary`
        ("city_name", "weather_date", "min_temperature", "max_temperature", "avg_temperature", "min_wind_speed", "max_wind_speed", "avg_wind_speed", "total_precipitation", "avg_precipitation")

WITH source_data AS (
    SELECT
        city_name,
        weather_date,
        temperature_celsius,
        wind_speed_ms,
        precipitation_mm
    FROM `weather`.`stg_weather`
)

SELECT
    city_name,
    weather_date,

    -- Temperature statistics
    min(temperature_celsius) AS min_temperature,
    max(temperature_celsius) AS max_temperature,
    avg(temperature_celsius) AS avg_temperature,

    -- Wind speed statistics
    min(wind_speed_ms) AS min_wind_speed,
    max(wind_speed_ms) AS max_wind_speed,
    avg(wind_speed_ms) AS avg_wind_speed,

    -- Precipitation statistics
    sum(precipitation_mm) AS total_precipitation,
    avg(precipitation_mm) AS avg_precipitation

FROM source_data
GROUP BY
    city_name,
    weather_date
  ...
[0m17:50:25.782105 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:25.796694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a076520-041e-4478-b785-c6980653f1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef9b390>]}
[0m17:50:25.797209 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `weather`.`mart_daily_weather_summary` ....... [[32mOK[0m in 0.19s]
[0m17:50:25.797604 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:25.798393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:25.798642 [debug] [MainThread]: Connection 'model.weather_warehouse.mart_daily_weather_summary' was left open.
[0m17:50:25.798857 [debug] [MainThread]: On model.weather_warehouse.mart_daily_weather_summary: Close
[0m17:50:25.799121 [info ] [MainThread]: 
[0m17:50:25.799341 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m17:50:25.799726 [debug] [MainThread]: Command end result
[0m17:50:25.852477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:50:25.853529 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:50:25.856185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:50:25.856355 [info ] [MainThread]: 
[0m17:50:25.856550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:25.856691 [info ] [MainThread]: 
[0m17:50:25.856959 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:25.857349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.712013, "process_in_blocks": "0", "process_kernel_time": 0.28629, "process_mem_max_rss": "166297600", "process_out_blocks": "0", "process_user_time": 1.284401}
[0m17:50:25.857564 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:25.857523 after 1.71 seconds
[0m17:50:25.857761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eebf210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eebff10>]}
[0m17:50:25.857966 [debug] [MainThread]: Flushing usage events
[0m17:50:26.321794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:37.989953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfeb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d068490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d068e90>]}


============================== 17:50:37.992589 | ad71a4ae-f06b-458d-9e74-81f2d9bf1041 ==============================
[0m17:50:37.992589 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:50:37.992931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/casperdamen/Code/weather-etl/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/casperdamen/Code/weather-etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:38.068645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b74ad90>]}
[0m17:50:38.091545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b34d0>]}
[0m17:50:38.092180 [info ] [MainThread]: Registered adapter: clickhouse=1.9.1
[0m17:50:38.170343 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:50:38.226079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:38.226346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:38.243587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d585e90>]}
[0m17:50:38.276515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:50:38.278994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:50:38.294497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7fc610>]}
[0m17:50:38.294811 [info ] [MainThread]: Found 3 models, 10 data tests, 476 macros
[0m17:50:38.296078 [info ] [MainThread]: 
[0m17:50:38.296278 [info ] [MainThread]: Concurrency: 1 threads (target='weather')
[0m17:50:38.296425 [info ] [MainThread]: 
[0m17:50:38.296708 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:50:38.299461 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:50:38.304630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:39.227428 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:50:39.263518 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:50:39.286364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__weather)
[0m17:50:39.292369 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "connection_name": "list__weather"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'weather'
      

  ...
[0m17:50:39.336789 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:39.339349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b0d90>]}
[0m17:50:39.342091 [debug] [Thread-1 (]: Began running node model.weather_warehouse.raw_weather
[0m17:50:39.342544 [info ] [Thread-1 (]: 1 of 13 START sql table model `weather`.`raw_weather` .......................... [RUN]
[0m17:50:39.342989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__weather, now model.weather_warehouse.raw_weather)
[0m17:50:39.343353 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.raw_weather
[0m17:50:39.349807 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.raw_weather"
[0m17:50:39.350472 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.raw_weather
[0m17:50:39.381260 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

            

    
        create table `weather`.`raw_weather__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (loaded_at)
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
          )
        
        ...
[0m17:50:39.777294 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m17:50:39.796460 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

    select name, type from system.columns where table = 'raw_weather__dbt_backup'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:50:39.834436 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:39.838886 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.raw_weather"
[0m17:50:39.840678 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */

  
    
    
    
        
         


        insert into `weather`.`raw_weather__dbt_backup`
        ("json_content", "loaded_at")

SELECT
    content as json_content,
    now() as loaded_at
FROM s3(
        'https://weather-data-dev.s3.fr-par.scw.cloud/weather-data-dev/weather/*/*.json',
        'SCWVN5JCMQBYC4B5K147',
        '96e3316e-f4e8-4153-bbf2-09ea0ce7a199',
        'RawBLOB',
        'content String'
     )
WHERE length(content) > 0
  ...
[0m17:50:42.736191 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 2.89 seconds
[0m17:50:42.744071 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */
EXCHANGE TABLES `weather`.`raw_weather__dbt_backup` AND `weather`.`raw_weather` 
  
  ...
[0m17:50:42.781232 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:42.806890 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.raw_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.raw_weather"} */
drop table if exists `weather`.`raw_weather__dbt_backup` 
  ...
[0m17:50:42.842759 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:42.846229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aef850>]}
[0m17:50:42.847073 [info ] [Thread-1 (]: 1 of 13 OK created sql table model `weather`.`raw_weather` ..................... [[32mOK[0m in 3.50s]
[0m17:50:42.847586 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.raw_weather
[0m17:50:42.848355 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:50:42.848708 [info ] [Thread-1 (]: 2 of 13 START test not_null_raw_weather_json_content ........................... [RUN]
[0m17:50:42.849065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_warehouse.raw_weather, now test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb)
[0m17:50:42.849293 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:50:42.857270 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb"
[0m17:50:42.857981 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:50:42.866998 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb"
[0m17:50:42.867746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select json_content
from `weather`.`raw_weather`
where json_content is null



    ) dbt_internal_test...
[0m17:50:42.906248 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:42.908649 [info ] [Thread-1 (]: 2 of 13 PASS not_null_raw_weather_json_content ................................. [[32mPASS[0m in 0.06s]
[0m17:50:42.909057 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb
[0m17:50:42.909321 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:50:42.909646 [info ] [Thread-1 (]: 3 of 13 START test not_null_raw_weather_loaded_at .............................. [RUN]
[0m17:50:42.909989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_raw_weather_json_content.3ddf5917eb, now test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b)
[0m17:50:42.910252 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:50:42.913068 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b"
[0m17:50:42.913875 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:50:42.915383 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b"
[0m17:50:42.915851 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select loaded_at
from `weather`.`raw_weather`
where loaded_at is null



    ) dbt_internal_test...
[0m17:50:42.954909 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:42.956167 [info ] [Thread-1 (]: 3 of 13 PASS not_null_raw_weather_loaded_at .................................... [[32mPASS[0m in 0.05s]
[0m17:50:42.956576 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b
[0m17:50:42.957058 [debug] [Thread-1 (]: Began running node model.weather_warehouse.stg_weather
[0m17:50:42.957427 [info ] [Thread-1 (]: 4 of 13 START sql incremental model `weather`.`stg_weather` .................... [RUN]
[0m17:50:42.957742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_raw_weather_loaded_at.80e0ff571b, now model.weather_warehouse.stg_weather)
[0m17:50:42.957981 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.stg_weather
[0m17:50:42.963975 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.stg_weather"
[0m17:50:42.964553 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.stg_weather
[0m17:50:42.986307 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

    select name, type from system.columns where table = 'stg_weather'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:50:43.024735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.025702 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.stg_weather"
[0m17:50:43.026277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.stg_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.stg_weather"} */

        insert into `weather`.`stg_weather`
        ("city_name", "latitude", "longitude", "weather_datetime", "weather_date", "weather_hour", "temperature_celsius", "precipitation_mm", "wind_speed_ms", "loaded_at")

WITH source_data AS (
    SELECT
        json_content,
        loaded_at
    FROM `weather`.`raw_weather`
    
    WHERE loaded_at > (SELECT MAX(loaded_at) FROM `weather`.`stg_weather`)
    
)

SELECT
    JSONExtractString(json_content, 'location', 'city') AS city_name,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lat') AS latitude,
    JSONExtractFloat(json_content, 'location', 'coordinates', 'lon') AS longitude,
    parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1)) AS weather_datetime,
    toDate(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_date,
    toHour(parseDateTimeBestEffort(JSONExtractString(json_content, 'weather_data', 'hourly', 'time', 1))) AS weather_hour,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'temperature_2m', 1) AS temperature_celsius,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'precipitation', 1) AS precipitation_mm,
    JSONExtractFloat(json_content, 'weather_data', 'hourly', 'windspeed_10m', 1) AS wind_speed_ms,
    loaded_at
FROM source_data
    ...
[0m17:50:43.073953 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:50:43.075372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d31f850>]}
[0m17:50:43.075868 [info ] [Thread-1 (]: 4 of 13 OK created sql incremental model `weather`.`stg_weather` ............... [[32mOK[0m in 0.12s]
[0m17:50:43.076260 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.stg_weather
[0m17:50:43.076826 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_stg_weather_city_name.d57308e884
[0m17:50:43.077111 [info ] [Thread-1 (]: 5 of 13 START test not_null_stg_weather_city_name .............................. [RUN]
[0m17:50:43.077550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_warehouse.stg_weather, now test.weather_warehouse.not_null_stg_weather_city_name.d57308e884)
[0m17:50:43.077795 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_stg_weather_city_name.d57308e884
[0m17:50:43.080472 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_stg_weather_city_name.d57308e884"
[0m17:50:43.081044 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_stg_weather_city_name.d57308e884
[0m17:50:43.082505 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_stg_weather_city_name.d57308e884"
[0m17:50:43.083026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_stg_weather_city_name.d57308e884: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_stg_weather_city_name.d57308e884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from `weather`.`stg_weather`
where city_name is null



    ) dbt_internal_test...
[0m17:50:43.121678 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.122929 [info ] [Thread-1 (]: 5 of 13 PASS not_null_stg_weather_city_name .................................... [[32mPASS[0m in 0.05s]
[0m17:50:43.123328 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_stg_weather_city_name.d57308e884
[0m17:50:43.123602 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_stg_weather_latitude.35769df29a
[0m17:50:43.123929 [info ] [Thread-1 (]: 6 of 13 START test not_null_stg_weather_latitude ............................... [RUN]
[0m17:50:43.124272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_stg_weather_city_name.d57308e884, now test.weather_warehouse.not_null_stg_weather_latitude.35769df29a)
[0m17:50:43.124542 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_stg_weather_latitude.35769df29a
[0m17:50:43.127518 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_stg_weather_latitude.35769df29a"
[0m17:50:43.128033 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_stg_weather_latitude.35769df29a
[0m17:50:43.129509 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_stg_weather_latitude.35769df29a"
[0m17:50:43.129963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_stg_weather_latitude.35769df29a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_stg_weather_latitude.35769df29a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latitude
from `weather`.`stg_weather`
where latitude is null



    ) dbt_internal_test...
[0m17:50:43.202120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m17:50:43.203686 [info ] [Thread-1 (]: 6 of 13 PASS not_null_stg_weather_latitude ..................................... [[32mPASS[0m in 0.08s]
[0m17:50:43.204192 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_stg_weather_latitude.35769df29a
[0m17:50:43.204540 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63
[0m17:50:43.204917 [info ] [Thread-1 (]: 7 of 13 START test not_null_stg_weather_longitude .............................. [RUN]
[0m17:50:43.205293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_stg_weather_latitude.35769df29a, now test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63)
[0m17:50:43.205589 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63
[0m17:50:43.209066 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63"
[0m17:50:43.209637 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63
[0m17:50:43.211255 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63"
[0m17:50:43.211777 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select longitude
from `weather`.`stg_weather`
where longitude is null



    ) dbt_internal_test...
[0m17:50:43.252489 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.253856 [info ] [Thread-1 (]: 7 of 13 PASS not_null_stg_weather_longitude .................................... [[32mPASS[0m in 0.05s]
[0m17:50:43.254325 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63
[0m17:50:43.254665 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63
[0m17:50:43.255055 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_weather_weather_date ........................... [RUN]
[0m17:50:43.255467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_stg_weather_longitude.04815d6a63, now test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63)
[0m17:50:43.255777 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63
[0m17:50:43.259143 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63"
[0m17:50:43.259718 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63
[0m17:50:43.261356 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63"
[0m17:50:43.261860 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from `weather`.`stg_weather`
where weather_date is null



    ) dbt_internal_test...
[0m17:50:43.322628 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:50:43.324020 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_weather_weather_date ................................. [[32mPASS[0m in 0.07s]
[0m17:50:43.324469 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63
[0m17:50:43.324794 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7
[0m17:50:43.325176 [info ] [Thread-1 (]: 9 of 13 START test not_null_stg_weather_weather_datetime ....................... [RUN]
[0m17:50:43.325575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_stg_weather_weather_date.4eacbe0d63, now test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7)
[0m17:50:43.325887 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7
[0m17:50:43.330745 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7"
[0m17:50:43.331300 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7
[0m17:50:43.332913 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7"
[0m17:50:43.333413 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_datetime
from `weather`.`stg_weather`
where weather_datetime is null



    ) dbt_internal_test...
[0m17:50:43.375941 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.377303 [info ] [Thread-1 (]: 9 of 13 PASS not_null_stg_weather_weather_datetime ............................. [[32mPASS[0m in 0.05s]
[0m17:50:43.377771 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7
[0m17:50:43.378250 [debug] [Thread-1 (]: Began running node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:43.378833 [info ] [Thread-1 (]: 10 of 13 START sql table model `weather`.`mart_daily_weather_summary` .......... [RUN]
[0m17:50:43.379190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_stg_weather_weather_datetime.8862bd5ea7, now model.weather_warehouse.mart_daily_weather_summary)
[0m17:50:43.379476 [debug] [Thread-1 (]: Began compiling node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:43.382115 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_warehouse.mart_daily_weather_summary"
[0m17:50:43.382652 [debug] [Thread-1 (]: Began executing node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:43.385251 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

            

    
        create table `weather`.`mart_daily_weather_summary__dbt_backup`
        
  
        
  engine = SummingMergeTree()
        order by (city_name,weather_date)
        
        partition by (toYYYYMM(weather_date))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

WITH source_data AS (
    SELECT
        city_name,
        weather_date,
        temperature_celsius,
        wind_speed_ms,
        precipitation_mm
    FROM `weather`.`stg_weather`
)

SELECT
    city_name,
    weather_date,

    -- Temperature statistics
    min(temperature_celsius) AS min_temperature,
    max(temperature_celsius) AS max_temperature,
    avg(temperature_celsius) AS avg_temperature,

    -- Wind speed statistics
    min(wind_speed_ms) AS min_wind_speed,
    max(wind_speed_ms) AS max_wind_speed,
    avg(wind_speed_ms) AS avg_wind_speed,

    -- Precipitation statistics
    sum(precipitation_mm) AS total_precipitation,
    avg(precipitation_mm) AS avg_precipitation

FROM source_data
GROUP BY
    city_name,
    weather_date
          )
        
        ...
[0m17:50:43.432458 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:50:43.434492 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

    select name, type from system.columns where table = 'mart_daily_weather_summary__dbt_backup'
    
      and database = 'weather'
    
    order by position
  ...
[0m17:50:43.471031 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.472653 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_warehouse.mart_daily_weather_summary"
[0m17:50:43.473407 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */

  
    
    
    
        
         


        insert into `weather`.`mart_daily_weather_summary__dbt_backup`
        ("city_name", "weather_date", "min_temperature", "max_temperature", "avg_temperature", "min_wind_speed", "max_wind_speed", "avg_wind_speed", "total_precipitation", "avg_precipitation")

WITH source_data AS (
    SELECT
        city_name,
        weather_date,
        temperature_celsius,
        wind_speed_ms,
        precipitation_mm
    FROM `weather`.`stg_weather`
)

SELECT
    city_name,
    weather_date,

    -- Temperature statistics
    min(temperature_celsius) AS min_temperature,
    max(temperature_celsius) AS max_temperature,
    avg(temperature_celsius) AS avg_temperature,

    -- Wind speed statistics
    min(wind_speed_ms) AS min_wind_speed,
    max(wind_speed_ms) AS max_wind_speed,
    avg(wind_speed_ms) AS avg_wind_speed,

    -- Precipitation statistics
    sum(precipitation_mm) AS total_precipitation,
    avg(precipitation_mm) AS avg_precipitation

FROM source_data
GROUP BY
    city_name,
    weather_date
  ...
[0m17:50:43.515711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.516629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */
EXCHANGE TABLES `weather`.`mart_daily_weather_summary__dbt_backup` AND `weather`.`mart_daily_weather_summary` 
  
  ...
[0m17:50:43.550497 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:50:43.553014 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.weather_warehouse.mart_daily_weather_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "model.weather_warehouse.mart_daily_weather_summary"} */
drop table if exists `weather`.`mart_daily_weather_summary__dbt_backup` 
  ...
[0m17:50:43.587634 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:50:43.590794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad71a4ae-f06b-458d-9e74-81f2d9bf1041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c84b90>]}
[0m17:50:43.591483 [info ] [Thread-1 (]: 10 of 13 OK created sql table model `weather`.`mart_daily_weather_summary` ..... [[32mOK[0m in 0.21s]
[0m17:50:43.591956 [debug] [Thread-1 (]: Finished running node model.weather_warehouse.mart_daily_weather_summary
[0m17:50:43.592831 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515
[0m17:50:43.593389 [info ] [Thread-1 (]: 11 of 13 START test not_null_mart_daily_weather_summary_city_name .............. [RUN]
[0m17:50:43.593835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_warehouse.mart_daily_weather_summary, now test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515)
[0m17:50:43.594354 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515
[0m17:50:43.599413 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515"
[0m17:50:43.600421 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515
[0m17:50:43.602931 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515"
[0m17:50:43.603947 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from `weather`.`mart_daily_weather_summary`
where city_name is null



    ) dbt_internal_test...
[0m17:50:43.642536 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.644335 [info ] [Thread-1 (]: 11 of 13 PASS not_null_mart_daily_weather_summary_city_name .................... [[32mPASS[0m in 0.05s]
[0m17:50:43.644924 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515
[0m17:50:43.645328 [debug] [Thread-1 (]: Began running node test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f
[0m17:50:43.645786 [info ] [Thread-1 (]: 12 of 13 START test not_null_mart_daily_weather_summary_weather_date ........... [RUN]
[0m17:50:43.646327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_mart_daily_weather_summary_city_name.2ec5100515, now test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f)
[0m17:50:43.646724 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f
[0m17:50:43.650902 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f"
[0m17:50:43.651917 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f
[0m17:50:43.653939 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f"
[0m17:50:43.654611 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from `weather`.`mart_daily_weather_summary`
where weather_date is null



    ) dbt_internal_test...
[0m17:50:43.691568 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.693480 [info ] [Thread-1 (]: 12 of 13 PASS not_null_mart_daily_weather_summary_weather_date ................. [[32mPASS[0m in 0.05s]
[0m17:50:43.693981 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f
[0m17:50:43.694334 [debug] [Thread-1 (]: Began running node test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510
[0m17:50:43.694719 [info ] [Thread-1 (]: 13 of 13 START test unique_mart_daily_weather_summary_city_name___weather_date . [RUN]
[0m17:50:43.695128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_warehouse.not_null_mart_daily_weather_summary_weather_date.158d4a508f, now test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510)
[0m17:50:43.695447 [debug] [Thread-1 (]: Began compiling node test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510
[0m17:50:43.702118 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510"
[0m17:50:43.703059 [debug] [Thread-1 (]: Began executing node test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510
[0m17:50:43.705056 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510"
[0m17:50:43.705774 [debug] [Thread-1 (]: dbt_clickhouse adapter: On test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "weather_warehouse", "target_name": "weather", "node_id": "test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    city_name || '_' || weather_date as unique_field,
    count(*) as n_records

from `weather`.`mart_daily_weather_summary`
where city_name || '_' || weather_date is not null
group by city_name || '_' || weather_date
having count(*) > 1



    ) dbt_internal_test...
[0m17:50:43.745789 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:50:43.747241 [info ] [Thread-1 (]: 13 of 13 PASS unique_mart_daily_weather_summary_city_name___weather_date ....... [[32mPASS[0m in 0.05s]
[0m17:50:43.747730 [debug] [Thread-1 (]: Finished running node test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510
[0m17:50:43.748645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:43.748914 [debug] [MainThread]: Connection 'test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510' was left open.
[0m17:50:43.749152 [debug] [MainThread]: On test.weather_warehouse.unique_mart_daily_weather_summary_city_name___weather_date.bfa8289510: Close
[0m17:50:43.749505 [info ] [MainThread]: 
[0m17:50:43.749749 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 10 data tests in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m17:50:43.751015 [debug] [MainThread]: Command end result
[0m17:50:43.767982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/casperdamen/Code/weather-etl/dbt/target/manifest.json
[0m17:50:43.769185 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/casperdamen/Code/weather-etl/dbt/target/semantic_manifest.json
[0m17:50:43.773067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/casperdamen/Code/weather-etl/dbt/target/run_results.json
[0m17:50:43.773352 [info ] [MainThread]: 
[0m17:50:43.773593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:43.773778 [info ] [MainThread]: 
[0m17:50:43.773956 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m17:50:43.774355 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.8189363, "process_in_blocks": "0", "process_kernel_time": 0.270184, "process_mem_max_rss": "169590784", "process_out_blocks": "0", "process_user_time": 1.332107}
[0m17:50:43.774596 [debug] [MainThread]: Command `dbt build` succeeded at 17:50:43.774551 after 5.82 seconds
[0m17:50:43.774825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce02210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3df10>]}
[0m17:50:43.775041 [debug] [MainThread]: Flushing usage events
[0m17:50:44.218834 [debug] [MainThread]: An error was encountered while trying to flush usage events
